<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>名醫診所系統</title>
    <!-- 新增網站圖標 (favicon) -->
    <link rel="icon" type="image/png" href="images/myLogo.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDK -->
    <script type="module" src="firebase_init.js"></script>
    <!-- 引入 jQuery (Toastr 的依賴) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <!-- 引入 Toastr 用於提示訊息 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <!-- 引入 Leaflet 用於穴位圖互動地圖 -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- 自訂穴位地圖整合模組：包含座標資料與地圖初始化邏輯 -->
    <script src="acupointIntegration.js"></script>
    <!-- 引入 SweetAlert2 用於彈窗 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in forwards; }
        .fade-out { animation: fadeOut 0.3s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }

        /* contenteditable placeholder for針灸備註輸入區 */
        [contenteditable][data-placeholder]:empty:before {
            content: attr(data-placeholder);
            color: #9ca3af; /* text-gray-400 */
        }
        
        /* 移除自訂 .toast 樣式，改由 Toastr 的 CSS 提供提示樣式 */

        /* 讓病歷欄位內容長字串換行避免溢出 */
        .medical-field {
            /* 允許在任意字元斷行，避免內容溢出欄位 */
            word-break: break-all;
            overflow-wrap: break-word;
        }

        /* 調整針灸備註中穴位方塊的字體大小，原本為 text-xs，改為較大的大小 */
        #formAcupunctureNotes span[data-acupoint-name] {
            /* 使用與 Tailwind text-sm 相當的字體大小 (0.875rem) 以提升可讀性 */
            font-size: 0.875rem;
        }

        /*
         * 調整穴位圖地圖容器比例
         * 原本在 HTML 中以固定高度 40rem 呈現穴位圖，當容器寬度較小時
         * 圖片高度會溢出導致無法完整顯示。改為使用 CSS aspect-ratio
         * 使容器自動按照圖片原始寬高比縮放，確保完整顯示。
         * 1116 / 768 ≈ 1.453；此屬性取寬除以高。
         */
        #acupointMap {
            /* 原本的寬高比為 1116:768。為將容器高度降低三分之一，可視為將
               高度乘以 2/3，等同於將分母乘上 2/3，即 768 * (2/3) = 512。故
               將 aspect-ratio 調整為 1116 / 512，使得在保持寬度不變的情況
               下，高度約為原本的 2/3。 */
            aspect-ratio: 1116 / 512;
            height: auto;
            /* 為穴位圖容器建立新的堆疊上下文。
               在開啟診所側邊功能列表時，會顯示一個遮罩層 (#sidebarOverlay)。
               由於 Leaflet 將標記、彈窗等元素渲染於高 z-index 的 pane 中，
               如果容器沒有 z-index，這些內部元素會蓋住遮罩層，導致穴位圖
               未隨畫面變暗，且遮住了側邊功能列表。透過將容器設為相對定位
               並指定 z-index，會讓其子元素的 z-index 限制在此堆疊上下文內，
               使遮罩層能正確覆蓋穴位圖。 */
            position: relative;
            z-index: 0;
        }

        /*
         * ============================================
         * 手機版排版優化
         *
         * 設置了一些媒體查詢，當螢幕寬度小於 640px（即常見手機螢幕寬度）時，
         * 將會覆寫部分 Tailwind 的固定寬度或最大寬度設定，並允許文字換行，
         * 以避免版面橫向溢出造成需要左右捲動。
         *
         * 這裡覆寫常見的 max-w-* 與 w-* 類別，使其在小螢幕上擴充為 100%，
         * 同時亦將 whitespace-nowrap 改為 normal，使按鈕或標題可自動換行。
         *
         * 另外也調整 toast 提示的寬度與位置，使其在手機上不會超出螢幕範圍。
         */
        @media (max-width: 640px) {
            /* Modal、表單以及最大寬度類別的元素在手機上寬度設為 100% */
            .max-w-md, .max-w-lg, .max-w-xl, .max-w-2xl, .max-w-3xl,
            .max-w-4xl, .max-w-5xl, .max-w-6xl, .max-w-7xl {
                max-width: 100% !important;
                width: 100% !important;
            }

            /* 常用固定寬度類別在手機上設為 100% 寬，避免橫向溢出 */
            .w-64, .w-72, .w-80, .w-96 {
                width: 100% !important;
            }

            /* 允許按鈕等元素內文換行 */
            .whitespace-nowrap {
                white-space: normal !important;
            }

            /* 將具有多欄的 Grid 強制成單欄顯示，減少橫向擁擠 */
            .grid-cols-2, .grid-cols-3, .grid-cols-4, .grid-cols-5, .grid-cols-6 {
                grid-template-columns: repeat(1, minmax(0, 1fr)) !important;
            }

            /* 移除舊的 .toast 手機樣式，使用 Toastr 預設樣式即可 */

            /*
             * 手機檢視時，診症記錄卡片的日期／醫師資訊與列印按鈕等操作無法全部水平顯示，
             * 容易造成內容被擋住或需要橫向捲動。為了提升使用者體驗，
             * 在寬度小於 640px 時將標題與按鈕群組改為垂直排列，
             * 讓按鈕顯示在日期與醫師資訊的下方。
             * 這裡鎖定診症記錄卡片的標題區塊（使用藍灰漸層背景的容器），
             * 並覆寫 Tailwind 的 flex 排版設定。
             */
            .bg-gradient-to-r.from-gray-50.to-blue-50 > .flex.justify-between.items-center {
                flex-direction: column !important;
                align-items: flex-start !important;
            }

            /* 當按鈕群組換行到下一層時，增加上邊距以區隔日期資訊與按鈕 */
            .bg-gradient-to-r.from-gray-50.to-blue-50 > .flex.justify-between.items-center > .flex.flex-wrap {
                margin-top: 0.5rem !important;
            }

            /*
             * 掛號列表標題在手機上會因為日期選擇器與總計人數區塊佔據寬度而造成橫向溢出。
             * 為了讓內容在窄螢幕上換行顯示，將整個標題容器改為垂直排列，
             * 並將左右兩側的內容堆疊在下一行。另外允許內部項目自動換行，
             * 並調整間距使其上下排列時更為整齊。
             */
            #registrationHeader > .flex {
                flex-direction: column !important;
                align-items: flex-start !important;
            }
            #registrationHeader > .flex > .flex.items-center {
                /* 允許標題中的日期區塊換行，並加入間距 */
                flex-wrap: wrap !important;
                gap: 0.25rem !important;
            }
            #registrationHeader > .flex > .text-sm.text-gray-600 {
                /* 總計人數區塊移到下一行後增加上邊距 */
                margin-top: 0.5rem !important;
            }

            /*
             * 診症記錄與病歷記錄卡片中的日期、醫師、病歷編號等資訊預設為橫向排列，
             * 在手機上容易造成內容被截斷。啟用 flex-wrap 並設置 gap，讓資訊能夠換行顯示。
             */
            .bg-gradient-to-r.from-gray-50.to-blue-50 .flex.items-center.space-x-4 {
                flex-wrap: wrap !important;
                gap: 0.5rem !important;
            }

            /* ==============================================
             * 針對排班管理區塊的手機版排版調整
             *
             * 在手機檢視時，排班管理的卡片寬度由預設的 80rem
             * 縮放為可用寬度的 100%。此外，縮小左右內邊距，避免
             * 內容區域顯得過窄。同時將內部 container 的邊距與
             * 上方空白調整為較小的值，以改善窄螢幕體驗。
             */
            #scheduleManagement {
                max-width: 100% !important;
                padding-left: 0.5rem !important;
                padding-right: 0.5rem !important;
            }
            #scheduleManagement .container {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
                padding-top: 2rem !important;
            }

            /*
             * ===============================
             * 掛號診症系統寬度調整
             *
             * 在手機螢幕上，診症系統區域由於原有的固定內距與最大寬度，
             * 可能造成畫面看起來偏窄。以下覆寫使其在窄螢幕上撐滿可用寬度，
             * 並減少左右內距，提升內容區域的可用空間。
             */
            #consultationSystem {
                max-width: 100% !important;
                width: 100% !important;
                padding-left: 0.5rem !important;
                padding-right: 0.5rem !important;
            }
            /* 同時調整診症表單外框的左右內距，避免內容過度擁擠 */
            #consultationForm {
                padding-left: 0.5rem !important;
                padding-right: 0.5rem !important;
            }

            /*
             * 下拉選單樣式調整
             *
             * 在手機版面中，許多 <select> 元素會因為預設寬度或選項文字較長而超出容器，
             * 導致橫向滾動或被截斷。為了改善在小螢幕上的呈現，
             * 將所有 select（排除語言切換器 #languageSelector）設定為 100% 寬度、
             * 同時將最小寬度設為 0，確保它們可以隨容器縮放。這能避免因內容過長而溢出框外。
             *
             * 另外，某些選單在桌面版使用 ml-auto 將其推到容器的右側，
             * 在窄螢幕換行後會造成難以預料的位置偏移。透過移除 margin-left，讓
             * 排序選單在換行時保持靠左對齊。
             */
            select:not(#languageSelector) {
                width: 100% !important;
                max-width: 100% !important;
                min-width: 0 !important;
            }
            #herbSortSelect {
                margin-left: 0 !important;
            }
            /* 指定部分自訂下拉選單的寬度，避免在小螢幕下造成水平滾動 */
            #herbComboCategoryFilter,
            #acupointComboCategoryFilter,
            #diagnosisTemplateCategoryFilter,
            #prescriptionTemplateCategoryFilter,
            #holidaySelector,
            #inventoryQuantityUnit,
            #roleFilter,
            #shiftTypeFilter {
                width: 100% !important;
            }
        }

        /*
         * 放大鏡鏡片樣式
         *
         * 此樣式定義了放大鏡的外觀，包括邊框、圓形形狀、尺寸、以及遮罩等。
         * 放大鏡會被絕對定位在圖片容器內，且使用 overflow: hidden 隱藏超出區域。
         */
        .img-magnifier-glass {
            position: absolute;
            border: 3px solid #000;
            border-radius: 50%;
            cursor: none;
            width: 150px;
            height: 150px;
            overflow: hidden;
            z-index: 1000;
            box-shadow: 0 0 4px rgba(0,0,0,0.3);
        }

        /*
         * 放大鏡內的指標點樣式
         *
         * 用於指示目前放大的精確位置。置於鏡片正中央，顯示為半透明的小圓點，不會攔截滑鼠事件。
         */
        .magnifier-pointer {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            margin-top: -4px;
            margin-left: -4px;
            background-color: rgba(255, 0, 0, 0.7);
            border-radius: 50%;
            pointer-events: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-50 to-blue-50 min-h-screen">
    <!-- 語言切換器將放置於登入卡片內 -->
    <!-- 登入頁面 -->
    <div id="loginPage" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md relative">
            <!-- 在登入卡片右上角放置語言切換器 -->
            <div class="absolute top-2 right-2">
                <select id="languageSelector" class="border border-gray-300 rounded px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="zh">中文</option>
                    <option value="en">English</option>
                </select>
            </div>
            <div class="text-center mb-8">
                <div class="text-4xl mb-4">
                    <!-- 使用自定義 Logo 圖片取代原有的 Emoji -->
                    <img src="images/myLogo.png" alt="Logo" class="h-20 mx-auto">
                </div>
                <h1 id="loginTitle" class="text-2xl font-bold text-gray-800 mb-2">名醫診所系統</h1>
                <!-- 更新預設診所英文名顯示為 Dr.Great Clinic -->
                <p id="loginEnglishTitle" class="text-sm text-gray-500 mb-3">Dr.Great Clinic</p>
                <p class="text-gray-600">請輸入您的電子郵件及密碼登入</p>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">電子郵件</label>
                    <input type="email" id="mainLoginUsername" placeholder="請輸入電子郵件" 
                           class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           data-login-email>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">密碼</label>
                    <input type="password" id="mainLoginPassword" placeholder="請輸入密碼" 
                           class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           data-login-password>
                </div>
                
                <button id="loginButton" 
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">
                    登入系統
                </button>
                
            </div>
            <!-- 登入頁面不再包含版權聲明，由全局頁腳統一呈現 -->
        </div>

    </div>
    <!-- 主系統頁面 -->
    <div id="mainSystem" class="hidden fade-in">
        <!-- 側邊選單 -->
        <div id="sidebar" class="fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-2xl transform -translate-x-full transition-transform duration-300 ease-in-out">
            <div class="flex flex-col h-full">
                <!-- 選單標題 -->
                <div class="bg-green-600 text-white p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="mr-3">
                                <!-- 使用自定義 Logo 圖片取代原有的 Emoji -->
                                <img src="images/myLogo.png" alt="Logo" class="h-6">
                            </span>
                            <h2 class="text-lg font-bold">診所功能</h2>
                        </div>
                        <button id="closeSidebarButton" class="text-white hover:text-gray-200 text-xl">
                            ×
                        </button>
                    </div>
                    <div id="sidebarUserRole" class="text-sm text-green-100 mt-2"></div>
                </div>
                <!-- 功能選單項目 -->
                <div class="flex-1 py-4 overflow-y-auto">
                    <div id="sidebarMenu" class="space-y-2 px-4">
                        <!-- 選單項目會動態生成 -->
                    </div>
                </div>
                <!-- 底部操作 -->
                <div class="border-t border-gray-200 p-4">
                    <button id="sidebarLogoutButton" class="w-full bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg text-sm transition duration-200 flex items-center justify-center">
                        <span class="mr-2">🚪</span>
                        登出系統
                    </button>
                </div>
            </div>
        </div>
        <!-- 遮罩層 -->
        <div id="sidebarOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>
        <!-- 頂部導航 -->
        <nav class="bg-white shadow-lg border-b-4 border-green-500">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <button id="openSidebarButton" class="mr-4 p-2 rounded-lg hover:bg-gray-100 transition duration-200">
                            <div class="w-6 h-6 flex flex-col justify-center space-y-1">
                                <div class="w-full h-0.5 bg-gray-600"></div>
                                <div class="w-full h-0.5 bg-gray-600"></div>
                                <div class="w-full h-0.5 bg-gray-600"></div>
                            </div>
                        </button>
                        <span class="mr-3">
                            <!-- 使用自定義 Logo 圖片取代原有的 Emoji -->
                            <img src="images/myLogo.png" alt="Logo" class="h-6">
                        </span>
                        <div>
                            <h1 id="systemTitle" class="text-xl font-bold text-gray-800">名醫診所系統</h1>
                            <p id="systemEnglishTitle" class="text-xs text-gray-500">Dr.Great Clinic</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span id="userRole" class="text-sm text-gray-600"></span>
                        <button id="logoutButton" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm transition duration-200">
                            登出
                        </button>
                    </div>
                </div>
            </div>
        </nav>
        <!-- 主要內容區域 -->
        <!-- 主要內容包裝區，新增 id 方便在顯示個人設置或模板庫時隱藏整個包裝 -->
        <div id="contentWrapper" class="max-w-7xl mx-auto px-4 py-6">
            <!-- 歡迎頁面 -->
            <div id="welcomePage" class="text-center py-16">
                <div class="text-6xl mb-6">
                    <!-- 使用自定義 Logo 圖片取代原有的 Emoji -->
                    <img src="images/myLogo.png" alt="Logo" class="h-16 mx-auto">
                </div>
                <h2 id="welcomeTitle" class="text-3xl font-bold text-gray-800 mb-2">歡迎使用名醫診所系統</h2>
                <p id="welcomeEnglishTitle" class="text-lg text-gray-500 mb-4">Welcome to Dr.Great Clinic</p>
                <p class="text-gray-600 text-lg mb-8">請點擊左上角選單按鈕開始使用系統功能</p>
                <div class="bg-white rounded-xl shadow-lg p-8 max-w-4xl mx-auto">
                    <h3 class="text-xl font-semibold mb-4">系統功能概覽</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm">
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="text-2xl mb-2">👥</div>
                            <div class="font-semibold">病人資料管理</div>
                            <div class="text-gray-600 mt-1">新增、查看、管理病人資料</div>
                        </div>
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="text-2xl mb-2">🩺</div>
                            <div class="font-semibold">診症系統</div>
                            <div class="text-gray-600 mt-1">記錄症狀、診斷、開立處方</div>
                        </div>
                        <div class="text-center p-4 bg-purple-50 rounded-lg">
                            <!-- 使用多人圖示代表診所用戶管理 -->
                            <div class="text-2xl mb-2">👥</div>
                            <div class="font-semibold">用戶管理</div>
                            <div class="text-gray-600 mt-1">管理診所用戶權限</div>
                        </div>
                        <div class="text-center p-4 bg-red-50 rounded-lg">
                            <div class="text-2xl mb-2">⚙️</div>
                            <div class="font-semibold">系統管理</div>
                            <div class="text-gray-600 mt-1">統計資料、備份匯出</div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 病人資料管理 -->
            <div id="patientManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800"> <span class="text-3xl mr-3">👥</span>病人資料管理</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchPatient" placeholder="搜尋病人編號、姓名或電話..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                        </div>
                        <button id="showAddPatientButton" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + 新增病人
                        </button>
                    </div>
                </div>
                <!-- 新增/編輯病人表單彈窗 -->
                <div id="addPatientModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="formTitle" class="text-xl font-bold text-gray-800">新增病人資料</h3>
                            <button id="hideAddPatientButtonTop" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">姓名 *</label>
                                    <input type="text" id="patientName" placeholder="請輸入姓名" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">年齡</label>
                                    <input type="number" id="patientAge" placeholder="系統自動計算" min="0" max="120" readonly class="w-full border border-gray-300 rounded-lg px-4 py-2 bg-gray-100 text-gray-600">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">性別 *</label>
                                    <select id="patientGender" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                        <option value="">請選擇性別</option>
                                        <option value="男">男</option>
                                        <option value="女">女</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">電話號碼 *</label>
                                    <input type="tel" id="patientPhone" placeholder="例：0912-345-678" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <!-- 將身分證字號設為必填，並移除固定長度限制 -->
                                    <label class="block text-sm font-medium text-gray-700 mb-1">身分證字號 *</label>
                                    <input type="text" id="patientIdCard" placeholder="例：A123456789" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">出生日期 *</label>
                                    <input type="date" id="patientBirthDate" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" onchange="updatePatientAge()">
                                </div>
                                <div class="md:col-span-2 lg:col-span-3">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">聯絡地址</label>
                                    <textarea id="patientAddress" placeholder="請輸入完整地址" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div class="md:col-span-2 lg:col-span-3">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">過敏史</label>
                                    <textarea id="patientAllergies" placeholder="請詳細記錄藥物過敏或食物過敏史" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent break-all"></textarea>
                                </div>
                                <div class="md:col-span-2 lg:col-span-3">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">病史及備註</label>
                                    <textarea id="patientHistory" placeholder="請記錄重要病史、家族病史、慢性疾病等" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent break-all"></textarea>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button id="cancelAddPatientButton" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <button id="savePatientButton" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="saveButtonText">儲存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 病人列表 -->
                <div class="overflow-x-auto">
                    <table class="w-full table-auto">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">編號</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">姓名</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">年齡</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">性別</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">電話</th>
                                <!-- 新增建檔日期欄位，僅顯示日期不含時間 -->
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">建檔日期</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">操作</th>
                            </tr>
                        </thead>
                        <tbody id="patientList" class="divide-y divide-gray-200">
                            <!-- 病人資料會動態載入 -->
                        </tbody>
                    </table>
                </div>
                <!-- 病人詳細資料彈窗 -->
                <div id="patientDetailModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                            <h3 class="text-xl font-bold text-gray-800">病人詳細資料</h3>
                            <button onclick="closePatientDetail()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        <div id="patientDetailContent" class="p-6">
                            <!-- 詳細內容會動態載入 -->
                        </div>
                    </div>
                </div>
                <!-- 病人病歷查看彈窗 -->
                <div id="patientMedicalHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="patientMedicalHistoryTitle" class="text-xl font-bold text-gray-800">病歷記錄</h3>
                            <button onclick="closePatientMedicalHistoryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <!-- 病人基本資訊 -->
                            <div id="patientMedicalHistoryPatientInfo" class="bg-blue-50 rounded-lg p-4 mb-6">
                                <!-- 病人資訊會動態載入 -->
                            </div>
                            
                            <!-- 診症記錄列表 -->
                            <div id="patientMedicalHistoryContent">
                                <!-- 診症記錄會動態載入 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 診症系統 -->
            <div id="consultationSystem" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800"> <span class="text-3xl mr-3">🩺</span>掛號診症系統</h2>
                    <p class="text-gray-600 mt-2">簡潔的掛號流程管理</p>
                </div>
                
                <!-- 病人搜索掛號 -->
                <div class="bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-6 mb-6">
                    <div class="mb-4">
                        <h3 class="text-lg font-semibold text-gray-800 flex items-center mb-2">
                            <span class="mr-2">🔍</span><span>搜索病人掛號</span>
                        </h3>
                        <p class="text-sm text-gray-600">請輸入病人姓名、編號或電話進行搜索</p>
                    </div>
                    
                    <div class="flex gap-3">
                        <div class="flex-1 relative">
                            <input type="text" id="patientSearchInput" placeholder="搜尋病人姓名、編號或電話..." 
                                   class="w-full border border-gray-300 rounded-lg px-4 py-3 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   autocomplete="off" autocorrect="off" autocapitalize="off">
                            <span class="absolute right-3 top-3.5 text-gray-400">🔍</span>
                        </div>
                        <button onclick="clearPatientSearch()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-3 rounded-lg transition duration-200">
                            清除
                        </button>
                    </div>
                    
                    <!-- 搜索結果 -->
                    <div id="patientSearchResults" class="mt-4 hidden">
                        <div class="bg-white rounded-lg border border-gray-200 max-h-64 overflow-y-auto">
                            <div id="searchResultsList" class="divide-y divide-gray-200">
                                <!-- 搜索結果會動態載入 -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 掛號彈窗 -->
                <div id="registrationModal" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
                        <div class="bg-green-600 text-white px-6 py-4 rounded-t-xl">
                            <div class="flex justify-between items-center">
                                <h3 class="text-xl font-bold">病人掛號</h3>
                                <button onclick="closeRegistrationModal()" class="text-white hover:text-gray-200 text-2xl">×</button>
                            </div>
                        </div>
                        
                        <div class="p-6 space-y-4">
                            <!-- 選中的病人資訊 -->
                            <div class="bg-blue-50 rounded-lg p-4">
                                <div class="flex items-center mb-2">
                                    <span class="mr-2">👤</span>
                                    <span class="font-semibold text-gray-700">病人資訊</span>
                                </div>
                                <div id="selectedPatientInfo" class="text-sm text-gray-600">
                                    <!-- 病人資訊會動態載入 -->
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">👨‍⚕️</span><span>掛號醫師 *</span>
                                </label>
                                <select id="appointmentDoctor" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option value="">請選擇醫師</option>
                                    <!-- 醫師選項會動態載入 -->
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">⏰</span><span>掛號時間</span>
                                </label>
                                <input type="datetime-local" id="appointmentDateTime" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>

                            <!-- 問診資料選擇：允許醫師於掛號時選擇患者先前填寫的問診資料 -->
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">🧾</span><span>選擇問診資料</span>
                                </label>
                                <select id="inquirySelect" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option value="">不使用問診資料</option>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">若病人已填寫問診，可在此選擇預填資訊</p>
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">📝</span><span>主訴症狀</span>
                                </label>
                                <textarea id="quickChiefComplaint" placeholder="請簡述病人的主要症狀..." rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                            </div>
                            
                            <div class="flex space-x-3 pt-4">
                                <button onclick="closeRegistrationModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <button onclick="confirmRegistration()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition duration-200">
                                    確認掛號
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 掛號列表 -->
                <div class="bg-white border border-gray-200 rounded-lg">
                    <!-- 為掛號列表標題區塊添加唯一 ID，方便在 CSS 中針對窄螢幕進行排版調整 -->
                    <div id="registrationHeader" class="bg-gray-50 px-6 py-4 border-b border-gray-200 rounded-t-lg">
                        <div class="flex justify-between items-center">
                            <!-- 左側：標題與日期選擇器 -->
                            <div class="flex items-center space-x-3">
                                <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                                    <span class="mr-2">📅</span><span>掛號列表</span>
                                </h3>
                                <div class="flex items-center space-x-1">
                                    <span class="whitespace-nowrap text-sm text-gray-600">日期</span>
                                    <input
                                        type="date"
                                        id="appointmentDatePicker"
                                        class="border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-green-500 focus:border-transparent text-gray-700 text-sm"
                                    />
                                </div>
                            </div>
                            <!-- 右側：總計人數顯示 -->
                            <div class="text-sm text-gray-600 flex items-center space-x-3">
                                <!-- 將標籤、數值和單位拆分為獨立元素，方便 i18n.js 處理翻譯 -->
                                <span>總計：</span>
                                <span id="todayTotal" class="font-semibold text-blue-600">0</span>
                                <span>人</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">序號</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">病人姓名</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">掛號醫師</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">掛號時間</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">主訴症狀</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">狀態</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="todayAppointmentsList" class="divide-y divide-gray-200">
                                    <!-- 掛號列表會動態載入 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- 診症記錄查看彈窗 -->
                <div id="medicalHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="medicalHistoryTitle" class="text-xl font-bold text-gray-800">診症記錄</h3>
                            <button onclick="closeMedicalHistoryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <!-- 病人基本資訊 -->
                            <div id="medicalHistoryPatientInfo" class="bg-blue-50 rounded-lg p-4 mb-6">
                                <!-- 病人資訊會動態載入 -->
                            </div>
                            
                            <!-- 診症記錄列表 -->
                            <div id="medicalHistoryContent">
                                <!-- 診症記錄會動態載入 -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 診症表單區域 -->
                <div id="consultationForm" class="hidden bg-white border border-gray-200 rounded-lg mt-6">
                    <div class="bg-green-600 text-white px-6 py-4 rounded-t-lg">
                        <h3 class="text-xl font-bold">診症記錄</h3>
                    </div>
                    
                    <div class="p-6">
                        <!-- 病人資訊 -->
                        <div class="bg-blue-50 rounded-lg p-4 mb-6">
                            <!--
                              將診症表單中的病人基本資訊區域擴充，加入年齡、性別、過敏史以及病史備註的顯示。
                              其中過敏史與病史在無資料時會隱藏，其容器設置了對應的 ID 供 JavaScript 控制。
                            -->
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm">
                                <div>
                                    <span class="font-medium">病人：</span>
                                    <span id="formPatientName" class="text-blue-600 font-semibold"></span>
                                </div>
                                <div>
                                    <span class="font-medium">年齡：</span>
                                    <span id="formPatientAge"></span>
                                </div>
                                <div>
                                    <span class="font-medium">性別：</span>
                                    <span id="formPatientGender"></span>
                                </div>
                                <div>
                                    <span class="font-medium">掛號時間：</span>
                                    <span id="formAppointmentTime"></span>
                                </div>
                                <!-- 病史及備註：若無資料則隱藏 -->
                                <div id="historyContainer" class="md:col-span-1 lg:col-span-2" style="display: none;">
                                    <span class="font-medium">病史及備註：</span>
                                    <span id="formPatientHistory" class="medical-field text-gray-700"></span>
                                </div>
                                <!-- 過敏史：以紅色高亮顯示，若無資料則隱藏 -->
                                <div id="allergiesContainer" class="md:col-span-1 lg:col-span-2" style="display: none;">
                                    <span class="font-medium text-red-600">過敏史：</span>
                                    <span id="formPatientAllergies" class="medical-field text-red-700 bg-red-50 px-2 py-1 rounded"></span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 診症表單 -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側 -->
                            <div class="space-y-4">
                                <div>
                                    <!-- 在主訴欄位旁新增載入診斷模板按鈕 -->
                                    <div class="flex justify-between items-center mb-2">
                                        <!-- 調整主訴欄位標題為「主訴及現病史」以合併兩者的輸入 -->
                                        <label class="block text-sm font-semibold text-gray-700">主訴及現病史 *</label>
                                        <!-- 診斷模板按鈕：點擊後開啟診斷模板選擇彈窗 -->
                                        <!-- 診斷模板載入按鈕：使用新的 openDiagnosisTemplate 包裝函式以顯示載入圈效果 -->
                                        <button
                                            type="button"
                                            onclick="openDiagnosisTemplate(event)"
                                            class="text-xs bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded transition duration-200"
                                        >
                                            🔍 載入診斷模板
                                        </button>
                                    </div>
                                    <!-- 主訴及現病史輸入區：維持原有的 textarea ID 以相容既有程式邏輯 -->
                                    <textarea id="formSymptoms" placeholder="病人主要不適症狀、發病時間、症狀特點、治療經過等..." rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>

                                <!-- 過往記錄欄位：顯示歷次診症的主訴及現病史，供醫師參考，禁止編輯 -->
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        過往記錄
                                    </label>
                                    <!-- 使用原有的 formCurrentHistory ID 以便程式存取，但設為唯讀並以灰底顯示 -->
                                    <textarea id="formCurrentHistory" readonly placeholder="過往主訴及現病史將自動載入" rows="6" class="w-full border border-gray-200 bg-gray-100 rounded-lg px-3 py-2 text-gray-600"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        舌象
                                    </label>
                                    <textarea id="formTongue" placeholder="舌質、舌苔、舌形等..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        脈象
                                    </label>
                                    <textarea id="formPulse" placeholder="脈位、脈率、脈力、脈形等..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        中醫診斷 *
                                    </label>
                                    <textarea id="formDiagnosis" placeholder="中醫病名診斷..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        證型診斷
                                    </label>
                                    <textarea id="formSyndrome" placeholder="辨證分型、病機分析..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">針灸備註</label>
                                        <button type="button" onclick="openAcupointCombo(event)" class="text-xs bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded transition duration-200">📍 載入常用穴位</button>
                                    </div>
                                    <!-- 搜索穴位並添加至針灸備註 -->
                                        <div class="mb-3 bg-blue-50 rounded-lg p-3 border border-blue-200">
                                            <div class="flex items-center mb-2">
                                                <span class="text-sm font-medium text-blue-800 mr-2">🔍 搜索穴位：</span>
                                                <div class="flex-1 relative">
                                                    <input type="text" id="acupointNotesSearch" placeholder="搜尋穴位名稱、經絡或定位..." 
                                                           class="w-full border border-blue-300 rounded px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                           oninput="searchAcupointForNotes()">
                                                    <button type="button" onclick="clearAcupointNotesSearch()" class="absolute right-2 top-1 text-gray-400 hover:text-gray-600 text-sm">×</button>
                                                </div>
                                                <!-- 新增穴位圖按鈕：開啟穴位地圖以選取穴位 -->
                                                <button type="button" onclick="openAcupointMapForNotes()" class="ml-2 text-xs bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded transition duration-200">🗺️ 穴位圖</button>
                                            </div>
                                        <!-- 搜索結果 -->
                                        <div id="acupointNotesSearchResults" class="hidden">
                                            <div class="bg-white rounded border border-blue-200 max-h-40 overflow-y-auto">
                                                <div id="acupointNotesSearchList" class="grid grid-cols-1 md:grid-cols-2 gap-2 p-2">
                                                    <!-- 搜索結果會動態載入 -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- 針灸備註輸入區，使用 contenteditable 以便嵌入穴位方塊 -->
                                    <div id="formAcupunctureNotes" contenteditable="true" data-placeholder="針灸穴位、手法、注意事項等..."
                                         class="w-full border border-gray-300 rounded-lg px-3 py-2 min-h-[80px] focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-2"></div>
                                </div>
                            </div>

                            
                            <!-- 右側 -->
                            <div class="space-y-4">
                                
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">處方內容</label>
                                        <div class="flex gap-2 items-center">
                                            <button type="button" onclick="addPrescriptionSection()" 
                                                    class="text-xs bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded transition duration-200">
                                                ＋ 新增處方
                                            </button>
                                            <button type="button" onclick="removePrescriptionSection()" 
                                                    class="text-xs bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded transition duration-200">
                                                － 移除處方
                                            </button>
                                            <button type="button" onclick="openHerbCombo(event)" 
                                                    class="text-xs bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded transition duration-200">
                                                🌿 載入常用藥方
                                            </button>
                                            <button type="button" onclick="loadPreviousPrescription()" 
                                                    class="text-xs bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded transition duration-200">
                                                📋 載入上次處方
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- 中藥庫搜索區域 -->
                                    <div class="mb-3 bg-yellow-50 rounded-lg p-3 border border-yellow-200">
                                        <div class="flex items-center mb-2">
                                            <span class="text-sm font-medium text-yellow-800 mr-2">🔍 搜索中藥庫：</span>
                                            <div class="flex-1 relative">
                                                <input type="text" id="prescriptionSearch" placeholder="搜索中藥材、方劑名稱或功能..." 
                                                       class="w-full border border-yellow-300 rounded px-3 py-1 text-sm focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                                                       oninput="searchHerbsForPrescription()">
                                                <button onclick="clearPrescriptionSearch()" class="absolute right-2 top-1 text-gray-400 hover:text-gray-600 text-sm">×</button>
                                            </div>
                                            <!-- 選擇顆粒沖劑或飲片 -->
                                            <select id="prescriptionTypeSelect" class="ml-2 px-3 py-1 border border-yellow-300 rounded text-sm bg-white"
                                                    onchange="onPrescriptionTypeChange(this.value)">
                                                <option value="granule">顆粒沖劑</option>
                                                <option value="slice">飲片</option>
                                            </select>
                                        </div>
                                        
                                        <!-- 搜索結果 -->
                                        <div id="prescriptionSearchResults" class="hidden">
                                            <div class="bg-white rounded border border-yellow-200 max-h-48 overflow-y-auto">
                                                <div id="prescriptionSearchList" class="grid grid-cols-1 md:grid-cols-2 gap-2 p-2">
                                                    <!-- 搜索結果會動態載入 -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 多處方容器 -->
                                    <div id="prescriptionsContainer" class="space-y-4"></div>
                                    <!-- 禁忌配伍提示區域（顯示目前編輯的處方的錯誤） -->
                                    <div id="prescriptionError" class="mt-2 text-sm text-red-600 hidden"></div>
                                    
                                    <!-- 每日次數（仍為全局設定） -->
                                    <div id="medicationFrequencySettings" class="mt-3 bg-yellow-50 rounded-lg p-3 border border-yellow-200" style="display: none;">
                                        <div class="flex items-center justify-between">
                                            <span class="text-sm font-medium text-yellow-800">每日次數</span>
                                            <div class="flex items-center space-x-2">
                                                <button onclick="updateMedicationFrequency(-1)" class="w-7 h-7 bg-yellow-500 text-white rounded-full text-sm hover:bg-yellow-600 transition duration-200">-</button>
                                                <input type="number" id="medicationFrequency" value="2" min="1" max="6" 
                                                       class="w-14 px-2 py-1 text-center border border-yellow-300 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-sm"
                                                       onchange="updateMedicationFrequency(0)" onclick="this.select()">
                                                <button onclick="updateMedicationFrequency(1)" class="w-7 h-7 bg-yellow-500 text-white rounded-full text-sm hover:bg-yellow-600 transition duration-200">+</button>
                                                <span class="text-sm text-yellow-800">次/日</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 隱藏的文本域用於存儲處方內容 -->
                                    <textarea id="formPrescription" class="hidden"></textarea>
                                </div>
                                
                                <!-- 將原本的「服用方法」欄位移至療程上方，並改名為「中藥服用方法」 -->

                                
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">
                                            收費項目
                                        </label>
                                        <button type="button" onclick="loadPreviousBillingItems()" 
                                                class="text-xs bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded transition duration-200">
                                            💰 載入上次收費
                                        </button>
                                    </div>
                                    
                                    <!-- 收費項目搜索區域 -->
                                    <div class="mb-3 bg-green-50 rounded-lg p-3 border border-green-200">
                                        <div class="flex items-center mb-2">
                                            <span class="text-sm font-medium text-green-800 mr-2">💰 選擇收費項目：</span>
                                            <div class="flex-1 relative">
                                                <input type="text" id="billingSearch" placeholder="搜索收費項目名稱..." 
                                                       class="w-full border border-green-300 rounded px-3 py-1 text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                                       oninput="searchBillingForConsultation()">
                                                <button onclick="clearBillingSearch()" class="absolute right-2 top-1 text-gray-400 hover:text-gray-600 text-sm">×</button>
                                            </div>
                                        </div>
                                        
                                        <!-- 搜索結果 -->
                                        <div id="billingSearchResults" class="hidden">
                                            <div class="bg-white rounded border border-green-200 max-h-48 overflow-y-auto">
                                                <div id="billingSearchList" class="grid grid-cols-1 md:grid-cols-2 gap-2 p-2">
                                                    <!-- 搜索結果會動態載入 -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 已選擇的收費項目 -->
                                    <div class="border border-gray-300 rounded-lg p-3 min-h-[80px] bg-gray-50">
                                        <div id="selectedBillingItems" class="space-y-2">
                                            <div class="text-sm text-gray-500 text-center py-4">
                                                請使用上方搜索功能添加收費項目
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 總費用顯示 -->
                                    <div class="mt-2 text-right">
                                        <span class="text-sm font-medium text-gray-700">總費用：</span>
                                        <span id="totalBillingAmount" class="text-lg font-bold text-green-600">$0</span>
                                    </div>
                                    
                                    <!-- 隱藏的文本域用於存儲收費項目 -->
                                    <textarea id="formBillingItems" class="hidden"></textarea>
                                    <!-- 病人套票管理 -->
                                    <div class="mt-4 border border-purple-200 rounded-lg p-3 bg-purple-50">
                                      <div class="flex items-center justify-between mb-2">
                                        <div class="text-sm font-semibold text-purple-800">🎫 病人套票</div>
                                        <button type="button" onclick="refreshPatientPackagesUI()"
                                                class="text-xs px-2 py-1 bg-purple-600 text-white rounded">刷新</button>
                                      </div>
                                      <div id="patientPackagesList" class="space-y-2 text-sm text-gray-700">
                                        <!-- 動態載入 -->
                                        <div class="text-gray-500">尚未載入或無套票</div>
                                      </div>
                                    </div>
                                </div>
                                
                                <!-- 新增「中藥服用方法」欄位，移到療程欄位上方 -->
                                <div>
                                    <!-- 在中藥服用方法欄位旁新增載入醫囑模板按鈕 -->
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">中藥服用方法</label>
                                        <!-- 醫囑模板按鈕：點擊後開啟醫囑模板選擇彈窗 -->
                                        <!-- 醫囑模板載入按鈕：使用新的 openPrescriptionTemplate 包裝函式以顯示載入圈效果 -->
                                        <button
                                            type="button"
                                            onclick="openPrescriptionTemplate(event)"
                                            class="text-xs bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded transition duration-200"
                                        >
                                            📋 載入醫囑模板
                                        </button>
                                    </div>
                                    <textarea id="formUsage" placeholder="煎煮方法、服用時間、劑量等..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        療程
                                    </label>
                                    <input type="text" id="formTreatmentCourse" placeholder="例：7天、2週、1個月等..." class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        醫囑及注意事項
                                    </label>
                                    <textarea id="formInstructions" placeholder="飲食宜忌、生活調護、注意事項等..." rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 複診時間及其他時間設定 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        複診時間
                                    </label>
                                    <input type="datetime-local" id="formFollowUpDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">建議病人下次回診的時間</p>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        到診時間
                                    </label>
                                    <input type="datetime-local" id="formVisitTime" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">實際到診的時間（用於證明書）</p>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        建議休息期間
                                    </label>
                                    <div class="space-y-2">
                                        <div class="flex items-center space-x-2">
                                            <label class="text-xs text-gray-600 w-12">開始：</label>
                                            <input type="date" id="formRestStartDate" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" onchange="updateRestPeriod()">
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <label class="text-xs text-gray-600 w-12">結束：</label>
                                            <input type="date" id="formRestEndDate" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" onchange="updateRestPeriod()">
                                        </div>
                                        <div class="text-center">
                                            <span id="restPeriodDisplay" class="text-sm text-gray-500 font-medium">請選擇開始和結束日期</span>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">用於病假證明書的建議休息期間</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 操作按鈕 -->
                        <div class="flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200">
                            <button onclick="cancelConsultation()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                取消診症
                            </button>
                            <button onclick="saveConsultation()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                <span id="consultationSaveButtonText">保存病歷</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 中藥庫 -->
            <div id="herbLibrary" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800"> <span class="text-3xl mr-3">🌿</span>中藥庫</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchHerb" placeholder="搜尋中藥材、方劑名稱或功能..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                        </div>
                        <!-- 庫存類型選擇：顆粒沖劑/飲片 -->
                        <select id="inventoryTypeSelect" onchange="onInventoryTypeChange(this.value)" class="border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-auto">
                            <option value="granule">顆粒沖劑</option>
                            <option value="slice">飲片</option>
                        </select>
                        <!-- 批量入庫按鈕：允許一次為多個中藥增加庫存 -->
                        <button id="batchInventoryBtn" onclick="openBatchInventoryModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                            <span id="batchInventoryBtnText">批量入庫</span>
                        </button>
                        <button id="inventoryHistoryBtn" onclick="openInventoryHistoryModal()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg">
                            進出貨記錄
                        </button>
                    </div>
                </div>
                <!-- 分類標籤 -->
                <div class="mb-6">
                    <div class="flex flex-wrap items-center gap-2">
                        <button onclick="filterHerbLibrary('all')" id="filter-all" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-800 transition duration-200">
                            全部
                        </button>
                        <button onclick="filterHerbLibrary('herb')" id="filter-herb" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            中藥材
                        </button>
                        <button onclick="filterHerbLibrary('formula')" id="filter-formula" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            方劑
                        </button>
                        <!-- 新增已停用的分類按鈕，預設樣式與其他分類一致 -->
                        <button onclick="filterHerbLibrary('disabled')" id="filter-disabled" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            已停用
                        </button>
                        <select id="herbSortSelect" onchange="changeHerbSortOrder(this.value)" class="ml-auto px-4 py-2 rounded-lg text-sm font-medium bg-white border border-gray-300 text-gray-700">
                            <option value="">排序方式</option>
                            <option value="most">庫存最多</option>
                            <option value="least">庫存最少</option>
                            <!-- 新增使用次數排序選項 -->
                            <option value="useMost">使用最多</option>
                            <option value="useLeast">使用最少</option>
                        </select>
                    </div>
                </div>
                <!-- 新增/編輯中藥材表單彈窗 -->
                <div id="addHerbModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="herbFormTitle" class="text-xl font-bold text-gray-800">新增中藥材</h3>
                            <button onclick="hideAddHerbForm()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">中藥材名稱 *</label>
                                    <input type="text" id="herbName" placeholder="請輸入中藥材名稱" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">別名</label>
                                    <input type="text" id="herbAlias" placeholder="其他名稱或別名" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <!-- 新增性味與歸經欄位 -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">性味</label>
                                    <input type="text" id="herbNature" placeholder="例：辛、溫" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">歸經</label>
                                    <input type="text" id="herbMeridian" placeholder="例：肺、脾經" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">功效</label>
                                    <textarea id="herbEffects" placeholder="請描述主要功效" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <!-- 新增主治欄位 -->
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">主治</label>
                                    <textarea id="herbIndications" placeholder="請描述主治" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">常用劑量</label>
                                    <input type="text" id="herbDosage" placeholder="例：3-9g" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">使用注意</label>
                                    <input type="text" id="herbCautions" placeholder="禁忌或注意事項" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <!-- 新增庫存量與警戒量欄位 -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">存庫量 (g)</label>
                                    <input type="number" id="herbStock" placeholder="請輸入存庫量" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" min="0" step="0.5">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">補貨警戒量 (g)</label>
                                    <input type="number" id="herbThreshold" placeholder="庫存低於此值顯示紅色" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" min="0" step="0.5">
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddHerbForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <button onclick="saveHerb()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="herbSaveButtonText">儲存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 新增/編輯方劑表單彈窗 -->
                <div id="addFormulaModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="formulaFormTitle" class="text-xl font-bold text-gray-800">新增方劑</h3>
                            <button onclick="hideAddFormulaForm()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">方劑名稱 *</label>
                                        <input type="text" id="formulaName" placeholder="請輸入方劑名稱" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">出處</label>
                                        <input type="text" id="formulaSource" placeholder="例：傷寒論、金匱要略" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">功效</label>
                                        <textarea id="formulaEffects" placeholder="請描述方劑主要功效" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                </div>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">組成 *</label>
                                        <textarea id="formulaComposition" placeholder="請輸入方劑組成，例如：&#10;人參&#10;白朮&#10;茯苓&#10;甘草" rows="8" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">注意事項</label>
                                        <textarea id="formulaCautions" placeholder="禁忌、注意事項等" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <!-- 新增主治與用法欄位 -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">主治</label>
                                        <textarea id="formulaIndications" placeholder="請描述方劑主治" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">用法</label>
                                        <textarea id="formulaUsage" placeholder="請描述方劑用法" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <!-- 新增庫存量與警戒量欄位 -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">存庫量 (g)</label>
                                        <input type="number" id="formulaStock" placeholder="請輸入存庫量" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.5">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">補貨警戒量 (g)</label>
                                        <input type="number" id="formulaThreshold" placeholder="庫存低於此值顯示紅色" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.5">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddFormulaForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <button onclick="saveFormula()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="formulaSaveButtonText">儲存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 庫存編輯彈窗 -->
                <div id="inventoryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
                        <div class="p-6">
                            <h3 id="inventoryModalTitle" class="text-xl font-bold mb-4">編輯庫存</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">剩餘數量</label>
                                    <!-- 將輸入框與單位下拉改為響應式：手機垂直排列，桌面橫向排列 -->
                                    <div class="flex flex-col sm:flex-row items-center">
                                        <input type="number" id="inventoryQuantity" class="w-full flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.5">
                                        <select id="inventoryQuantityUnit" class="mt-2 sm:mt-0 sm:ml-2 border border-gray-300 rounded px-2 py-2 text-sm">
                                            <option value="g" selected>克</option>
                                            <option value="jin">斤</option>
                                            <option value="liang">兩</option>
                                            <option value="qian">錢</option>
                                        </select>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">補貨警戒量</label>
                                    <div class="flex items-center">
                                        <!-- 讓輸入框在小螢幕時佔滿整行，避免超出右邊邊框 -->
                                        <input type="number" id="inventoryThreshold" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.5">
                                    </div>
                                </div>
                                <!-- 新增啟用/停用選擇 -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">狀態</label>
                                    <select id="inventoryDisabled" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                        <!-- 預設為啟用 (false)，表示此藥材仍會出現在處方搜尋中 -->
                                        <option value="false">啟用</option>
                                        <option value="true">停用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-4">
                                <button onclick="hideInventoryModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">取消</button>
                                <button onclick="saveInventoryChanges()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">儲存</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 批量入庫彈窗 -->
                <div id="batchInventoryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="p-6">
                            <!-- 批量入庫標題與類型選擇 -->
                            <div class="flex justify-between items-center mb-4">
                                <h3 id="batchInventoryModalTitle" class="text-xl font-bold">批量入庫</h3>
                                <!-- 顯示當前庫存類型：顆粒沖劑或飲片，僅供查看，不能在此切換 -->
                                <span id="batchInventoryTypeDisplay" class="px-2 py-1 text-sm border border-gray-300 rounded bg-gray-50"></span>
                            </div>
                            <!-- 此區域將動態添加多個批量入庫行 -->
                            <div id="batchRows" class="space-y-2"></div>
                            <button type="button" onclick="addBatchRow()" class="mt-2 bg-green-100 hover:bg-green-200 text-green-800 px-3 py-1 rounded">
                                + 新增藥材
                            </button>
                            <div class="mt-6 flex justify-end space-x-4">
                                <button type="button" onclick="hideBatchInventoryModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">取消</button>
                                <button type="button" onclick="saveBatchInventory()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">儲存</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 中藥庫列表 -->
                <div class="overflow-x-auto">
                    <div id="herbLibraryList" class="space-y-4">
                        <!-- 中藥庫內容會動態載入 -->
                    </div>
                </div>
                <!-- 進出貨記錄彈窗 -->
                <div id="inventoryHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="p-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xl font-bold">進出貨記錄</h3>
                            </div>
                            <div class="mb-4">
                                <div class="flex space-x-2">
                                    <button id="historyTabIn" onclick="switchInventoryHistoryTab('in')" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-800">入庫</button>
                                    <button id="historyTabOut" onclick="switchInventoryHistoryTab('out')" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200">出庫</button>
                                </div>
                            </div>
                            <div id="inventoryHistoryIn" class="space-y-2"></div>
                            <div id="inventoryHistoryOut" class="space-y-2 hidden"></div>
                            <div class="mt-6 flex justify-end space-x-4">
                                <button type="button" onclick="hideInventoryHistoryModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">關閉</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 穴位庫 -->
            <div id="acupointLibrary" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800"> <span class="text-3xl mr-3">📌</span>穴位庫</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchAcupoint" placeholder="搜尋穴位、經絡名稱或功能..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                        </div>
                    </div>
                </div>
                <!-- 分類標籤 -->
                <div class="mb-6">
                    <div id="acupointFilterContainer" class="flex flex-wrap gap-2">
                        <!-- 動態產生的經絡分類按鈕 -->
                    </div>
                </div>
    <!-- 穴位圖示展示區 -->
    <div class="mb-6">
        <!-- 使用 relative 容器以配合放大鏡絕對定位 -->
        <!-- 調整容器寬度使穴位圖的邊框能填滿整個卡片 -->
        <div id="acupointImageContainer" class="relative w-full">
            <!-- 取代傳統圖片為 Leaflet 地圖容器，後續由 JS 載入圖片並繪製標記 -->
            <!-- 將邊框加粗，使穴位圖的框線與卡片邊界一致 -->
            <!-- 調整高度為 40rem，以便完整呈現穴位圖比例 -->
            <!-- 移除固定高度 h-[40rem]，改由 CSS aspect-ratio 控制尺寸 -->
            <div id="acupointMap" class="w-full border-2 border-gray-300 rounded-lg shadow-sm"></div>
        </div>
    </div>
                <!-- 穴位庫列表 -->
                <div class="overflow-x-auto">
                    <div id="acupointLibraryList" class="space-y-4">
                        <!-- 穴位庫內容會動態載入 -->
                    </div>
                </div>
            </div>

            <!-- 收費項目管理 -->
            <div id="billingManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800"> <span class="text-3xl mr-3">💰</span>收費項目管理</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchBilling" placeholder="搜尋收費項目名稱..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                        </div>
                        <button onclick="showAddBillingItemForm()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + 新增收費項目
                        </button>
                    </div>
                </div>
                <!-- 分類標籤 -->
                <div class="mb-6">
                    <div class="flex flex-wrap gap-2">
                        <button onclick="filterBillingItems('all')" id="billing-filter-all" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-800 transition duration-200">
                            全部
                        </button>
                        <button onclick="filterBillingItems('consultation')" id="billing-filter-consultation" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            診療費
                        </button>
                        <button onclick="filterBillingItems('medicine')" id="billing-filter-medicine" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            藥費
                        </button>
                        <button onclick="filterBillingItems('treatment')" id="billing-filter-treatment" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            治療費
                        </button>
                        <button onclick="filterBillingItems('other')" id="billing-filter-other" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            其他
                        </button>
                        <button onclick="filterBillingItems('discount')" id="billing-filter-discount" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            折扣項目
                        </button>
                        <button onclick="filterBillingItems('package')" id="billing-filter-package" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            套票項目
                        </button>
                    </div>
                </div>
                <!-- 新增/編輯收費項目表單彈窗 -->
                <div id="addBillingItemModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="billingItemFormTitle" class="text-xl font-bold text-gray-800">新增收費項目</h3>
                            <button onclick="hideAddBillingItemForm()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">項目名稱 *</label>
                                    <input type="text" id="billingItemName" placeholder="請輸入收費項目名稱" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">項目類別 *</label>
                                    <select id="billingItemCategory" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                        <option value="">請選擇類別</option>
                                        <option value="consultation">診療費</option>
                                        <option value="medicine">藥費</option>
                                        <option value="treatment">治療費</option>
                                        <option value="other">其他</option>
                                        <option value="discount">折扣項目</option>
                                        <option value="package">套票項目</option>
                                    </select>
                                </div>
                                <!-- 套票專用欄位：當類別選擇 package 時顯示 -->
                                <div id="packageFields" class="md:col-span-2 hidden">
                                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                      <label class="block text-sm font-medium text-gray-700 mb-1">套票可用次數 *</label>
                                      <input type="number" id="billingItemPackageUses" placeholder="例如：10" min="1"
                                             class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    </div>
                                    <div>
                                      <label class="block text-sm font-medium text-gray-700 mb-1">有效天數 *</label>
                                      <input type="number" id="billingItemValidityDays" placeholder="例如：180（半年）" min="1"
                                             class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                      <p class="text-xs text-gray-500 mt-1">自購買日起算</p>
                                    </div>
                                  </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">收費金額 *</label>
                                    <input type="number" id="billingItemPrice" placeholder="0" step="1" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">折扣項目：輸入0.9表示9折，輸入9會自動轉為9折，或輸入負數表示固定金額折扣</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">計費單位</label>
                                    <input type="text" id="billingItemUnit" placeholder="例：次、劑、包" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">項目說明</label>
                                    <textarea id="billingItemDescription" placeholder="請描述收費項目的詳細內容" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="billingItemActive" checked class="mr-2 rounded">
                                        <span class="text-sm font-medium text-gray-700">啟用此收費項目</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddBillingItemForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <button onclick="saveBillingItem()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="billingItemSaveButtonText">儲存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 收費項目列表 -->
                <div class="overflow-x-auto">
                    <div id="billingItemsList" class="space-y-4">
                        <!-- 收費項目內容會動態載入 -->
                    </div>
                </div>
            </div>
            <!-- 診所用戶管理 -->
            <div id="userManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                        <!-- 使用單人圖示代表診所用戶管理 -->
                        <span class="text-3xl mr-3">👤</span>
                        診所用戶管理
                    </h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchUser" placeholder="搜尋用戶名稱或電子郵件..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                        </div>
                        <button onclick="showAddUserForm()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + 新增用戶
                        </button>
                    </div>
                </div>
                <!-- 狀態篩選標籤 -->
                <div class="mb-6">
                    <div class="flex flex-wrap gap-2">
                        <button onclick="filterUsers('all')" id="user-filter-all" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-800 transition duration-200">
                            全部用戶
                        </button>
                        <button onclick="filterUsers('inactive')" id="user-filter-inactive" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            已停用
                        </button>
                    </div>
                </div>
                <!-- 新增/編輯用戶表單彈窗 -->
                <div id="addUserModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="userFormTitle" class="text-xl font-bold text-gray-800">新增用戶</h3>
                            <button onclick="hideAddUserForm()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">姓名 *</label>
                                    <input type="text" id="userDisplayName" placeholder="請輸入真實姓名" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">職位 *</label>
                                    <select id="userPosition" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" onchange="toggleRegistrationNumberField()">
                                        <option value="">請選擇職位</option>
                                        <option value="診所管理">診所管理</option>
                                        <option value="醫師">醫師</option>
                                        <option value="護理師">護理師</option>
        <option value="用戶">一般用戶</option>
                                    </select>
                                </div>
                                <div id="registrationNumberField" class="hidden">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">中醫註冊編號 *</label>
                                    <input type="text" id="userRegistrationNumber" placeholder="請輸入中醫註冊編號" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">醫師職位必須填寫註冊編號</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">電子郵件 *</label>
                                    <input type="email" id="userEmail" placeholder="請輸入電子郵件" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">電話號碼</label>
                                    <input type="tel" id="userPhone" placeholder="請輸入電話號碼" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <!-- Firebase UID 欄位 -->
                                <div id="uidField">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Firebase UID</label>
                                    <input type="text" id="userUID" placeholder="請輸入 Firebase UID（可不填）" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">對應 Firebase Authentication 帳號的 UID</p>
                                </div>

        <!-- 初始密碼與確認密碼欄位，僅新增用戶時顯示 -->
        <div id="passwordFields" class="grid grid-cols-1 md:grid-cols-2 gap-4 md:col-span-2">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">初始密碼 *</label>
                <input type="password" id="userPassword" placeholder="請輸入初始密碼" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">確認密碼 *</label>
                <input type="password" id="userPasswordConfirm" placeholder="請再次輸入密碼" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
            </div>
        </div>
                                <div class="md:col-span-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="userActive" checked class="mr-2 rounded">
                                        <span class="text-sm font-medium text-gray-700">啟用此用戶帳號</span>
                                    </label>
                                    <p class="text-xs text-gray-500 mt-1">停用的帳號將無法登入系統</p>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddUserForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <!-- 為用戶儲存按鈕增加 id，便於顯示讀取圈 -->
                                <button id="userSaveButton" onclick="saveUser()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="userSaveButtonText">儲存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 用戶列表 -->
                <div class="overflow-x-auto">
                    <table class="w-full table-auto">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">姓名</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">職位</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">註冊編號</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">電子郵件</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">狀態</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">最後登入</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">操作</th>
                            </tr>
                        </thead>
                        <tbody id="userList" class="divide-y divide-gray-200">
                            <!-- 用戶資料會動態載入 -->
                        </tbody>
                    </table>
                </div>
            </div>
<!-- 財務報表 -->
            <div id="financialReports" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2 flex items-center">
                        <span class="mr-3">📊</span>財務報表
                    </h2>
                    <p class="text-gray-600">診所收入分析與財務統計</p>
                </div>
                <!-- 篩選控制區 -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">報表類型</label>
                            <select id="quickDate" onchange="setQuickDate()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">請選擇...</option>
                                <option value="today">今天</option>
                                <option value="yesterday">昨天</option>
                                <option value="thisWeek">本週</option>
                                <option value="lastWeek">上週</option>
                                <option value="thisMonth">本月</option>
                                <option value="lastMonth">上月</option>
                                <option value="thisYear">今年</option>
                                <option value="lastYear">去年</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">開始日期</label>
                            <input type="date" id="startDate" onchange="generateFinancialReport()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">結束日期</label>
                            <input type="date" id="endDate" onchange="generateFinancialReport()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">醫師篩選</label>
                            <select id="doctorFilter" onchange="generateFinancialReport()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">全部醫師</option>
                            </select>
                        </div>
                        
                        <div class="flex items-end space-x-2">
                            <button onclick="generateFinancialReport()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200 flex items-center">
                                <span class="mr-2">🔄</span><span>更新報表</span>
                            </button>
                            <button onclick="exportFinancialReport()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200 flex items-center">
                                <span class="mr-2">📥</span><span>匯出</span>
                            </button>
                        </div>
                    </div>
                </div>
                <!-- 關鍵指標卡片 -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gradient-to-r from-green-400 to-green-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100 text-sm font-medium">總收入</p>
                                <h3 id="totalRevenue" class="text-3xl font-bold">$0</h3>
                                <p id="revenueChange" class="text-green-100 text-sm mt-1">統計期間收入</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">💰</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-blue-400 to-blue-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100 text-sm font-medium">診症人次</p>
                                <h3 id="totalConsultations" class="text-3xl font-bold">0</h3>
                                <p id="consultationChange" class="text-blue-100 text-sm mt-1">完成診症次數</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">👥</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-purple-400 to-purple-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm font-medium">平均消費</p>
                                <h3 id="averageRevenue" class="text-3xl font-bold">$0</h3>
                                <p id="averageChange" class="text-purple-100 text-sm mt-1">每次診症平均</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">📊</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-orange-400 to-orange-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-orange-100 text-sm font-medium">活躍醫師</p>
                                <h3 id="activeDoctors" class="text-3xl font-bold">0</h3>
                                <p id="doctorChange" class="text-orange-100 text-sm mt-1">有診症的醫師</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">👨‍⚕️</span>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 詳細報表 -->
                <div class="bg-white border border-gray-200 rounded-lg">
                    <div class="bg-gray-50 px-6 py-4 border-b border-gray-200 rounded-t-lg">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                                <span class="mr-2">📋</span><span>詳細財務報表</span>
                            </h3>
                            <div class="text-sm text-gray-600 flex items-center space-x-1">
                                <!-- 將標籤與時間拆分，使多語系翻譯可以套用 -->
                                <span>資料更新時間：</span>
                                <span id="lastUpdateTime">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 標籤頁 -->
                    <div class="border-b border-gray-200">
                        <nav class="flex space-x-8 px-6" role="tablist">
                            <button onclick="switchFinancialTab('summary')" id="financialSummaryTab" class="py-4 px-1 border-b-2 border-green-500 text-green-600 font-medium text-sm transition duration-200">
                                收入摘要
                            </button>
                            <button onclick="switchFinancialTab('daily')" id="financialDailyTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm transition duration-200">
                                每日明細
                            </button>
                            <button onclick="switchFinancialTab('doctor')" id="financialDoctorTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm transition duration-200">
                                醫師業績
                            </button>
                            <button onclick="switchFinancialTab('service')" id="financialServiceTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm transition duration-200">
                                服務分析
                            </button>
                        </nav>
                    </div>
                    
                    <!-- 標籤內容 -->
                    <div class="p-6">
                        <!-- 收入摘要標籤 -->
                        <div id="financialSummaryContent" class="financial-tab-content">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">項目</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">金額</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">佔比</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">備註</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialSummaryTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="4" class="px-4 py-8 text-center text-gray-500">
                                                請點擊「更新報表」來載入資料
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- 每日明細標籤 -->
                        <div id="financialDailyContent" class="financial-tab-content hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">日期</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">診症人次</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">收入金額</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">平均消費</th>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">主要服務</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialDailyTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                                請點擊「更新報表」來載入資料
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- 醫師業績標籤 -->
                        <div id="financialDoctorContent" class="financial-tab-content hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">醫師</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">診症人次</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">總收入</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">平均消費</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">佔比</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialDoctorTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                                請點擊「更新報表」來載入資料
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- 服務分析標籤 -->
                        <div id="financialServiceContent" class="financial-tab-content hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">服務類型</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">次數</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">總金額</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">平均單價</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">收入佔比</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialServiceTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                                請點擊「更新報表」來載入資料
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 系統管理 -->
            <div id="systemManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6"> <span class="text-3xl mr-3">⚙️</span>系統管理</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

<div class="bg-gray-50 rounded-lg p-6">
    <h3 class="text-lg font-semibold mb-4">資料備份與還原</h3>
    <!-- 說明備份內容：模板庫、中藥庫及穴位庫不包含在匯出備份中 -->
    <p class="text-sm text-gray-600 mb-4">您可以匯出診所資料備份（包含所有功能資料，不含模板庫、中藥庫及穴位庫），或匯入之前的備份檔案。實時掛號及問診資料不包含在備份中。</p>
    <div class="flex flex-col md:flex-row gap-4">
        <button id="backupExportBtn" onclick="exportClinicBackup()" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition duration-200">
            匯出備份
        </button>
        <button id="backupImportBtn" onclick="triggerBackupImport()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition duration-200">
            匯入備份
        </button>
        <input type="file" id="backupFileInput" accept=".json" class="hidden" onchange="handleBackupFile(this.files[0])">
    </div>
    <!-- 匯入進度條 -->
    <div id="backupProgressContainer" class="hidden mt-4">
        <div class="w-full bg-gray-200 rounded-full h-2.5">
            <div id="backupProgressBar" class="bg-blue-600 h-2.5 rounded-full" style="width:0%"></div>
        </div>
        <div id="backupProgressText" class="mt-2 text-sm text-gray-700"></div>
    </div>
</div>
                                
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">診所設定</h3>
                        <div class="space-y-3">
                            <div class="text-center py-4" id="clinicSettingsDisplay">
                                <div class="text-sm text-gray-700 mb-3">
                                    <!-- 將標籤與值拆分為不同的元素，以便 i18n.js 處理翻譯 -->
                                    <div class="font-medium flex items-center space-x-1">
                                        <span>診所中文名稱：</span><span id="displayChineseName">名醫診所系統</span>
                                    </div>
                                    <div class="text-gray-600 mt-1 flex items-center space-x-1">
                                        <span>診所英文名稱：</span><span id="displayEnglishName">Dr.Great Clinic</span>
                                    </div>
                                </div>
                                <button onclick="showClinicSettingsModal()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition duration-200">
                                    診所資料修改
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 新增訂閱與付款管理卡片 -->
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">訂閱與付款</h3>
                        <!-- 說明文字將由 i18n.js 進行多語翻譯 -->
                        <p class="text-sm text-gray-600 mb-4">您可以查看並管理系統訂閱或付款狀態。</p>
                        <div class="flex flex-col md:flex-row gap-4">
                            <!-- 修改：直接開啟訂閱與付款的 Stripe 登入頁面 -->
                            <button id="manageBillingBtn" onclick="window.open('https://billing.stripe.com/p/login/00w00l9Sk5I98irfdLcjS00', '_blank')" class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-lg transition duration-200">
                                管理訂閱/付款
                            </button>
                        </div>
                    </div>

                    
                </div>
            </div>
        </div>
        <!-- 個人設置與模板庫內容 -->
        <!-- 個人設置區：在外層加入與其他頁面一致的寬度與內邊距容器，卡片樣式位於內層 -->
        <!-- 個人設置區：包裝在與其他頁面相同的寬度限制與內外邊距容器中，使版面保持一致 -->
        <!-- 病歷管理 -->
        <!-- 將病歷管理區外層調整為與其他版面一致的寬度限制與內外邊距，
             將原本的白色卡片樣式移至內層，讓外層有左右留白空間 -->
        <div id="medicalRecordManagement" class="hidden max-w-7xl mx-auto px-4 py-6">
            <!-- 將整個病歷管理內文字縮小一級，採用 text-sm 作為基準字級 -->
            <div class="bg-white rounded-xl shadow-lg p-6 text-sm">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                <h2 class="text-2xl font-bold text-gray-800"><span class="text-3xl mr-3">📋</span>病歷管理</h2>
                <div class="flex flex-col md:flex-row gap-3">
                    <div class="relative">
                        <input type="text" id="searchMedicalRecord" placeholder="搜尋病歷編號、病人姓名或醫師..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full md:w-64">
                        <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                    </div>
                </div>
            </div>
            <div class="overflow-x-auto">
                <!-- 列表容器：用於插入分頁控制 -->
                <div id="medicalRecordList">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <!-- 將表頭字體與大小調整為與其他版面一致，使用 text-sm、font-semibold，移除 uppercase 與 tracking-wider -->
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700">病歷編號</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700">病人姓名</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700">主訴</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700">醫師</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700">日期</th>
                                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700">操作</th>
                            </tr>
                        </thead>
                        <tbody id="medicalRecordTableBody" class="divide-y divide-gray-200">
                            <tr>
                                <td colspan="6" class="px-4 py-8 text-center text-gray-500">
                                    <!-- 內容將由 JavaScript 動態填充 -->
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div id="medicalRecordPagination" class="mt-4 flex justify-center hidden"></div>
            </div><!-- 內層卡片結束 -->
        </div>

        <!-- 病歷詳細資訊彈窗 -->
        <div id="medicalRecordDetailModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
            <!-- 調整彈窗寬度以與病人資料管理的病歷查看保持一致，從 max-w-3xl 改為 max-w-6xl -->
            <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                    <h3 class="text-xl font-bold text-gray-800">病歷詳細資訊</h3>
                    <button onclick="closeMedicalRecordDetail()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                </div>
                <div id="medicalRecordDetailContent" class="p-6 space-y-4">
                    <!-- 病歷詳細內容將由 JavaScript 動態填充 -->
                </div>
            </div>
        </div>

        <div id="personalSettings" class="hidden max-w-7xl mx-auto px-4 py-6">
          <div class="bg-white rounded-xl shadow-lg p-6">
            <!-- 移除內層多餘的背景框，避免重複包裹 -->
            <div>
            <h2 class="text-2xl font-bold text-amber-800 mb-6 flex items-center">
              <span class="text-3xl mr-3">🔧</span>
              個人設置
            </h2>
            
            <!-- 標籤切換 -->
            <div class="mb-6">
              <div class="flex border-b border-gray-200">
                <button class="px-6 py-3 text-amber-700 border-b-2 border-amber-500 font-medium" onclick="switchPersonalTab('herbs')" id="herbsTab">
                  🌿 慣用中藥組合
                  <!-- 動態顯示慣用中藥組合數量 -->
                  <span id="herbCount" class="ml-2 text-xs font-semibold bg-green-100 text-green-700 rounded-full px-2 py-0.5"></span>
                </button>
                <button class="px-6 py-3 text-gray-500 hover:text-amber-700 font-medium" onclick="switchPersonalTab('acupoints')" id="acupointsTab">
                  📍 慣用穴位組合
                  <!-- 動態顯示慣用穴位組合數量 -->
                  <span id="acupointCount" class="ml-2 text-xs font-semibold bg-blue-100 text-blue-700 rounded-full px-2 py-0.5"></span>
                </button>
              </div>
            </div>

            <!-- 中藥組合內容 -->
            <div id="herbsContent" class="personal-tab-content">
              <div class="mb-6 space-y-4">
                <div class="flex gap-4 flex-wrap">
                  <button class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors" onclick="addNewHerbCombination()">
                    + 新增藥方組合
                  </button>
                  <button class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors" onclick="showCategoryModal('herbs')">
                    + 管理分類
                  </button>
                </div>
                <div class="flex gap-4 flex-wrap">
                  <!-- 個人慣用中藥組合：底層搜尋欄與分類篩選 -->
                  <input id="herbComboSearchInput" type="text" placeholder="搜尋藥方組合名稱..." class="px-4 py-2 border-2 border-green-200 rounded-lg focus:border-green-400 focus:outline-none flex-1 min-w-64">
                  <select id="herbComboCategoryFilter" class="px-4 py-2 border-2 border-green-200 rounded-lg focus:border-green-400 focus:outline-none">
                    <option>全部分類</option>
                    <option>感冒類</option>
                    <option>消化系統</option>
                    <option>婦科調理</option>
                    <option>補益類</option>
                    <option>清熱類</option>
                  </select>
                  <!-- 移除使用頻率篩選下拉選單 -->
                </div>
              </div>
              <div class="grid md:grid-cols-2 gap-6" id="herbCombinationsContainer">
                <!-- 動態載入中藥組合 -->
              </div>
            </div>

            <!-- 穴位組合內容 -->
            <div id="acupointsContent" class="personal-tab-content hidden">
              <div class="mb-6 space-y-4">
                <div class="flex gap-4 flex-wrap">
                  <button class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors" onclick="addNewAcupointCombination()">
                    + 新增穴位組合
                  </button>
                  <button class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors" onclick="showCategoryModal('acupoints')">
                    + 管理分類
                  </button>
                </div>
                <div class="flex gap-4 flex-wrap">
                  <!-- 個人慣用穴位組合：底層搜尋欄與分類篩選 -->
                  <input id="acupointComboSearchInput" type="text" placeholder="搜尋穴位組合名稱..." class="px-4 py-2 border-2 border-blue-200 rounded-lg focus:border-blue-400 focus:outline-none flex-1 min-w-64">
                  <select id="acupointComboCategoryFilter" class="px-4 py-2 border-2 border-blue-200 rounded-lg focus:border-blue-400 focus:outline-none">
                    <option>全部分類</option>
                    <option>頭面部</option>
                    <option>胸腹部</option>
                    <option>四肢部</option>
                    <option>背腰部</option>
                    <option>內科疾病</option>
                    <option>婦科疾病</option>
                  </select>
                  <select class="px-4 py-2 border-2 border-blue-200 rounded-lg focus:border-blue-400 focus:outline-none">
                    <option>全部針法</option>
                    <option>補法</option>
                    <option>瀉法</option>
                    <option>平補平瀉</option>
                    <option>配合艾灸</option>
                  </select>
                </div>
              </div>
              <div class="grid md:grid-cols-2 gap-6" id="acupointCombinationsContainer">
                <!-- 動態載入穴位組合 -->
              </div>
            </div>
            </div>
          </div>
        </div>

        <!-- 個人統計分析區：包裝在與其他頁面相同的寬度限制與內外邊距容器中，統計醫師個人用藥與穴位偏好 -->
        <div id="personalStatistics" class="hidden max-w-7xl mx-auto px-4 py-6">
          <div class="bg-white rounded-xl shadow-lg p-6">
            <div>
            <h2 class="text-2xl font-bold text-amber-800 mb-6 flex items-center">
              <span class="text-3xl mr-3">📈</span>
              個人統計分析
            </h2>
            <!-- 說明文字：指引使用者此功能用途 -->
            <p class="text-gray-600 mb-6">統計醫師個人用藥與穴位使用情況，提供用藥和穴位偏好分析。</p>
            <!-- 依序排列：方劑在上，中藥在下，穴位置底。每個卡片內部使用二欄佈局：圖表與列表並列 -->
            <div class="space-y-8">
              <!-- 常用方劑統計區塊 -->
              <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                  <span class="mr-2">📋</span>常用方劑
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                  <!-- 圖表 -->
                  <div>
                    <canvas id="personalFormulaChart" class="w-full h-60"></canvas>
                  </div>
                  <!-- 清單 -->
                  <ul id="personalFormulaList" class="divide-y divide-gray-200 text-sm">
                    <!-- 動態載入方劑統計 -->
                  </ul>
                </div>
              </div>
              <!-- 常用中藥統計區塊 -->
              <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                  <span class="mr-2">🌿</span>常用中藥
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                  <div>
                    <canvas id="personalHerbChart" class="w-full h-60"></canvas>
                  </div>
                  <ul id="personalHerbList" class="divide-y divide-gray-200 text-sm">
                    <!-- 動態載入中藥統計 -->
                  </ul>
                </div>
              </div>
              <!-- 常用穴位統計區塊 -->
              <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                  <span class="mr-2">📍</span>常用穴位
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                  <div>
                    <canvas id="personalAcupointChart" class="w-full h-60"></canvas>
                  </div>
                  <ul id="personalAcupointList" class="divide-y divide-gray-200 text-sm">
                    <!-- 動態載入穴位統計 -->
                  </ul>
                </div>
              </div>
            </div>
            </div>
          </div>
        </div>

        <!-- 帳號安全設定區：允許使用者變更密碼及刪除帳號 -->
        <div id="accountSecurity" class="hidden max-w-7xl mx-auto px-4 py-6">
          <div class="bg-white rounded-xl shadow-lg p-6">
            <div>
            <h2 class="text-2xl font-bold text-amber-800 mb-6 flex items-center">
              <span class="text-3xl mr-3">🔐</span>
              帳號安全設定
            </h2>
            <p class="text-gray-600 mb-6">在此可以安全地變更您的登入密碼或刪除帳號。此操作將影響您在系統中的登入權限，請謹慎操作。</p>
            <div class="space-y-8">
              <!-- 變更密碼區塊 -->
              <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">變更密碼</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div>
                    <label for="changeCurrentPassword" class="block text-sm font-medium text-gray-700 mb-1">當前密碼</label>
                    <input type="password" id="changeCurrentPassword" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請輸入當前密碼">
                  </div>
                  <div>
                    <label for="changeNewPassword" class="block text-sm font-medium text-gray-700 mb-1">新密碼</label>
                    <input type="password" id="changeNewPassword" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請輸入新密碼">
                  </div>
                  <div>
                    <label for="changeConfirmPassword" class="block text-sm font-medium text-gray-700 mb-1">確認新密碼</label>
                    <input type="password" id="changeConfirmPassword" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請再次輸入新密碼">
                  </div>
                </div>
                <div class="mt-4 flex justify-end">
                  <!-- 為更新密碼按鈕增加 id，以便 JavaScript 能準確找到此元素並顯示讀取圈 -->
                  <button id="updatePasswordButton" onclick="changeCurrentUserPassword()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200">更新密碼</button>
                </div>
              </div>
              <!-- 刪除帳號區塊 -->
              <div class="bg-red-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-red-800 mb-4">刪除帳號</h3>
                <p class="text-sm text-red-700 mb-4">刪除帳號後，您將無法再登入系統，且所有與此帳號相關的資料將無法恢復。請慎重操作！</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label for="deleteAccountPassword" class="block text-sm font-medium text-gray-700 mb-1">密碼確認</label>
                    <input type="password" id="deleteAccountPassword" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="請輸入您的密碼">
                  </div>
                </div>
                <div class="mt-4 flex justify-end">
                  <!-- 為刪除帳號按鈕增加 id，以便 JavaScript 能準確找到此元素並顯示讀取圈 -->
                  <button id="deleteAccountButton" onclick="deleteCurrentUserAccount()" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg transition duration-200">刪除帳號</button>
                </div>
              </div>
            </div>
            </div>
          </div>
        </div>

        <!-- 模板庫區：在外層加入與其他頁面一致的寬度與內邊距容器，卡片樣式位於內層 -->
        <!-- 模板庫區：包裝在與其他頁面相同的寬度限制與內外邊距容器中，使版面保持一致 -->
        <div id="templateLibrary" class="hidden max-w-7xl mx-auto px-4 py-6">
          <div class="bg-white rounded-xl shadow-lg p-6">
            <!-- 移除內層多餘的背景框，避免重複包裹 -->
            <div>
            <h2 class="text-2xl font-bold text-amber-800 mb-6 flex items-center">
              <span class="text-3xl mr-3">📚</span>
              模板庫
            </h2>
            
            <!-- 標籤切換：診斷模板與醫囑模板位置互換 -->
            <div class="mb-6">
              <div class="flex border-b border-gray-200">
                <!-- 將診斷模板放在前面，並預設為啟用狀態 -->
                <button class="px-6 py-3 text-amber-700 border-b-2 border-amber-500 font-medium"
                        onclick="switchTemplateTab('diagnosis')" id="diagnosisTab">
                  🔍 診斷模板
                  <!-- 動態顯示診斷模板數量 -->
                  <span id="diagnosisCount" class="ml-2 text-xs font-semibold bg-orange-100 text-orange-700 rounded-full px-2 py-0.5"></span>
                </button>
                <button class="px-6 py-3 text-gray-500 hover:text-amber-700 font-medium"
                        onclick="switchTemplateTab('prescriptions')" id="prescriptionsTab">
                  📋 醫囑模板
                  <!-- 動態顯示醫囑模板數量 -->
                  <span id="prescriptionCount" class="ml-2 text-xs font-semibold bg-purple-100 text-purple-700 rounded-full px-2 py-0.5"></span>
                </button>
              </div>
            </div>

            <!-- 診斷模板內容放在前面 -->
            <div id="diagnosisContent" class="template-tab-content">
              <div class="mb-6 space-y-4">
                <div class="flex gap-4 flex-wrap">
                </div>
                <div class="flex gap-4 flex-wrap">
                  <!-- 搜尋診斷模板名稱 -->
                  <input type="text" id="diagnosisTemplateSearch" placeholder="搜尋診斷模板名稱或內容..." class="px-4 py-2 border-2 border-orange-200 rounded-lg focus:border-orange-400 focus:outline-none flex-1 min-w-64">
                  <!-- 診斷科別篩選 -->
                  <select id="diagnosisTemplateCategoryFilter" class="px-4 py-2 border-2 border-orange-200 rounded-lg focus:border-orange-400 focus:outline-none">
                    <!-- 為了避免顯示已儲存的分類，此下拉選單僅提供整體科別篩選選項 -->
                    <option>全部科別</option>
                  </select>
                </div>
              </div>
              <div class="space-y-4" id="diagnosisTemplatesContainer">
                <!-- 動態載入診斷模板 -->
              </div>
            </div>

            <!-- 醫囑模板內容放在後面，預設隱藏 -->
            <div id="prescriptionsContent" class="template-tab-content hidden">
              <div class="mb-6 space-y-4">
                <div class="flex gap-4 flex-wrap">
                </div>
                <div class="flex gap-4 flex-wrap">
                  <!-- 搜尋醫囑模板名稱 -->
                  <input type="text" id="prescriptionTemplateSearch" placeholder="搜尋醫囑模板名稱..." class="px-4 py-2 border-2 border-purple-200 rounded-lg focus:border-purple-400 focus:outline-none flex-1 min-w-64">
                  <!-- 醫囑分類篩選 -->
                  <select id="prescriptionTemplateCategoryFilter" class="px-4 py-2 border-2 border-purple-200 rounded-lg focus:border-purple-400 focus:outline-none">
                    <!-- 為了避免顯示已儲存的分類，此下拉選單僅提供整體類別篩選選項 -->
                    <option>全部類別</option>
                  </select>
                </div>
              </div>
              <div class="space-y-4" id="prescriptionTemplatesContainer">
                <!-- 動態載入醫囑模板 -->
              </div>
            </div>
          </div>
        </div>

        <!-- 分類管理彈窗 -->
        <div id="categoryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
          <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
              <h3 class="text-xl font-bold text-gray-800" id="categoryModalTitle">管理分類</h3>
              <button onclick="hideCategoryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div class="mb-6">
              <label class="block text-gray-700 font-medium mb-2">新增分類</label>
              <div class="flex gap-2">
                <!-- 將分類名稱欄位寬度縮短為一半，避免過長 -->
                <input type="text" id="newCategoryInput" placeholder="輸入分類名稱..." class="w-1/2 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-400 focus:outline-none">
                <button onclick="addCategory()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                  新增
                </button>
              </div>
            </div>
            
            <div>
              <label class="block text-gray-700 font-medium mb-2">現有分類</label>
              <div id="categoryList" class="space-y-2 max-h-64 overflow-y-auto">
                <!-- 分類列表將在這裡動態生成 -->
              </div>
            </div>
            
            <div class="mt-6 flex justify-end">
              <button onclick="hideCategoryModal()" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                關閉
              </button>
            </div>
          </div>
        </div>

        <!-- 編輯彈窗 -->
        <div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
          <div class="bg-white rounded-xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
              <h3 class="text-xl font-bold text-gray-800" id="editModalTitle">編輯組合</h3>
              <button onclick="hideEditModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div id="editModalContent">
              <!-- 編輯內容將在這裡動態生成 -->
            </div>
            
            <div class="mt-6 flex justify-end gap-4">
              <button onclick="hideEditModal()" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                取消
              </button>
              <button onclick="saveEdit()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                保存
              </button>
            </div>
          </div>
        </div>

        <!--
            以下為常用藥方和穴位組合選擇彈窗。這兩個彈窗在診症頁面中
            讓醫師快速載入個人慣用的中藥方或針灸穴位組合。彈窗
            預設為隱藏(hidden)，當使用者點擊對應的按鈕時會透過
            JavaScript 函式 showHerbComboModal() 或 showAcupointComboModal()
            顯示。內部的列表內容會由系統.js 動態渲染。
        -->
        <!-- 常用藥方組合彈窗 -->
        <div id="herbComboModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center rounded-t-xl">
                    <h3 class="text-lg font-bold text-gray-800">常用藥方組合</h3>
                    <button onclick="hideHerbComboModal()" class="text-gray-500 hover:text-gray-700 text-xl">&times;</button>
                </div>
                <div id="herbComboList" class="p-4 space-y-3">
                    <!-- 動態載入藥方組合 -->
                </div>
            </div>
        </div>

        <!-- 常用穴位組合彈窗 -->
        <div id="acupointComboModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center rounded-t-xl">
                    <h3 class="text-lg font-bold text-gray-800">常用穴位組合</h3>
                    <button onclick="hideAcupointComboModal()" class="text-gray-500 hover:text-gray-700 text-xl">&times;</button>
                </div>
                <div id="acupointComboList" class="p-4 space-y-3">
                    <!-- 動態載入穴位組合 -->
                </div>
            </div>
        </div>

        <!-- 診斷模板選擇彈窗 -->
        <div id="diagnosisTemplateModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center rounded-t-xl">
                    <h3 class="text-lg font-bold text-gray-800">診斷模板</h3>
                    <button onclick="hideDiagnosisTemplateModal()" class="text-gray-500 hover:text-gray-700 text-xl">&times;</button>
                </div>
                <div id="diagnosisTemplateList" class="p-4 space-y-3">
                    <!-- 動態載入診斷模板 -->
                </div>
            </div>
        </div>

        <!-- 醫囑模板選擇彈窗 -->
        <div id="prescriptionTemplateModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center rounded-t-xl">
                    <h3 class="text-lg font-bold text-gray-800">醫囑模板</h3>
                    <button onclick="hidePrescriptionTemplateModal()" class="text-gray-500 hover:text-gray-700 text-xl">&times;</button>
                </div>
                <div id="prescriptionTemplateList" class="p-4 space-y-3">
                    <!-- 動態載入醫囑模板 -->
                </div>
            </div>
        </div>

        <!-- 主系統頁面不再單獨呈現版權聲明，由全局頁腳統一呈現 -->
    </div>
    <!-- 診所資料修改彈窗 -->
    <div id="clinicSettingsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                <h3 class="text-xl font-bold text-gray-800">診所資料修改</h3>
                <button onclick="hideClinicSettingsModal()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
            </div>
            
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">診所中文名稱 *</label>
                        <input type="text" id="clinicChineseName" placeholder="請輸入診所中文名稱" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">診所英文名稱</label>
                        <input type="text" id="clinicEnglishName" placeholder="請輸入診所英文名稱" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">診所營業時間</label>
                        <input type="text" id="clinicBusinessHours" placeholder="例：週一至週五 09:00-18:00" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">診所電話</label>
                        <input type="tel" id="clinicPhone" placeholder="請輸入診所電話號碼" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">診所地址</label>
                        <textarea id="clinicAddress" placeholder="請輸入診所完整地址" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                    <button onclick="hideClinicSettingsModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                        取消
                    </button>
                    <button onclick="saveClinicSettings()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200">
                        儲存
                    </button>
                </div>
            </div>
        </div>
    </div>
    
<!-- 排班管理區（由 cander_NEW.html 移植，新版本） -->
<div id="scheduleManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
    <style>
#scheduleManagement {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            /*
             * Use a white background for the schedule management card so that it
             * matches the appearance of the clinic user management card. The
             * previous transparent background caused the card to blend with
             * the page’s gradient. Also remove the forced full‑viewport height
             * to allow the card to size naturally based on its content, just
             * like other management modules.
             */
            background: #ffffff;
            min-height: auto;
            /*
             * Limit the width of the schedule management card so it matches
             * other management modules like the billing item management card. This
             * prevents the card from stretching across the full viewport.
             * Tailwind's `max-w-7xl` is 80rem (1280px), so we mirror that
             * setting here and center the card horizontally.
             */
            max-width: 80rem;
            margin-left: auto;
            margin-right: auto;
        }

#scheduleManagement .container {
            /*
             * Remove the hardcoded maximum width on the internal container. By
             * default, user management and other modules span the full width of
             * the content wrapper. Setting width to 100% ensures this module
             * aligns with them. The margin and padding are handled by the
             * outer card’s padding (p-6) so there is no need for additional
             * spacing here.
             */
            max-width: none;
            width: 100%;
            margin: 0;
            /*
             * Provide generous internal padding: 4rem at the top and 2rem on the
             * left and right. This mirrors other modules’ spacing and ensures
             * the content does not cling to the edges. The bottom padding is
             * intentionally left unset so it can be controlled by the child
             * elements or outer card’s padding.
             */
            padding-top: 4rem; /* 64px */
            padding-left: 2rem; /* 32px */
            padding-right: 2rem;
        }

#scheduleManagement .header {
            background: transparent;
            border-radius: 0;
            padding: 0 0 20px 0;
            margin-bottom: 0;
            box-shadow: none;
        }

#scheduleManagement .header h1 {
            margin: 0 0 20px 0;
            color: #2d3748;
            font-size: 28px;
            font-weight: 700;
        }



#scheduleManagement .filter-panel {
            background: transparent;
            border-radius: 0;
            padding: 0;
            margin: 0 0 20px 0;
            box-shadow: none;
            padding-top: 15px;
        }

#scheduleManagement .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            align-items: end;
        }

#scheduleManagement .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

#scheduleManagement .filter-label {
            font-size: 12px;
            font-weight: 600;
            color: #4a5568;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

#scheduleManagement .filter-select, #scheduleManagement .filter-input {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

#scheduleManagement .filter-select:focus, #scheduleManagement .filter-input:focus {
            outline: none;
            border-color: #4299e1;
        }

#scheduleManagement .quick-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

#scheduleManagement .quick-btn {
            background: #4299e1;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

#scheduleManagement .quick-btn:hover {
            background: #3182ce;
            transform: translateY(-1px);
        }

#scheduleManagement .quick-btn.danger {
            background: #f56565;
        }

#scheduleManagement .quick-btn.danger:hover {
            background: #e53e3e;
        }

#scheduleManagement .quick-btn.success {
            background: #48bb78;
        }

#scheduleManagement .quick-btn.success:hover {
            background: #38a169;
        }

#scheduleManagement .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

#scheduleManagement .nav-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

#scheduleManagement .nav-btn {
            background: #4299e1;
            color: white;
            border: none;
            /* 將原有的內距縮小為原來的一半，使按鈕整體縮小 */
            padding: 5px 8px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            /* 調整字體大小以配合縮小的尺寸 */
            font-size: 0.75rem;
        }

#scheduleManagement .nav-btn:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }

#scheduleManagement .current-date {
            font-size: 20px;
            font-weight: 700;
            color: #2d3748;
            margin: 0 20px;
        }

#scheduleManagement .view-controls {
            display: flex;
            gap: 10px;
        }

#scheduleManagement .view-btn {
            background: #e2e8f0;
            color: #4a5568;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

#scheduleManagement .view-btn.active {
            background: #48bb78;
            color: white;
        }

#scheduleManagement .view-btn:hover {
            transform: translateY(-2px);
        }

#scheduleManagement .sync-controls {
            display: flex;
            gap: 10px;
        }

#scheduleManagement .sync-btn {
            background: #805ad5;
            color: white;
            border: none;
            /* 將內距縮小一半，使同步與匯出按鈕更為精巧 */
            padding: 5px 8px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            /* 調整字體大小讓整體按鈕看起來縮小 */
            font-size: 0.75rem;
        }

#scheduleManagement .sync-btn:hover {
            background: #6b46c1;
            transform: translateY(-2px);
        }

#scheduleManagement .calendar-container {
            background: transparent;
            border-radius: 0;
            padding: 0;
            box-shadow: none;
            min-height: 600px;
        }

#scheduleManagement .calendar-grid {
            display: grid;
            gap: 1px;
            background: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
        }

#scheduleManagement .month-view {
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: auto repeat(6, 1fr);
        }





#scheduleManagement .calendar-header {
            background: #4a5568;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 700;
            font-size: 14px;
        }

#scheduleManagement .time-slot {
            background: #f7fafc;
            padding: 8px;
            font-size: 12px;
            color: #718096;
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 1px solid #e2e8f0;
        }

#scheduleManagement .calendar-cell {
            background: white;
            padding: 8px;
            min-height: 80px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
            overflow: hidden;
        }

#scheduleManagement .calendar-cell:hover {
            background: #f0fff4;
        }

#scheduleManagement .calendar-cell.other-month {
            background: #f8f9fa;
            color: #adb5bd;
        }

#scheduleManagement .calendar-cell.today {
            background: #e6fffa;
            border: 2px solid #38b2ac;
        }

        /* 公眾假期顯示樣式 */
        #scheduleManagement .calendar-cell.holiday {
            background: #fff5f5; /* 淺粉色背景區分假期 */
        }
        #scheduleManagement .calendar-cell.holiday .holiday-label {
            font-size: 10px;
            color: #e53e3e;
            margin-top: 2px;
        }

#scheduleManagement .day-number {
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 5px;
        }

#scheduleManagement .shift-item {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            padding: 4px 6px;
            border-radius: 6px;
            /* 放大排班卡片字體為原基準的 1.2 倍 */
            font-size: 11px;
            margin: 1px 0;
            cursor: move;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border-left: 3px solid rgba(255,255,255,0.3);
            word-wrap: break-word;
            line-height: 1.2;
        }

#scheduleManagement .shift-item:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }

#scheduleManagement .shift-item.doctor {
            background: linear-gradient(135deg, #48bb78, #38a169);
        }

#scheduleManagement .shift-item.nurse {
            background: linear-gradient(135deg, #ed8936, #dd6b20);
        }

#scheduleManagement .shift-item.emergency {
            background: linear-gradient(135deg, #f56565, #e53e3e);
            animation: pulse 2s infinite;
        }

#scheduleManagement .shift-item.overtime {
            background: linear-gradient(135deg, #9f7aea, #805ad5);
            border-left-color: #ffd700;
        }

#scheduleManagement .shift-item.dragging {
            opacity: 0.7;
            transform: rotate(5deg) scale(1.1);
            z-index: 1000;
        }

#scheduleManagement .shift-item .shift-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2px;
        }

#scheduleManagement .shift-item .shift-name {
            font-weight: 600;
            /* 排班卡片內的姓名字體放大 1.2 倍 */
            font-size: 11px;
        }

#scheduleManagement .shift-item .shift-actions {
            display: flex;
            gap: 2px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

#scheduleManagement .shift-item:hover .shift-actions {
            opacity: 1;
        }

#scheduleManagement .shift-action-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            /* 將按鈕尺寸及字體放大 1.2 倍 */
            width: 19px;
            height: 19px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

#scheduleManagement .shift-action-btn:hover {
            background: rgba(255,255,255,0.3);
        }

#scheduleManagement .shift-details {
            /* 放大排班詳情字體為原基準的 1.2 倍 */
            font-size: 9px;
            opacity: 0.9;
            line-height: 1.1;
        }

        /* 顯示職位名稱的樣式 */
        #scheduleManagement .shift-item .staff-position {
            margin-left: 2px;
            /* 放大職位標籤字體為原基準的 1.2 倍 */
            font-size: 10px;
            font-weight: 500;
            opacity: 0.85;
        }
        #scheduleManagement .staff-name .staff-position {
            margin-left: 2px;
            font-size: 11px;
            font-weight: 500;
            color: #4a5568;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

#scheduleManagement .drop-zone {
            border: 2px dashed #4299e1;
            background: rgba(66, 153, 225, 0.1);
        }

#scheduleManagement .staff-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: sticky;
            top: 20px;
            /*
             * Reduce z-index for staff panel so it doesn't overlap
             * the sidebar (診所功能列表). The sidebar uses z-index 50 via
             * Tailwind’s z-50 utility class. Setting the staff panel below
             * this value ensures the sidebar remains on top when open.
             */
            /*
             * Lower the z-index further so that the sidebar overlay (which uses
             * Tailwind’s z-40 class) appears on top when the clinic functions
             * sidebar is open. A lower z-index prevents the staff panel from
             * blocking the dark overlay effect.
             */
            z-index: 30;
        }

#scheduleManagement .staff-panel h3 {
            margin: 0 0 15px 0;
            color: #2d3748;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

#scheduleManagement .staff-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

#scheduleManagement .staff-card {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            border-radius: 8px;
            padding: 8px 12px;
            border: 2px solid transparent;
            cursor: grab;
            transition: all 0.3s ease;
            min-width: 80px;
            max-width: 120px;
            position: relative;
            overflow: hidden;
            user-select: none;
            text-align: center;
        }

#scheduleManagement .staff-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: rgba(66, 153, 225, 0.3);
        }

#scheduleManagement .staff-card:active {
            cursor: grabbing;
        }

#scheduleManagement .staff-card.dragging {
            opacity: 0.8;
            transform: rotate(5deg) scale(1.05);
            z-index: 1000;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

#scheduleManagement .staff-card.doctor {
            border-left: 4px solid #48bb78;
            background: linear-gradient(135deg, #f0fff4, #e6fffa);
        }

#scheduleManagement .staff-card.doctor:hover {
            border-color: #48bb78;
            background: linear-gradient(135deg, #e6fffa, #c6f6d5);
        }

#scheduleManagement .staff-card.nurse {
            border-left: 4px solid #ed8936;
            background: linear-gradient(135deg, #fffaf0, #fef5e7);
        }

#scheduleManagement .staff-card.nurse:hover {
            border-color: #ed8936;
            background: linear-gradient(135deg, #fef5e7, #fed7aa);
        }



#scheduleManagement .staff-name {
            font-weight: 600;
            color: #2d3748;
            font-size: 13px;
            margin-bottom: 4px;
        }

#scheduleManagement .staff-status {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2px;
            font-size: 9px;
            color: #68d391;
            font-weight: 500;
        }

#scheduleManagement .staff-status.busy {
            color: #f56565;
        }

#scheduleManagement .staff-status.partial {
            color: #ed8936;
        }

#scheduleManagement .drag-hint {
            position: absolute;
            bottom: 2px;
            right: 4px;
            font-size: 10px;
            color: #cbd5e0;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

#scheduleManagement .staff-card:hover .drag-hint {
            opacity: 1;
        }



#scheduleManagement .staff-filter {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

#scheduleManagement .staff-filter-btn {
            background: #e2e8f0;
            border: none;
            color: #4a5568;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

#scheduleManagement .staff-filter-btn.active {
            background: #4299e1;
            color: white;
        }

#scheduleManagement .staff-filter-btn:hover {
            transform: translateY(-1px);
        }

#scheduleManagement .drop-target {
            border: 2px dashed #4299e1 !important;
            background: rgba(66, 153, 225, 0.1) !important;
        }

#scheduleManagement .drop-target::after {
            content: '放開以新增排班';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #4299e1;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            pointer-events: none;
            z-index: 10;
        }

#scheduleManagement .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

#scheduleManagement .modal.show {
            display: flex;
        }

#scheduleManagement .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

#scheduleManagement .form-group {
            margin-bottom: 20px;
        }

#scheduleManagement .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3748;
        }

#scheduleManagement .form-input, #scheduleManagement .form-select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

#scheduleManagement .form-input:focus, #scheduleManagement .form-select:focus {
            outline: none;
            border-color: #4299e1;
        }

#scheduleManagement .form-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 25px;
        }

#scheduleManagement .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

#scheduleManagement .btn-primary {
            background: #4299e1;
            color: white;
        }

#scheduleManagement .btn-primary:hover {
            background: #3182ce;
        }

#scheduleManagement .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

#scheduleManagement .btn-secondary:hover {
            background: #cbd5e0;
        }

#scheduleManagement .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #48bb78;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1001;
        }

#scheduleManagement .notification.show {
            transform: translateX(0);
        }



        @media (max-width: 768px) {
#scheduleManagement .controls {
                flex-direction: column;
                align-items: stretch;
            }

#scheduleManagement .nav-controls, #scheduleManagement .view-controls, #scheduleManagement .sync-controls {
                justify-content: center;
            }

#scheduleManagement .current-date {
                margin: 10px 0;
                text-align: center;
            }

#scheduleManagement .calendar-grid.month-view {
                grid-template-columns: repeat(7, 1fr);
                font-size: 12px;
            }

#scheduleManagement .calendar-cell {
                min-height: 60px;
                padding: 4px;
            }

#scheduleManagement .shift-item {
                /* 調整窄螢幕下的排班卡片字體大小為原基準 1.2 倍 */
                font-size: 11px;
                padding: 2px 4px;
            }

        /* 在窄螢幕下為排班管理卡片添加左右內邊距，避免內容緊貼螢幕邊緣 */
        #scheduleManagement {
                padding-left: 1rem;
                padding-right: 1rem;
        }


        }
    </style>
    <!-- 額外覆寫排班管理樣式，使字體更小並移除拖放提示 -->
    <style>
        /* 調整排班管理介面字體尺寸及樣式 */
        #scheduleManagement .calendar-header {
            font-size: 12px !important;
        }
        #scheduleManagement .time-slot {
            font-size: 10px !important;
        }
        #scheduleManagement .shift-item {
            /* 將排班卡片整體字體放大為原設定的 1.2 倍 */
            font-size: 11px !important;
        }
        #scheduleManagement .shift-item .shift-name {
            /* 排班卡片內的姓名字體同步放大 1.2 倍 */
            font-size: 11px !important;
        }
        #scheduleManagement .shift-action-btn {
            /* 操作按鈕字體及尺寸放大 1.2 倍 */
            font-size: 11px !important;
            /* 調整寬高與基準一併放大 1.2 倍 */
            width: 19px !important;
            height: 19px !important;
        }
        #scheduleManagement .shift-details {
            /* 排班詳情字體放大約 1.2 倍 */
            font-size: 9px !important;
        }
        #scheduleManagement .shift-item .staff-position {
            /* 職位標籤字體依比例調整 */
            font-size: 10px !important;
        }
        #scheduleManagement .staff-name {
            font-size: 11px !important;
        }
        #scheduleManagement .staff-status {
            font-size: 8px !important;
        }
        #scheduleManagement .drag-hint {
            font-size: 9px !important;
        }
        #scheduleManagement .staff-filter-btn {
            font-size: 10px !important;
        }
        #scheduleManagement .filter-label {
            font-size: 10px !important;
        }
        #scheduleManagement .filter-select,
        #scheduleManagement .filter-input {
            font-size: 12px !important;
        }
        #scheduleManagement .quick-btn {
            font-size: 10px !important;
        }
        /* 移除拖放提示文字 */
        #scheduleManagement .drop-target::after {
            display: none !important;
            content: none !important;
        }
    </style>
        <div class="container">
        <!-- 將標題獨立顯示，不納入漸層背景區塊 -->
        <div class="header">
            <h1><span class="text-3xl mr-3">📅 </span>醫療排班系統</h1>
        </div>
        <!-- 控制按鈕與篩選面板包裹於漸層背景方框中 -->
        <div class="bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-6 mb-6">
            <div class="controls">
                <div class="nav-controls">
                    <!-- 更新按鈕文字為「上一個月」，無箭頭符號 -->
                    <button class="nav-btn" onclick="scheduleNavigateCalendar(-1)">上一個月</button>
                    <div class="current-date" id="currentDate"></div>
                    <!-- 更新按鈕文字為「下一個月」，無箭頭符號 -->
                    <button class="nav-btn" onclick="scheduleNavigateCalendar(1)">下一個月</button>
                    <button class="nav-btn" onclick="scheduleGoToToday()"><span class="text-1xl mr-1">📅 </span> 今天</button>
                </div>
                <div class="view-controls">
                    <!-- 假期選擇下拉式選單 -->
                    <select id="holidaySelector"
                        class="border border-gray-300 rounded px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        onchange="scheduleChangeHolidayRegion(this.value)">
                        <option value="">顯示假期: 無</option>
                        <option value="hk">香港假期</option>
                        <option value="us">美國假期</option>
                    </select>
                </div>
                <div class="sync-controls">
                    <!-- 已移除同步 Google 功能 -->
                    <button class="sync-btn" onclick="scheduleExportToICal()"><span class="text-1xl mr-1">📋</span> 匯出 iCal</button>
                    <!-- 新增列印更表按鈕：列印當前月份的排班表 -->
                    <button class="sync-btn" onclick="schedulePrintShiftTable()"><span class="text-1xl mr-1">🖨️</span> 列印更表</button>
                </div>
            </div>

            <!-- 篩選面板 -->
            <div class="filter-panel">
            <div class="filter-grid">
                <div class="filter-group">
                    <label class="filter-label">職位篩選</label>
                    <select class="filter-select" id="roleFilter" onchange="scheduleApplyFilters()">
                        <option value="">所有職位</option>
                        <option value="doctor">醫師</option>
                        <option value="nurse">護理師</option>
                        <!-- 新增選項：自己。當選擇此選項時，只會顯示當前登入用戶的排班 -->
                        <option value="self">自己</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">班別篩選</label>
                    <select class="filter-select" id="shiftTypeFilter" onchange="scheduleApplyFilters()">
                        <option value="">所有班別</option>
                        <option value="morning">早班</option>
                        <option value="afternoon">中班</option>
                        <option value="night">夜班</option>
                        <option value="emergency">急診</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">搜尋人員</label>
                    <input type="text" class="filter-input" id="staffSearch" placeholder="輸入姓名..." oninput="scheduleApplyFilters()">
                </div>
                <!-- 為快速操作區塊新增 id 以便根據權限顯示/隱藏 -->
                <div class="quick-actions" id="quickActions">
                    <button class="quick-btn" onclick="scheduleOpenFixedScheduleModal()"><span class="text-1xl mr-1">📅</span> 固定上班</button>
                    <button class="quick-btn danger" onclick="scheduleClearAllShifts()"><span class="text-1xl mr-1">🗑️</span> 清空排班</button>
                </div>
            </div>
            </div>
        </div>

        <div class="calendar-container">
            <div class="calendar-grid month-view" id="calendarGrid"></div>
        </div>

        <div class="staff-panel">
            <!-- 將「醫護人員管理」改為「醫護人員」，並為拖拽提示新增 id 以便根據權限隱藏 -->
            <h3><span class="text-1xl mr-1">👨‍⚕️👩‍⚕️</span> 醫護人員 <span id="dragInstruction" style="font-size: 12px; color: #718096; font-weight: normal;">拖拽人員到行事曆新增排班</span></h3>
            <div class="staff-filter">
                <button class="staff-filter-btn active" onclick="scheduleFilterStaff('all')">全部</button>
                <button class="staff-filter-btn" onclick="scheduleFilterStaff('doctor')">醫師</button>
                <button class="staff-filter-btn" onclick="scheduleFilterStaff('nurse')">護理師</button>

            </div>
            <div class="staff-grid" id="staffGrid"></div>
        </div>
    </div>

    <!-- 新增排班模態框 -->
    <div class="modal" id="shiftModal">
        <div class="modal-content">
            <h3>新增排班</h3>
            <form id="shiftForm">
                <div class="form-group">
                    <label class="form-label">人員</label>
                    <select class="form-select" id="staffSelect" required></select>
                </div>
                <div class="form-group">
                    <label class="form-label">日期</label>
                    <input type="date" class="form-input" id="shiftDate" required>
                </div>
                <div class="form-group">
                    <label class="form-label">開始時間</label>
                    <input type="time" class="form-input" id="startTime" required>
                </div>
                <div class="form-group">
                    <label class="form-label">結束時間</label>
                    <input type="time" class="form-input" id="endTime" required>
                </div>
                <div class="form-group">
                    <label class="form-label">班別</label>
                    <select class="form-select" id="shiftType" required>
                        <option value="morning">早班 (08:00-16:00)</option>
                        <option value="afternoon">中班 (16:00-24:00)</option>
                        <option value="night">夜班 (00:00-08:00)</option>
                        <option value="emergency">急診班</option>
                        <option value="custom">自訂時間</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">備註</label>
                    <input type="text" class="form-input" id="shiftNotes" placeholder="輸入備註資訊...">
                </div>
                <div class="form-buttons">
                    <button type="button" class="btn btn-secondary" onclick="scheduleCloseModal()">取消</button>
                    <button type="submit" class="btn btn-primary">新增排班</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 固定上班模態框 -->
    <div class="modal" id="fixedScheduleModal">
        <div class="modal-content">
            <h3>設定固定上班時間</h3>
            <form id="fixedScheduleForm">
                <div class="form-group">
                    <label class="form-label">選擇人員</label>
                    <select class="form-select" id="fixedStaffSelect" required></select>
                </div>
                <div class="form-group">
                    <label class="form-label">固定班別</label>
                    <select class="form-select" id="fixedShiftType" required>
                        <option value="morning">早班 (08:00-16:00)</option>
                        <option value="afternoon">中班 (16:00-24:00)</option>
                        <option value="night">夜班 (00:00-08:00)</option>
                        <option value="custom">自訂時間</option>
                    </select>
                </div>
                <div class="form-group" id="customTimeGroup" style="display: none;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label class="form-label">開始時間</label>
                            <input type="time" class="form-input" id="fixedStartTime">
                        </div>
                        <div>
                            <label class="form-label">結束時間</label>
                            <input type="time" class="form-input" id="fixedEndTime">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">工作日選擇</label>
                    <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; margin-top: 10px;">
                        <label style="display: flex; align-items: center; gap: 5px; font-size: 12px;">
                            <input type="checkbox" id="day0" value="0"> 日
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; font-size: 12px;">
                            <input type="checkbox" id="day1" value="1" checked> 一
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; font-size: 12px;">
                            <input type="checkbox" id="day2" value="2" checked> 二
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; font-size: 12px;">
                            <input type="checkbox" id="day3" value="3" checked> 三
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; font-size: 12px;">
                            <input type="checkbox" id="day4" value="4" checked> 四
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; font-size: 12px;">
                            <input type="checkbox" id="day5" value="5" checked> 五
                        </label>
                        <label style="display: flex; align-items: center; gap: 5px; font-size: 12px;">
                            <input type="checkbox" id="day6" value="6"> 六
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">應用範圍</label>
                    <select class="form-select" id="scheduleRange" required>
                        <option value="current-month">本月份</option>
                        <option value="next-month">下個月</option>
                        <option value="current-and-next">本月及下個月</option>
                        <option value="custom-range">自訂日期範圍</option>
                    </select>
                </div>
                <div class="form-group" id="customRangeGroup" style="display: none;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label class="form-label">開始日期</label>
                            <input type="date" class="form-input" id="rangeStartDate">
                        </div>
                        <div>
                            <label class="form-label">結束日期</label>
                            <input type="date" class="form-input" id="rangeEndDate">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">備註</label>
                    <!-- 預設留空，避免每次產生固定排班時自動填入文字 -->
                    <input type="text" class="form-input" id="fixedScheduleNotes" placeholder="固定上班排程">
                </div>
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 8px; font-size: 14px; color: #4a5568;">
                        <input type="checkbox" id="replaceExisting" checked>
                        覆蓋現有排班（如果有衝突）
                    </label>
                </div>
                <div class="form-buttons">
                    <button type="button" class="btn btn-secondary" onclick="scheduleCloseFixedScheduleModal()">取消</button>
                    <button type="submit" class="btn btn-primary">建立固定排班</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 通知 -->
    <div class="notification" id="notification"></div>

    <!-- 停用舊的排班管理示範腳本，避免與 schedule_management.js 重複。 -->
    <script type="text/removed">
        // 全域變數
        let currentDate = new Date();
        let currentView = 'month';
        let draggedShift = null;
        let currentStaffFilter = 'all';

        // 醫護人員資料
        // 預設不使用任何示範用戶。實際人員資料將由 schedule_management.js 載入，
        // 並儲存在全域 window.staff 中。此處僅從 window.staff 取得引用，若尚未載入則為空陣列。
        let staff = window.staff || [];

        // 管理員檢查與時間解析函式
        // 判斷當前登入用戶是否具有管理員權限：當前用戶職位包含「管理」或郵件為 admin@clinic.com。
        if (typeof window.isAdminUser !== 'function') {
            window.isAdminUser = function () {
                try {
                    let user = null;
                    if (typeof currentUserData !== 'undefined' && currentUserData) {
                        user = currentUserData;
                    } else if (typeof window.currentUserData !== 'undefined' && window.currentUserData) {
                        user = window.currentUserData;
                    } else if (typeof window.currentUser !== 'undefined' && window.currentUser) {
                        user = window.currentUser;
                    } else {
                        user = {};
                    }
                    const pos = (user.position || user.role || '').toString().trim();
                    const email = (user.email || '').toString().toLowerCase().trim();
                    if (pos && (pos === '診所管理' || pos.includes('管理'))) {
                        return true;
                    }
                    if (email === 'admin@clinic.com') {
                        return true;
                    }
                    return false;
                } catch (_e) {
                    return false;
                }
            };
        }

        /**
         * 確認是否為管理員。非管理員時顯示提示訊息並返回 false。
         * @param {string} operationName 用於提示的操作描述
         * @returns {boolean}
         */
        function ensureAdmin(operationName = '此操作') {
            if (!window.isAdminUser || !window.isAdminUser()) {
                const opText = operationName || '此操作';
                showNotification('只有管理員才能執行' + opText + '！');
                return false;
            }
            return true;
        }

        /**
         * 將時間字串轉換為分鐘，支援 24:00 跨日情況。
         * @param {string} timeStr 格式 HH:MM
         * @returns {number}
         */
        function parseTimeToMinutes(timeStr) {
            if (!timeStr) return 0;
            const parts = timeStr.split(':');
            const hh = parseInt(parts[0], 10);
            const mm = parseInt(parts[1], 10) || 0;
            if (!isNaN(hh) && hh >= 24) {
                return 24 * 60 + (isNaN(mm) ? 0 : mm);
            }
            const hours = isNaN(hh) ? 0 : hh;
            const minutes = isNaN(mm) ? 0 : mm;
            return hours * 60 + minutes;
        }

        // 透過人員 ID 取得人員資料。由於 staff 可能尚未載入，或找不到對應人員，
        // 因此此函式會從 window.staff 或本地 staff 陣列中查找，若無結果則回傳預設物件。
        function getStaffMemberById(id) {
            // 嘗試從最新的 window.staff 取得
            const arr = (window.staff && Array.isArray(window.staff)) ? window.staff : staff;
            const member = Array.isArray(arr) ? arr.find(s => s.id == id) : undefined;
            // 如果沒有找到，提供預設值以避免 undefined 屬性存取錯誤
            return member || {
                id: id,
                name: '未知人員',
                role: '',
                department: '',
                level: '',
                phone: '',
                email: ''
            };
        }

        // 包裝函式：處理班表上按鈕點擊，避免 inline 事件包含多個語句而無法被 system.js 解析。
        // 這些函式會處理事件的 stopPropagation / preventDefault，然後呼叫實際的編輯或刪除函式。
        function handleEditShift(e, shiftId) {
            if (e && typeof e.stopPropagation === 'function') e.stopPropagation();
            // 如果 scheduleEditShift 函式存在（由 schedule_management.js 或其他腳本暴露），優先使用
            if (typeof window.scheduleEditShift === 'function') {
                window.scheduleEditShift(shiftId);
            } else if (typeof editShift === 'function') {
                // 否則退回本地定義的 editShift
                editShift(shiftId);
            }
        }

        function handleDeleteShift(e, shiftId) {
            if (e && typeof e.stopPropagation === 'function') e.stopPropagation();
            if (e && typeof e.preventDefault === 'function') e.preventDefault();
            if (typeof window.scheduleDeleteShift === 'function') {
                window.scheduleDeleteShift(shiftId);
            } else if (typeof deleteShift === 'function') {
                deleteShift(shiftId);
            }
        }

        // 將包裝函式掛載到全域（window），供 inline 事件呼叫
        window.handleEditShift = handleEditShift;
        window.handleDeleteShift = handleDeleteShift;

        // 排班資料 - 使用當前月份的日期
        let shifts = [];

        // 初始化一些示範排班資料
        function initializeSampleShifts() {
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();

            // 確保使用一致的日期，避免視圖間不同步
            const baseDate = 26; // 統一使用26號作為示範日期

            shifts = [
                { id: 1, staffId: 1, date: `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${baseDate.toString().padStart(2, '0')}`, startTime: '08:00', endTime: '16:00', type: 'morning', status: 'confirmed', notes: '門診' },
                { id: 2, staffId: 4, date: `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${baseDate.toString().padStart(2, '0')}`, startTime: '08:00', endTime: '16:00', type: 'morning', status: 'confirmed', notes: '病房' },
                { id: 3, staffId: 2, date: `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${(baseDate + 1).toString().padStart(2, '0')}`, startTime: '16:00', endTime: '24:00', type: 'afternoon', status: 'pending', notes: '手術房' },
                { id: 4, staffId: 5, date: `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${(baseDate + 1).toString().padStart(2, '0')}`, startTime: '16:00', endTime: '24:00', type: 'afternoon', status: 'confirmed', notes: '病房' },
                { id: 5, staffId: 3, date: `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${(baseDate + 2).toString().padStart(2, '0')}`, startTime: '00:00', endTime: '08:00', type: 'night', status: 'confirmed', notes: '急診' },
                { id: 6, staffId: 6, date: `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${(baseDate + 2).toString().padStart(2, '0')}`, startTime: '00:00', endTime: '08:00', type: 'night', status: 'confirmed', notes: '急診' },
                { id: 7, staffId: 7, date: `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${(baseDate - 1).toString().padStart(2, '0')}`, startTime: '09:00', endTime: '17:00', type: 'morning', status: 'confirmed', notes: '兒科門診' },
                { id: 8, staffId: 8, date: `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${(baseDate - 1).toString().padStart(2, '0')}`, startTime: '09:00', endTime: '17:00', type: 'morning', status: 'confirmed', notes: '兒科病房' }
            ];
        }

        // 篩選狀態
        let currentFilters = {
            department: '',
            role: '',
            shiftType: '',
            staffSearch: ''
        };

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 不再載入示範排班資料
            updateCurrentDate();
            renderCalendar();
            renderStaffPanel();
            setupEventListeners();
            updateStats();
        });

        // 設定事件監聽器
        function setupEventListeners() {
            // 班別選擇變更
            document.getElementById('shiftType').addEventListener('change', function() {
                const type = this.value;
                const startTime = document.getElementById('startTime');
                const endTime = document.getElementById('endTime');

                switch(type) {
                    case 'morning':
                        startTime.value = '08:00';
                        endTime.value = '16:00';
                        break;
                    case 'afternoon':
                        startTime.value = '16:00';
                        endTime.value = '24:00';
                        break;
                    case 'night':
                        startTime.value = '00:00';
                        endTime.value = '08:00';
                        break;
                }
            });

            // 固定排班班別選擇變更
            document.getElementById('fixedShiftType').addEventListener('change', function() {
                const type = this.value;
                const customTimeGroup = document.getElementById('customTimeGroup');
                const startTime = document.getElementById('fixedStartTime');
                const endTime = document.getElementById('fixedEndTime');

                if (type === 'custom') {
                    customTimeGroup.style.display = 'block';
                } else {
                    customTimeGroup.style.display = 'none';
                    switch(type) {
                        case 'morning':
                            startTime.value = '08:00';
                            endTime.value = '16:00';
                            break;
                        case 'afternoon':
                            startTime.value = '16:00';
                            endTime.value = '24:00';
                            break;
                        case 'night':
                            startTime.value = '00:00';
                            endTime.value = '08:00';
                            break;
                    }
                }
            });

            // 排程範圍選擇變更
            document.getElementById('scheduleRange').addEventListener('change', function() {
                const customRangeGroup = document.getElementById('customRangeGroup');
                if (this.value === 'custom-range') {
                    customRangeGroup.style.display = 'block';
                } else {
                    customRangeGroup.style.display = 'none';
                }
            });

            // 表單提交
            document.getElementById('shiftForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addShift();
            });

            // 固定排班表單提交
            document.getElementById('fixedScheduleForm').addEventListener('submit', function(e) {
                e.preventDefault();
                createFixedSchedule();
            });
        }

        // 更新當前日期顯示
        function updateCurrentDate() {
            const options = { year: 'numeric', month: 'long' };
            document.getElementById('currentDate').textContent = currentDate.toLocaleDateString('zh-TW', options);
        }

        // 導航行事曆
        function navigateCalendar(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            updateCurrentDate();
            renderCalendar();
        }

        // 切換視圖（僅保留月視圖）
        function changeView(view) {
            // 僅支援月視圖
            currentView = 'month';
            updateCurrentDate();
            renderCalendar();
        }

        // 渲染行事曆
        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            grid.className = 'calendar-grid month-view';
            renderMonthView(grid);
        }

        // 渲染月視圖
        function renderMonthView(grid) {
            // 添加星期標題
            const weekdays = ['日', '一', '二', '三', '四', '五', '六'];
            weekdays.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-header';
                header.textContent = day;
                grid.appendChild(header);
            });

            // 獲取月份的第一天和最後一天
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            // 渲染42個格子（6週）
            for (let i = 0; i < 42; i++) {
                const cellDate = new Date(startDate);
                cellDate.setDate(startDate.getDate() + i);

                const cell = document.createElement('div');
                cell.className = 'calendar-cell';
                cell.dataset.date = cellDate.toISOString().split('T')[0];

                if (cellDate.getMonth() !== currentDate.getMonth()) {
                    cell.classList.add('other-month');
                }

                if (isToday(cellDate)) {
                    cell.classList.add('today');
                }

                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = cellDate.getDate();
                cell.appendChild(dayNumber);

                // 添加排班
                const dayShifts = getShiftsForDate(cellDate).filter(passesFilter);
                dayShifts.forEach(shift => {
                    const shiftElement = createShiftElement(shift);
                    cell.appendChild(shiftElement);
                });

                // 添加拖放功能
                setupCellDropZone(cell);

                grid.appendChild(cell);
            }
        }



        // 創建排班元素
        function createShiftElement(shift) {
            const staffMember = getStaffMemberById(shift.staffId);
            const element = document.createElement('div');

            // 設定基礎樣式
            let shiftClasses = `shift-item ${staffMember.role}`;
            if (shift.type === 'emergency') shiftClasses += ' emergency';
            if (shift.status === 'overtime') shiftClasses += ' overtime';

            element.className = shiftClasses;
            element.draggable = true;
            element.dataset.shiftId = shift.id;

            // 計算時數並獲取狀態圖示
            const duration = calculateShiftDuration(shift.startTime, shift.endTime);
            const statusIcon = shift.status === 'confirmed' ? '✓' : shift.status === 'pending' ? '⏳' : '❌';

            // 判斷是否為管理員以決定是否顯示操作按鈕
            const isAdmin = window.isAdminUser && window.isAdminUser();
            let actionsHtml = '';
            if (isAdmin) {
                actionsHtml = `<div class="shift-actions">
                        <button class="shift-action-btn" onclick="handleEditShift(event, ${shift.id})" title="編輯">✏️</button>
                        <button class="shift-action-btn" onclick="handleDeleteShift(event, ${shift.id})" title="刪除">🗑️</button>
                    </div>`;
            }

            // 組合內部 HTML，非管理員將不顯示操作按鈕
            element.innerHTML = `
                <div class="shift-header">
                    <div class="shift-name">${staffMember.name}</div>
                    ${actionsHtml}
                </div>
                <div class="shift-details">
                    ${shift.startTime}-${shift.endTime} (${duration}h)<br>
                    ${statusIcon} ${shift.notes || '一般排班'}<br>
                    <small>${staffMember.department} - ${staffMember.level}</small>
                </div>
            `;

            // 拖拽事件
            element.addEventListener('dragstart', function(e) {
                draggedShift = shift;
                this.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'move';
            });

            element.addEventListener('dragend', function() {
                this.classList.remove('dragging');
                draggedShift = null;
            });

            // 點擊事件（防止拖拽時觸發）
            element.addEventListener('click', function(e) {
                if (!e.target.classList.contains('shift-action-btn')) {
                    showShiftDetails(shift);
                }
            });

            return element;
        }

        // 計算排班時數（使用分鐘計算，支援跨日與 24:00）
        function calculateShiftDuration(startTime, endTime) {
            let startMinutes = parseTimeToMinutes(startTime);
            let endMinutes = parseTimeToMinutes(endTime);
            // 若結束分鐘小於等於開始分鐘，表示跨日，需補 24 小時
            if (endMinutes <= startMinutes) {
                endMinutes += 24 * 60;
            }
            const durationMinutes = endMinutes - startMinutes;
            return Math.round((durationMinutes / 60) * 10) / 10;
        }

        // 設定格子拖放區域
        function setupCellDropZone(cell) {
            cell.addEventListener('dragover', function(e) {
                e.preventDefault();

                // 檢查是否是人員拖拽或排班拖拽
                const staffId = e.dataTransfer.getData('text/plain');
                if (staffId) {
                    e.dataTransfer.dropEffect = 'copy';
                } else if (draggedShift) {
                    e.dataTransfer.dropEffect = 'move';
                }

                this.classList.add('drop-zone');
            });

            cell.addEventListener('dragleave', function(e) {
                // 只有當滑鼠真正離開格子時才移除樣式
                if (!this.contains(e.relatedTarget)) {
                    this.classList.remove('drop-zone');
                }
            });

            cell.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('drop-zone');

                // 僅限管理員可操作拖拽新增或移動排班
                if (!ensureAdmin('新增或移動排班')) {
                    return;
                }

                const staffId = e.dataTransfer.getData('text/plain');

                if (staffId) {
                    // 人員拖拽 - 快速新增排班
                    const staffMember = getStaffMemberById(staffId);
                    // 如果找到有效人員則快速新增排班；若為未知人員則不處理
                    if (staffMember && staffMember.name !== '未知人員') {
                        quickAddShiftFromDrag(staffMember, this.dataset.date);
                    }
                } else if (draggedShift) {
                    // 排班拖拽 - 移動排班
                    const newDate = this.dataset.date;
                    // 更新排班日期
                    draggedShift.date = newDate;
                    renderCalendar();
                    showNotification('排班已成功移動！');
                }
            });

            // 點擊添加排班
            cell.addEventListener('click', function(e) {
                // 避免在拖拽操作時觸發點擊
                if (!e.target.closest('.shift-item')) {
                    openShiftModal(this.dataset.date);
                }
            });
        }

        // 快速新增排班（從拖拽）
        function quickAddShiftFromDrag(staffMember, date, hour) {
            // 僅允許管理員執行快速新增排班
            if (!ensureAdmin('新增排班')) {
                return;
            }
            // 月視圖 - 預設早班
            const startTime = '08:00';
            const endTime = '16:00';
            const shiftType = 'morning';

            // 檢查是否已有排班衝突
            const existingShift = shifts.find(s =>
                s.staffId === staffMember.id &&
                s.date === date &&
                s.startTime === startTime
            );

            if (existingShift) {
                showNotification(`${staffMember.name} 在該時段已有排班！`);
                return;
            }

            // 新增排班
            const newShift = {
                id: Date.now(),
                staffId: staffMember.id,
                date: date,
                startTime: startTime,
                endTime: endTime,
                type: shiftType,
                status: 'confirmed',
                notes: '拖拽快速新增'
            };

            shifts.push(newShift);
            renderCalendar();
            renderStaffPanel(); // 更新人員狀態
            updateStats();

            const shiftTypeName = getShiftTypeName(shiftType);
            showNotification(`已為 ${staffMember.name} 新增 ${shiftTypeName} (${startTime}-${endTime})！`);
        }

        // 輔助函數
        function isToday(date) {
            const today = new Date();
            return date.toDateString() === today.toDateString();
        }

        function getShiftsForDate(date) {
            const dateStr = date.toISOString().split('T')[0];
            return shifts.filter(shift => shift.date === dateStr);
        }

        // 渲染人員面板
        function renderStaffPanel() {
            const grid = document.getElementById('staffGrid');
            grid.innerHTML = '';

            const filteredStaff = getFilteredStaff();

            filteredStaff.forEach(member => {
                const card = document.createElement('div');
                card.className = `staff-card ${member.role}`;
                card.draggable = true;
                card.dataset.staffId = member.id;



                card.innerHTML = `
                    <div class="staff-name">${member.name}</div>
                    <div class="drag-hint">🖱️</div>
                `;

                // 設定拖拽事件
                setupStaffDragEvents(card, member);

                grid.appendChild(card);
            });

            // 更新人員選擇下拉選單
            updateStaffSelects();
        }

        // 設定人員拖拽事件
        function setupStaffDragEvents(card, member) {
            let draggedStaffMember = null;

            card.addEventListener('dragstart', function(e) {
                draggedStaffMember = member;
                this.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'copy';
                e.dataTransfer.setData('text/plain', member.id);

                // 高亮可放置的區域
                document.querySelectorAll('.calendar-cell').forEach(cell => {
                    cell.classList.add('drop-target');
                });
            });

            card.addEventListener('dragend', function() {
                this.classList.remove('dragging');
                draggedStaffMember = null;

                // 移除高亮
                document.querySelectorAll('.calendar-cell').forEach(cell => {
                    cell.classList.remove('drop-target');
                });
            });

            // 儲存到全域變數供其他函數使用
            card.draggedStaffMember = member;
        }

        // 獲取篩選後的人員
        function getFilteredStaff() {
            const filter = currentStaffFilter || 'all';

            switch (filter) {
                case 'doctor':
                    return staff.filter(s => s.role === 'doctor');
                case 'nurse':
                    return staff.filter(s => s.role === 'nurse');
                default:
                    return staff;
            }
        }

        // 獲取今日人員排班
        function getTodayShiftsForStaff(staffId) {
            const today = new Date().toISOString().split('T')[0];
            return shifts.filter(shift => shift.staffId === staffId && shift.date === today);
        }

        // 獲取人員狀態
        function getStaffStatus(staffId, todayShifts) {
            if (todayShifts.length === 0) {
                return { class: '', icon: '✅', text: '可排班' };
            } else if (todayShifts.length === 1) {
                return { class: 'partial', icon: '⏰', text: '已排班' };
            } else {
                return { class: 'busy', icon: '🔴', text: '滿班' };
            }
        }

        // 更新人員選擇下拉選單
        function updateStaffSelects() {
            const select = document.getElementById('staffSelect');
            select.innerHTML = '';
            staff.forEach(member => {
                const option = document.createElement('option');
                option.value = member.id;
                option.textContent = `${member.name} (${member.role === 'doctor' ? '醫師' : '護理師'})`;
                select.appendChild(option);
            });

            // 更新固定排班人員選擇下拉選單
            const fixedSelect = document.getElementById('fixedStaffSelect');
            if (fixedSelect) {
                fixedSelect.innerHTML = '';
                staff.forEach(member => {
                    const option = document.createElement('option');
                    option.value = member.id;
                    option.textContent = `${member.name} (${member.role === 'doctor' ? '醫師' : '護理師'}) - ${member.department}`;
                    fixedSelect.appendChild(option);
                });
            }
        }

        // 模態框操作
        function openShiftModal(date = null, staffId = null) {
            // 僅允許管理員開啟新增或編輯排班視窗
            if (!ensureAdmin('新增或編輯排班')) {
                return;
            }
            const modal = document.getElementById('shiftModal');
            const form = document.getElementById('shiftForm');

            // 重置表單
            form.reset();

            // 設定預設值
            if (date) {
                document.getElementById('shiftDate').value = date;
            } else {
                document.getElementById('shiftDate').value = currentDate.toISOString().split('T')[0];
            }

            if (staffId) {
                document.getElementById('staffSelect').value = staffId;
            }

            // 設定預設時間
            document.getElementById('startTime').value = '08:00';
            document.getElementById('endTime').value = '16:00';
            // 清空備註欄位（若存在）
            if (document.getElementById('shiftNotes')) {
                document.getElementById('shiftNotes').value = '';
            }
            modal.classList.add('show');
        }

        function closeModal() {
            document.getElementById('shiftModal').classList.remove('show');
        }

        // 新增排班
        function addShift() {
            // 僅允許管理員新增或編輯排班
            if (!ensureAdmin('新增或編輯排班')) {
                return;
            }
            const form = document.getElementById('shiftForm');
            const modal = document.getElementById('shiftModal');
            const editId = modal.dataset.editId;

            // 驗證必填欄位
            const staffId = document.getElementById('staffSelect').value;
            const date = document.getElementById('shiftDate').value;
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            const type = document.getElementById('shiftType').value;

            if (!staffId || !date || !startTime || !endTime || !type) {
                alert('請填寫所有必填欄位！');
                return;
            }

            const shiftData = {
                staffId: parseInt(staffId),
                date: date,
                startTime: startTime,
                endTime: endTime,
                type: type,
                status: 'confirmed',
                notes: document.getElementById('shiftNotes') ? document.getElementById('shiftNotes').value : ''
            };

            if (editId) {
                // 編輯模式
                const shiftIndex = shifts.findIndex(s => s.id == editId);
                if (shiftIndex !== -1) {
                    shifts[shiftIndex] = { ...shifts[shiftIndex], ...shiftData };
                    showNotification('排班更新成功！');
                }
                delete modal.dataset.editId;
                modal.querySelector('h3').textContent = '新增排班';
            } else {
                // 新增模式
                const newShift = {
                    id: Date.now(),
                    ...shiftData
                };
                shifts.push(newShift);
                showNotification('排班新增成功！');
            }

            // 重置表單並關閉視窗
            form.reset();
            modal.classList.remove('show');

            // 更新顯示
            renderCalendar();
            updateStats();
        }

        // 已移除同步至 Google Calendar 功能，原有程式碼已刪除

        // 匯出 iCal
        function exportToICal() {
            let icalContent = [
                'BEGIN:VCALENDAR',
                'VERSION:2.0',
                'PRODID:-//醫療排班系統//排班行事曆//ZH',
                'CALSCALE:GREGORIAN'
            ];

            shifts.forEach(shift => {
                const staffMember = getStaffMemberById(shift.staffId);
                // 計算跨日與 24:00 結束的班次
                let endDateStr = shift.date;
                let endTimeStr = shift.endTime;
                const startMinutes = parseTimeToMinutes(shift.startTime);
                let endMinutes = parseTimeToMinutes(shift.endTime);
                if (endMinutes <= startMinutes || endMinutes >= 24 * 60) {
                    const dateObj = new Date(shift.date);
                    dateObj.setDate(dateObj.getDate() + 1);
                    endDateStr = dateObj.toISOString().split('T')[0];
                    if (endMinutes >= 24 * 60) {
                        endTimeStr = '00:00';
                    }
                }
                const startDateTime = `${shift.date.replace(/-/g, '')}T${shift.startTime.replace(':', '')}00`;
                const endDateTime = `${endDateStr.replace(/-/g, '')}T${endTimeStr.replace(':', '')}00`;
                // 組合描述，僅包含班別與備註
                let descriptionLines = [];
                descriptionLines.push(`班別: ${shift.type}`);
                if (shift.notes) {
                    descriptionLines.push(`備註: ${shift.notes}`);
                }
                const descriptionString = descriptionLines.join('\\n');
                icalContent.push(
                    'BEGIN:VEVENT',
                    `UID:${shift.id}@medical-schedule.com`,
                    `DTSTART:${startDateTime}`,
                    `DTEND:${endDateTime}`,
                    `SUMMARY:${staffMember.name} - ${staffMember.role === 'doctor' ? '醫師' : '護理師'}排班`,
                    `DESCRIPTION:${descriptionString}`,
                    `LOCATION:醫院`,
                    'END:VEVENT'
                );
            });

            icalContent.push('END:VCALENDAR');

            // 創建下載連結
            const blob = new Blob([icalContent.join('\r\n')], { type: 'text/calendar;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = '醫療排班行事曆.ics';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);

            showNotification('iCal 檔案已下載！');
        }

        // 新增功能函數

        // 回到今天
        function goToToday() {
            currentDate = new Date();
            updateCurrentDate();
            renderCalendar();
            updateStats();
        }

        // 應用篩選
        function applyFilters() {
            // The department filter has been removed from the UI.  Always use a
            // blank string so that all departments are shown and avoid querying
            // a non‑existent DOM element.
            currentFilters.department = '';

            // Retrieve the remaining filters.  These inputs still exist.
            currentFilters.role = document.getElementById('roleFilter').value;
            currentFilters.shiftType = document.getElementById('shiftTypeFilter').value;
            currentFilters.staffSearch = document.getElementById('staffSearch').value.toLowerCase();

            renderCalendar();
            updateStats();
        }

        // 檢查排班是否符合篩選條件
        function passesFilter(shift) {
            const staffMember = getStaffMemberById(shift.staffId);

            // Department filtering has been disabled.  Do not restrict by department.
            if (currentFilters.role && staffMember.role !== currentFilters.role) return false;
            if (currentFilters.shiftType && shift.type !== currentFilters.shiftType) return false;
            if (currentFilters.staffSearch && !staffMember.name.toLowerCase().includes(currentFilters.staffSearch)) return false;

            return true;
        }

        // 更新統計資訊
        function updateStats() {
            // 統計功能已移除，保留函數以避免錯誤
        }



        // 檢查衝突
        function checkConflicts() {
            const conflicts = checkAllConflicts();

            if (conflicts.length === 0) {
                showNotification('沒有發現排班衝突！');
                return;
            }

            let message = `發現 ${conflicts.length} 個排班衝突：\n\n`;
            conflicts.forEach((conflict, index) => {
                const staff1 = getStaffMemberById(conflict.shift1.staffId);
                const staff2 = getStaffMemberById(conflict.shift2.staffId);
                message += `${index + 1}. ${staff1.name} 在 ${conflict.shift1.date} 有重疊排班\n`;
            });

            alert(message);
        }

        // 檢查所有衝突
        function checkAllConflicts() {
            const conflicts = [];
            for (let i = 0; i < shifts.length; i++) {
                for (let j = i + 1; j < shifts.length; j++) {
                    const shift1 = shifts[i];
                    const shift2 = shifts[j];
                    if (shift1.staffId === shift2.staffId && shift1.date === shift2.date) {
                        let start1 = parseTimeToMinutes(shift1.startTime);
                        let end1 = parseTimeToMinutes(shift1.endTime);
                        let start2 = parseTimeToMinutes(shift2.startTime);
                        let end2 = parseTimeToMinutes(shift2.endTime);
                        // 處理跨日情況：若結束時間小於或等於開始時間，補加 24 小時
                        if (end1 <= start1) end1 += 24 * 60;
                        if (end2 <= start2) end2 += 24 * 60;
                        // 判定是否重疊
                        if (start1 < end2 && start2 < end1) {
                            conflicts.push({ shift1, shift2 });
                        }
                    }
                }
            }
            return conflicts;
        }

        // 清空所有排班
        function clearAllShifts() {
            // 僅允許管理員清空排班
            if (!ensureAdmin('清空所有排班')) {
                return;
            }
            if (confirm('確定要清空所有排班嗎？此操作無法復原。')) {
                shifts = [];
                renderCalendar();
                updateStats();
                showNotification('所有排班已清空！');
            }
        }

        // 編輯排班
        function editShift(shiftId) {
            // 僅允許管理員編輯排班
            if (!ensureAdmin('編輯排班')) {
                return;
            }
            const shift = shifts.find(s => s.id === shiftId);
            if (!shift) return;

            // 填入現有資料到表單
            document.getElementById('staffSelect').value = shift.staffId;
            document.getElementById('shiftDate').value = shift.date;
            document.getElementById('startTime').value = shift.startTime;
            document.getElementById('endTime').value = shift.endTime;
            document.getElementById('shiftType').value = shift.type;

            // 標記為編輯模式
            const modal = document.getElementById('shiftModal');
            modal.dataset.editId = shiftId;
            modal.querySelector('h3').textContent = '編輯排班';
            modal.classList.add('show');
        }

        // 刪除排班
        function deleteShift(shiftId) {

            // 僅允許管理員刪除排班
            if (!ensureAdmin('刪除排班')) {
                return;
            }

            // 事件傳播在 handleDeleteShift 中處理，此函式僅執行刪除邏輯

            // 獲取排班資訊用於確認對話框
            const shift = shifts.find(s => s.id == shiftId);
            if (!shift) {
                showNotification('找不到要刪除的排班！');
                return;
            }

            const staffMember = getStaffMemberById(shift.staffId);
            const confirmMessage = `確定要刪除以下排班嗎？\n\n` +
                                 `人員：${staffMember.name}\n` +
                                 `日期：${shift.date}\n` +
                                 `時間：${shift.startTime} - ${shift.endTime}\n` +
                                 `備註：${shift.notes || '無'}\n\n` +
                                 `此操作無法復原！`;

            if (confirm(confirmMessage)) {
                const shiftIndex = shifts.findIndex(s => s.id == shiftId);
                if (shiftIndex !== -1) {
                    shifts.splice(shiftIndex, 1);
                    renderCalendar();
                    updateStats();
                    showNotification('排班已刪除！');
                } else {
                    showNotification('刪除失敗：找不到排班資料！');
                }
            }
        }

        // 顯示排班詳情
        function showShiftDetails(shift) {
            const staffMember = getStaffMemberById(shift.staffId);
            const duration = calculateShiftDuration(shift.startTime, shift.endTime);

            // 顯示排班詳情，移除部門與狀態資訊以簡化顯示
            alert(`排班詳情：
姓名：${staffMember.name}
職位：${staffMember.level}
日期：${shift.date}
時間：${shift.startTime} - ${shift.endTime} (${duration} 小時)
備註：${shift.notes || '無'}
聯絡電話：${staffMember.phone}
電子郵件：${staffMember.email}`);
        }

        // 根據ID顯示排班詳情
        function showShiftDetailsById(shiftId) {
            const shift = shifts.find(s => s.id === shiftId);
            if (shift) {
                showShiftDetails(shift);
            }
        }

        // 列印排班表功能已移除，以下函式不再使用
    </script>
    <!-- 新排班管理區結束 -->
</div>

<!-- 自訂工具提示容器 -->
    <!-- 調整 z-index 並新增行內樣式，以確保 tooltip 在模態框或其他高層元素之上顯示 -->
    <div id="tooltip" class="hidden pointer-events-none fixed bg-gray-800 text-white text-xs px-3 py-1 rounded-lg shadow-lg z-50 whitespace-pre-line" style="z-index: 9999;"></div>
    <!-- 載入 Chart.js 用於繪製個人統計分析圖表 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="schedule_management.js"></script><script src="system.js"></script>
    <!-- 系統管理相關腳本拆分至獨立檔案 -->
    <script src="systemmanagement.js"></script>
    <!-- 新增聊天模組腳本，需在 system.js 之後載入 -->
    <script src="chat_module.js"></script>
    <!-- 語言國際化腳本，必須在系統腳本之後載入 -->
    <script src="i18n.js"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"96f142c32d05b42b","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.8.0","token":"b2074e7888b746fe9fbbc15492b4c3d4"}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"97172fa8b875b31b","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.8.0","token":"b2074e7888b746fe9fbbc15492b4c3d4"}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"b2074e7888b746fe9fbbc15492b4c3d4","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"b2074e7888b746fe9fbbc15492b4c3d4","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
