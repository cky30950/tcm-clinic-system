<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‰∏≠ÈÜ´Ë®∫ÊâÄÁ≥ªÁµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDK -->

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* ÊµÆÂãïÊèêÁ§∫Ê®£Âºè */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            min-width: 300px;
            max-width: 500px;
            padding: 16px 20px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transform: translateX(100%);
            transition: all 0.3s ease-in-out;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .toast.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        .toast.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .toast.info {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }
        
        .toast-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .toast-content {
            flex: 1;
            line-height: 1.4;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-50 to-blue-50 min-h-screen">
    <!-- ÁôªÂÖ•È†ÅÈù¢ -->
    <div id="loginPage" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <div class="text-4xl mb-4">üè•</div>
                <h1 id="loginTitle" class="text-2xl font-bold text-gray-800 mb-2">‰∏≠ÈÜ´Ë®∫ÊâÄÁ≥ªÁµ±</h1>
                <p id="loginEnglishTitle" class="text-sm text-gray-500 mb-3">TCM Clinic</p>
                <p class="text-gray-600">Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÈõªÂ≠êÈÉµ‰ª∂ÂèäÂØÜÁ¢ºÁôªÂÖ•</p>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ÈõªÂ≠êÈÉµ‰ª∂</label>
                    <input type="email" id="mainLoginUsername" placeholder="Ë´ãËº∏ÂÖ•ÈõªÂ≠êÈÉµ‰ª∂" 
                           class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           onkeypress="if(event.key==='Enter') document.getElementById('mainLoginPassword').focus()">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ÂØÜÁ¢º</label>
                    <input type="password" id="mainLoginPassword" placeholder="Ë´ãËº∏ÂÖ•ÂØÜÁ¢º" 
                           class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           onkeypress="if(event.key==='Enter') attemptMainLogin()">
                </div>
                
                <button onclick="attemptMainLogin()" 
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">
                    ÁôªÂÖ•Á≥ªÁµ±
                </button>
                
                <!-- Á§∫ÁØÑÂ∏≥ËôüÊèêÁ§∫ÂçÄÂ∑≤ÁßªÈô§ÔºåÁ≥ªÁµ±‰ΩøÁî®ËÄÖË´ã‰ΩøÁî®ÊÇ®ÁöÑÈõªÂ≠êÈÉµ‰ª∂ÁôªÂÖ• -->
            </div>
        </div>
    </div>

    <!-- ‰∏ªÁ≥ªÁµ±È†ÅÈù¢ -->
    <div id="mainSystem" class="hidden fade-in">
        <!-- ÂÅ¥ÈÇäÈÅ∏ÂñÆ -->
        <div id="sidebar" class="fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-2xl transform -translate-x-full transition-transform duration-300 ease-in-out">
            <div class="flex flex-col h-full">
                <!-- ÈÅ∏ÂñÆÊ®ôÈ°å -->
                <div class="bg-green-600 text-white p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="text-2xl mr-3">üè•</span>
                            <h2 class="text-lg font-bold">Ë®∫ÊâÄÂäüËÉΩ</h2>
                        </div>
                        <button onclick="toggleSidebar()" class="text-white hover:text-gray-200 text-xl">
                            √ó
                        </button>
                    </div>
                    <div id="sidebarUserRole" class="text-sm text-green-100 mt-2"></div>
                </div>

                <!-- ÂäüËÉΩÈÅ∏ÂñÆÈ†ÖÁõÆ -->
                <div class="flex-1 py-4">
                    <div id="sidebarMenu" class="space-y-2 px-4">
                        <!-- ÈÅ∏ÂñÆÈ†ÖÁõÆÊúÉÂãïÊÖãÁîüÊàê -->
                    </div>
                </div>

                <!-- Â∫ïÈÉ®Êìç‰Ωú -->
                <div class="border-t border-gray-200 p-4">
                    <button onclick="logout()" class="w-full bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg text-sm transition duration-200 flex items-center justify-center">
                        <span class="mr-2">üö™</span>
                        ÁôªÂá∫Á≥ªÁµ±
                    </button>
                </div>
            </div>
        </div>

        <!-- ÈÅÆÁΩ©Â±§ -->
        <div id="sidebarOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden" onclick="toggleSidebar()"></div>

        <!-- È†ÇÈÉ®Â∞éËà™ -->
        <nav class="bg-white shadow-lg border-b-4 border-green-500">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <button onclick="toggleSidebar()" class="mr-4 p-2 rounded-lg hover:bg-gray-100 transition duration-200">
                            <div class="w-6 h-6 flex flex-col justify-center space-y-1">
                                <div class="w-full h-0.5 bg-gray-600"></div>
                                <div class="w-full h-0.5 bg-gray-600"></div>
                                <div class="w-full h-0.5 bg-gray-600"></div>
                            </div>
                        </button>
                        <span class="text-2xl mr-3">üè•</span>
                        <div>
                            <h1 id="systemTitle" class="text-xl font-bold text-gray-800">‰∏≠ÈÜ´Ë®∫ÊâÄÁ≥ªÁµ±</h1>
                            <p id="systemEnglishTitle" class="text-xs text-gray-500">TCM Clinic</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span id="userRole" class="text-sm text-gray-600"></span>
                        <button onclick="logout()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm transition duration-200">
                            ÁôªÂá∫
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- ‰∏ªË¶ÅÂÖßÂÆπÂçÄÂüü -->
        <div class="max-w-7xl mx-auto px-4 py-6">
            <!-- Ê≠°ËøéÈ†ÅÈù¢ -->
            <div id="welcomePage" class="text-center py-16">
                <div class="text-6xl mb-6">üè•</div>
                <h2 id="welcomeTitle" class="text-3xl font-bold text-gray-800 mb-2">Ê≠°Ëøé‰ΩøÁî®‰∏≠ÈÜ´Ë®∫ÊâÄÁ≥ªÁµ±</h2>
                <p id="welcomeEnglishTitle" class="text-lg text-gray-500 mb-4">Welcome to TCM Clinic</p>
                <p class="text-gray-600 text-lg mb-8">Ë´ãÈªûÊìäÂ∑¶‰∏äËßíÈÅ∏ÂñÆÊåâÈàïÈñãÂßã‰ΩøÁî®Á≥ªÁµ±ÂäüËÉΩ</p>
                <div class="bg-white rounded-xl shadow-lg p-8 max-w-4xl mx-auto">
                    <h3 class="text-xl font-semibold mb-4">Á≥ªÁµ±ÂäüËÉΩÊ¶ÇË¶Ω</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm">
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="text-2xl mb-2">üë•</div>
                            <div class="font-semibold">ÁóÖ‰∫∫Ë≥áÊñôÁÆ°ÁêÜ</div>
                            <div class="text-gray-600 mt-1">Êñ∞Â¢û„ÄÅÊü•Áúã„ÄÅÁÆ°ÁêÜÁóÖ‰∫∫Ë≥áÊñô</div>
                        </div>
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="text-2xl mb-2">ü©∫</div>
                            <div class="font-semibold">Ë®∫ÁóáÁ≥ªÁµ±</div>
                            <div class="text-gray-600 mt-1">Ë®òÈåÑÁóáÁãÄ„ÄÅË®∫Êñ∑„ÄÅÈñãÁ´ãËôïÊñπ</div>
                        </div>
                        <div class="text-center p-4 bg-purple-50 rounded-lg">
                            <div class="text-2xl mb-2">üë§</div>
                            <div class="font-semibold">Áî®Êà∂ÁÆ°ÁêÜ</div>
                            <div class="text-gray-600 mt-1">ÁÆ°ÁêÜË®∫ÊâÄÁî®Êà∂Ê¨äÈôê</div>
                        </div>
                        <div class="text-center p-4 bg-red-50 rounded-lg">
                            <div class="text-2xl mb-2">‚öôÔ∏è</div>
                            <div class="font-semibold">Á≥ªÁµ±ÁÆ°ÁêÜ</div>
                            <div class="text-gray-600 mt-1">Áµ±Ë®àË≥áÊñô„ÄÅÂÇô‰ªΩÂåØÂá∫</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ÁóÖ‰∫∫Ë≥áÊñôÁÆ°ÁêÜ -->
            <div id="patientManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">ÁóÖ‰∫∫Ë≥áÊñôÁÆ°ÁêÜ</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchPatient" placeholder="ÊêúÂ∞ãÁóÖ‰∫∫Á∑®Ëôü„ÄÅÂßìÂêçÊàñÈõªË©±..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">üîç</span>
                        </div>
                        <button onclick="showAddPatientForm()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + Êñ∞Â¢ûÁóÖ‰∫∫
                        </button>
                    </div>
                </div>

                <!-- Êñ∞Â¢û/Á∑®ËºØÁóÖ‰∫∫Ë°®ÂñÆÂΩàÁ™ó -->
                <div id="addPatientModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="formTitle" class="text-xl font-bold text-gray-800">Êñ∞Â¢ûÁóÖ‰∫∫Ë≥áÊñô</h3>
                            <button onclick="hideAddPatientForm()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ÂßìÂêç *</label>
                                    <input type="text" id="patientName" placeholder="Ë´ãËº∏ÂÖ•ÂßìÂêç" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Âπ¥ÈΩ°</label>
                                    <input type="number" id="patientAge" placeholder="Á≥ªÁµ±Ëá™ÂãïË®àÁÆó" min="0" max="120" readonly class="w-full border border-gray-300 rounded-lg px-4 py-2 bg-gray-100 text-gray-600">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ÊÄßÂà• *</label>
                                    <select id="patientGender" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                        <option value="">Ë´ãÈÅ∏ÊìáÊÄßÂà•</option>
                                        <option value="Áî∑">Áî∑</option>
                                        <option value="Â•≥">Â•≥</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ÈõªË©±ËôüÁ¢º *</label>
                                    <input type="tel" id="patientPhone" placeholder="‰æãÔºö0912-345-678" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <!-- Â∞áË∫´ÂàÜË≠âÂ≠óËôüË®≠ÁÇ∫ÂøÖÂ°´Ôºå‰∏¶ÁßªÈô§Âõ∫ÂÆöÈï∑Â∫¶ÈôêÂà∂ -->
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Ë∫´ÂàÜË≠âÂ≠óËôü *</label>
                                    <input type="text" id="patientIdCard" placeholder="‰æãÔºöA123456789" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Âá∫ÁîüÊó•Êúü *</label>
                                    <input type="date" id="patientBirthDate" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" onchange="updatePatientAge()">
                                </div>
                                <div class="md:col-span-2 lg:col-span-3">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ËÅØÁµ°Âú∞ÂùÄ</label>
                                    <textarea id="patientAddress" placeholder="Ë´ãËº∏ÂÖ•ÂÆåÊï¥Âú∞ÂùÄ" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div class="md:col-span-2 lg:col-span-3">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ÈÅéÊïèÂè≤</label>
                                    <textarea id="patientAllergies" placeholder="Ë´ãË©≥Á¥∞Ë®òÈåÑËó•Áâ©ÈÅéÊïèÊàñÈ£üÁâ©ÈÅéÊïèÂè≤" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div class="md:col-span-2 lg:col-span-3">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ÁóÖÂè≤ÂèäÂÇôË®ª</label>
                                    <textarea id="patientHistory" placeholder="Ë´ãË®òÈåÑÈáçË¶ÅÁóÖÂè≤„ÄÅÂÆ∂ÊóèÁóÖÂè≤„ÄÅÊÖ¢ÊÄßÁñæÁóÖÁ≠â" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddPatientForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    ÂèñÊ∂à
                                </button>
                                <button onclick="savePatient()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="saveButtonText">ÂÑ≤Â≠ò</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÁóÖ‰∫∫ÂàóË°® -->
                <div class="overflow-x-auto">
                    <table class="w-full table-auto">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Á∑®Ëôü</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÂßìÂêç</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Âπ¥ÈΩ°</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÊÄßÂà•</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÈõªË©±</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Êìç‰Ωú</th>
                            </tr>
                        </thead>
                        <tbody id="patientList" class="divide-y divide-gray-200">
                            <!-- ÁóÖ‰∫∫Ë≥áÊñôÊúÉÂãïÊÖãËºâÂÖ• -->
                        </tbody>
                    </table>
                </div>

                <!-- ÁóÖ‰∫∫Ë©≥Á¥∞Ë≥áÊñôÂΩàÁ™ó -->
                <div id="patientDetailModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                            <h3 class="text-xl font-bold text-gray-800">ÁóÖ‰∫∫Ë©≥Á¥∞Ë≥áÊñô</h3>
                            <button onclick="closePatientDetail()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
                        </div>
                        <div id="patientDetailContent" class="p-6">
                            <!-- Ë©≥Á¥∞ÂÖßÂÆπÊúÉÂãïÊÖãËºâÂÖ• -->
                        </div>
                    </div>
                </div>

                <!-- ÁóÖ‰∫∫ÁóÖÊ≠∑Êü•ÁúãÂΩàÁ™ó -->
                <div id="patientMedicalHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="patientMedicalHistoryTitle" class="text-xl font-bold text-gray-800">ÁóÖÊ≠∑Ë®òÈåÑ</h3>
                            <button onclick="closePatientMedicalHistoryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
                        </div>
                        
                        <div class="p-6">
                            <!-- ÁóÖ‰∫∫Âü∫Êú¨Ë≥áË®ä -->
                            <div id="patientMedicalHistoryPatientInfo" class="bg-blue-50 rounded-lg p-4 mb-6">
                                <!-- ÁóÖ‰∫∫Ë≥áË®äÊúÉÂãïÊÖãËºâÂÖ• -->
                            </div>
                            
                            <!-- Ë®∫ÁóáË®òÈåÑÂàóË°® -->
                            <div id="patientMedicalHistoryContent">
                                <!-- Ë®∫ÁóáË®òÈåÑÊúÉÂãïÊÖãËºâÂÖ• -->
                            </div>
                        </div>
                    </div>
                </div>




            </div>

            <!-- Ë®∫ÁóáÁ≥ªÁµ± -->
            <div id="consultationSystem" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">ÊéõËôüË®∫ÁóáÁ≥ªÁµ±</h2>
                    <p class="text-gray-600 mt-2">Á∞°ÊΩîÁöÑÊéõËôüÊµÅÁ®ãÁÆ°ÁêÜ</p>
                </div>
                
                <!-- ÁóÖ‰∫∫ÊêúÁ¥¢ÊéõËôü -->
                <div class="bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-6 mb-6">
                    <div class="mb-4">
                        <h3 class="text-lg font-semibold text-gray-800 flex items-center mb-2">
                            <span class="mr-2">üîç</span>ÊêúÁ¥¢ÁóÖ‰∫∫ÊéõËôü
                        </h3>
                        <p class="text-sm text-gray-600">Ë´ãËº∏ÂÖ•ÁóÖ‰∫∫ÂßìÂêç„ÄÅÁ∑®ËôüÊàñÈõªË©±ÈÄ≤Ë°åÊêúÁ¥¢</p>
                    </div>
                    
                    <div class="flex gap-3">
                        <div class="flex-1 relative">
                            <input type="text" id="patientSearchInput" placeholder="ÊêúÂ∞ãÁóÖ‰∫∫ÂßìÂêç„ÄÅÁ∑®ËôüÊàñÈõªË©±..." 
                                   class="w-full border border-gray-300 rounded-lg px-4 py-3 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   oninput="searchPatientsForRegistration()">
                            <span class="absolute right-3 top-3.5 text-gray-400">üîç</span>
                        </div>
                        <button onclick="clearPatientSearch()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-3 rounded-lg transition duration-200">
                            Ê∏ÖÈô§
                        </button>
                    </div>
                    
                    <!-- ÊêúÁ¥¢ÁµêÊûú -->
                    <div id="patientSearchResults" class="mt-4 hidden">
                        <div class="bg-white rounded-lg border border-gray-200 max-h-64 overflow-y-auto">
                            <div id="searchResultsList" class="divide-y divide-gray-200">
                                <!-- ÊêúÁ¥¢ÁµêÊûúÊúÉÂãïÊÖãËºâÂÖ• -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÊéõËôüÂΩàÁ™ó -->
                <div id="registrationModal" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
                        <div class="bg-green-600 text-white px-6 py-4 rounded-t-xl">
                            <div class="flex justify-between items-center">
                                <h3 class="text-xl font-bold">ÁóÖ‰∫∫ÊéõËôü</h3>
                                <button onclick="closeRegistrationModal()" class="text-white hover:text-gray-200 text-2xl">√ó</button>
                            </div>
                        </div>
                        
                        <div class="p-6 space-y-4">
                            <!-- ÈÅ∏‰∏≠ÁöÑÁóÖ‰∫∫Ë≥áË®ä -->
                            <div class="bg-blue-50 rounded-lg p-4">
                                <div class="flex items-center mb-2">
                                    <span class="mr-2">üë§</span>
                                    <span class="font-semibold text-gray-700">ÁóÖ‰∫∫Ë≥áË®ä</span>
                                </div>
                                <div id="selectedPatientInfo" class="text-sm text-gray-600">
                                    <!-- ÁóÖ‰∫∫Ë≥áË®äÊúÉÂãïÊÖãËºâÂÖ• -->
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">üë®‚Äç‚öïÔ∏è</span>ÊéõËôüÈÜ´Â∏´ *
                                </label>
                                <select id="appointmentDoctor" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option value="">Ë´ãÈÅ∏ÊìáÈÜ´Â∏´</option>
                                    <!-- ÈÜ´Â∏´ÈÅ∏È†ÖÊúÉÂãïÊÖãËºâÂÖ• -->
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">‚è∞</span>ÊéõËôüÊôÇÈñì
                                </label>
                                <input type="datetime-local" id="appointmentDateTime" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">üìù</span>‰∏ªË®¥ÁóáÁãÄ
                                </label>
                                <textarea id="quickChiefComplaint" placeholder="Ë´ãÁ∞°Ëø∞ÁóÖ‰∫∫ÁöÑ‰∏ªË¶ÅÁóáÁãÄ..." rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                            </div>
                            
                            <div class="flex space-x-3 pt-4">
                                <button onclick="closeRegistrationModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg transition duration-200">
                                    ÂèñÊ∂à
                                </button>
                                <button onclick="confirmRegistration()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition duration-200">
                                    Á¢∫Ë™çÊéõËôü
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ‰ªäÊó•ÊéõËôüÂàóË°® -->
                <div class="bg-white border border-gray-200 rounded-lg">
                    <div class="bg-gray-50 px-6 py-4 border-b border-gray-200 rounded-t-lg">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                                <span class="mr-2">üìÖ</span>‰ªäÊó•ÊéõËôüÂàóË°®
                            </h3>
                            <div class="text-sm text-gray-600 flex items-center space-x-3">
                                <!-- Êñ∞Â¢ûÊõ¥Êñ∞ÊéõËôüÂàóË°®ÊåâÈàïÔºöÂëºÂè´ loadTodayAppointments ÈáçÊñ∞ËºâÂÖ•Áï∂Êó•ÊéõËôüË≥áÊñô -->
                                <!-- Êõ¥Êñ∞ÊéõËôüÂàóË°®ÊåâÈàïË®≠Ë®àÁ∞°ÊΩî„ÄÅ‰ª•ÁôΩËâ≤ÁÇ∫‰∏ª -->
                                <!-- Â∞áÊõ¥Êñ∞ÊéõËôüÂàóË°®ÊåâÈàïÂ∞∫ÂØ∏Ë™øÊï¥ÁÇ∫ËºÉÂ∞èÔºöÊ∏õÂ∞ëÂÖßË∑ù„ÄÅÈôç‰ΩéÂúìËßí„ÄÅ‰ΩøÁî®ËºÉÂ∞èÊñáÂ≠ó -->
                                <span>
                                    Á∏ΩË®àÔºö<span id="todayTotal" class="font-semibold text-blue-600">0</span> ‰∫∫
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Â∫èËôü</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÁóÖ‰∫∫ÂßìÂêç</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÊéõËôüÈÜ´Â∏´</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÊéõËôüÊôÇÈñì</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‰∏ªË®¥ÁóáÁãÄ</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÁãÄÊÖã</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Êìç‰Ωú</th>
                                    </tr>
                                </thead>
                                <tbody id="todayAppointmentsList" class="divide-y divide-gray-200">
                                    <!-- ÊéõËôüÂàóË°®ÊúÉÂãïÊÖãËºâÂÖ• -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>



                <!-- Ë®∫ÁóáË®òÈåÑÊü•ÁúãÂΩàÁ™ó -->
                <div id="medicalHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="medicalHistoryTitle" class="text-xl font-bold text-gray-800">Ë®∫ÁóáË®òÈåÑ</h3>
                            <button onclick="closeMedicalHistoryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
                        </div>
                        
                        <div class="p-6">
                            <!-- ÁóÖ‰∫∫Âü∫Êú¨Ë≥áË®ä -->
                            <div id="medicalHistoryPatientInfo" class="bg-blue-50 rounded-lg p-4 mb-6">
                                <!-- ÁóÖ‰∫∫Ë≥áË®äÊúÉÂãïÊÖãËºâÂÖ• -->
                            </div>
                            
                            <!-- Ë®∫ÁóáË®òÈåÑÂàóË°® -->
                            <div id="medicalHistoryContent">
                                <!-- Ë®∫ÁóáË®òÈåÑÊúÉÂãïÊÖãËºâÂÖ• -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ë®∫ÁóáË°®ÂñÆÂçÄÂüü -->
                <div id="consultationForm" class="hidden bg-white border border-gray-200 rounded-lg mt-6">
                    <div class="bg-green-600 text-white px-6 py-4 rounded-t-lg">
                        <h3 class="text-xl font-bold">Ë®∫ÁóáË®òÈåÑ</h3>
                    </div>
                    
                    <div class="p-6">
                        <!-- ÁóÖ‰∫∫Ë≥áË®ä -->
                        <div class="bg-blue-50 rounded-lg p-4 mb-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <span class="font-medium">ÁóÖ‰∫∫Ôºö</span>
                                    <span id="formPatientName" class="text-blue-600 font-semibold"></span>
                                </div>
                                <div>
                                    <span class="font-medium">ÊéõËôüÊôÇÈñìÔºö</span>
                                    <span id="formAppointmentTime"></span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ë®∫ÁóáË°®ÂñÆ -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Â∑¶ÂÅ¥ -->
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        ‰∏ªË®¥ *
                                    </label>
                                    <textarea id="formSymptoms" placeholder="ÁóÖ‰∫∫‰∏ªË¶Å‰∏çÈÅ©ÁóáÁãÄ„ÄÅÁôºÁóÖÊôÇÈñì„ÄÅÁóáÁãÄÁâπÈªûÁ≠â..." rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        ËàåË±°
                                    </label>
                                    <textarea id="formTongue" placeholder="ËàåË≥™„ÄÅËàåËãî„ÄÅËàåÂΩ¢Á≠â..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        ËÑàË±°
                                    </label>
                                    <textarea id="formPulse" placeholder="ËÑà‰Ωç„ÄÅËÑàÁéá„ÄÅËÑàÂäõ„ÄÅËÑàÂΩ¢Á≠â..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        ÁèæÁóÖÂè≤
                                    </label>
                                    <textarea id="formCurrentHistory" placeholder="ÁôºÁóÖÁ∂ìÈÅé„ÄÅÁóáÁãÄËÆäÂåñ„ÄÅÊ≤ªÁôÇÁ∂ìÈÅéÁ≠â..." rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        ‰∏≠ÈÜ´Ë®∫Êñ∑ *
                                    </label>
                                    <textarea id="formDiagnosis" placeholder="‰∏≠ÈÜ´ÁóÖÂêçË®∫Êñ∑..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        Ë≠âÂûãË®∫Êñ∑
                                    </label>
                                    <textarea id="formSyndrome" placeholder="Ëæ®Ë≠âÂàÜÂûã„ÄÅÁóÖÊ©üÂàÜÊûê..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        ÈáùÁÅ∏ÂÇôË®ª
                                    </label>
                                    <textarea id="formAcupunctureNotes" placeholder="ÈáùÁÅ∏Á©¥‰Ωç„ÄÅÊâãÊ≥ï„ÄÅÊ≥®ÊÑè‰∫ãÈ†ÖÁ≠â..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                            </div>
                            
                            <!-- Âè≥ÂÅ¥ -->
                            <div class="space-y-4">
                                
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">
                                            ËôïÊñπÂÖßÂÆπ
                                        </label>
                                        <button type="button" onclick="loadPreviousPrescription()" 
                                                class="text-xs bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded transition duration-200">
                                            üìã ËºâÂÖ•‰∏äÊ¨°ËôïÊñπ
                                        </button>
                                    </div>
                                    
                                    <!-- ‰∏≠Ëó•Â∫´ÊêúÁ¥¢ÂçÄÂüü -->
                                    <div class="mb-3 bg-yellow-50 rounded-lg p-3 border border-yellow-200">
                                        <div class="flex items-center mb-2">
                                            <span class="text-sm font-medium text-yellow-800 mr-2">üîç ÊêúÁ¥¢‰∏≠Ëó•Â∫´Ôºö</span>
                                            <div class="flex-1 relative">
                                                <input type="text" id="prescriptionSearch" placeholder="ÊêúÁ¥¢‰∏≠Ëó•ÊùêÊàñÊñπÂäëÂêçÁ®±..." 
                                                       class="w-full border border-yellow-300 rounded px-3 py-1 text-sm focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                                                       oninput="searchHerbsForPrescription()">
                                                <button onclick="clearPrescriptionSearch()" class="absolute right-2 top-1 text-gray-400 hover:text-gray-600 text-sm">√ó</button>
                                            </div>
                                        </div>
                                        
                                        <!-- ÊêúÁ¥¢ÁµêÊûú -->
                                        <div id="prescriptionSearchResults" class="hidden">
                                            <div class="bg-white rounded border border-yellow-200 max-h-48 overflow-y-auto">
                                                <div id="prescriptionSearchList" class="grid grid-cols-1 md:grid-cols-2 gap-2 p-2">
                                                    <!-- ÊêúÁ¥¢ÁµêÊûúÊúÉÂãïÊÖãËºâÂÖ• -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Â∑≤ÈÅ∏ÊìáÁöÑËôïÊñπÂÖßÂÆπ -->
                                    <div class="border border-gray-300 rounded-lg p-3 min-h-[120px] bg-gray-50">
                                        <div id="selectedPrescriptionItems" class="space-y-2">
                                            <div class="text-sm text-gray-500 text-center py-4">
                                                Ë´ã‰ΩøÁî®‰∏äÊñπÊêúÁ¥¢ÂäüËÉΩÊ∑ªÂä†‰∏≠Ëó•ÊùêÊàñÊñπÂäë
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- ÊúçËó•Â§©Êï∏ÂèäÊ¨°Êï∏Ë®≠ÂÆöÔºàÂè™Âú®ÊúâËôïÊñπÂÖßÂÆπÊôÇÈ°ØÁ§∫Ôºâ -->
                                    <div id="medicationSettings" class="mt-3 bg-yellow-50 rounded-lg p-3 border border-yellow-200" style="display: none;">
                                        <div class="space-y-3">
                                            <!-- ÊúçËó•Â§©Êï∏ -->
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium text-yellow-800">ÊúçËó•Â§©Êï∏</span>
                                                <div class="flex items-center space-x-2">
                                                    <button onclick="updateMedicationDays(-1)" class="w-7 h-7 bg-yellow-500 text-white rounded-full text-sm hover:bg-yellow-600 transition duration-200">-</button>
                                                    <input type="number" id="medicationDays" value="5" min="1" max="30" 
                                                           class="w-14 px-2 py-1 text-center border border-yellow-300 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-sm"
                                                           onchange="updateMedicationDaysFromInput()" onclick="this.select()">
                                                    <button onclick="updateMedicationDays(1)" class="w-7 h-7 bg-yellow-500 text-white rounded-full text-sm hover:bg-yellow-600 transition duration-200">+</button>
                                                    <span class="text-sm text-yellow-800">Â§©</span>
                                                </div>
                                            </div>
                                            
                                            <!-- ÊúçËó•Ê¨°Êï∏ -->
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium text-yellow-800">ÊØèÊó•Ê¨°Êï∏</span>
                                                <div class="flex items-center space-x-2">
                                                    <button onclick="updateMedicationFrequency(-1)" class="w-7 h-7 bg-yellow-500 text-white rounded-full text-sm hover:bg-yellow-600 transition duration-200">-</button>
                                                    <input type="number" id="medicationFrequency" value="2" min="1" max="6" 
                                                           class="w-14 px-2 py-1 text-center border border-yellow-300 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-sm"
                                                           onchange="updateMedicationFrequency(0)" onclick="this.select()">
                                                    <button onclick="updateMedicationFrequency(1)" class="w-7 h-7 bg-yellow-500 text-white rounded-full text-sm hover:bg-yellow-600 transition duration-200">+</button>
                                                    <span class="text-sm text-yellow-800">Ê¨°/Êó•</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Èö±ËóèÁöÑÊñáÊú¨ÂüüÁî®ÊñºÂ≠òÂÑ≤ËôïÊñπÂÖßÂÆπ -->
                                    <textarea id="formPrescription" class="hidden"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        ÊúçÁî®ÊñπÊ≥ï
                                    </label>
                                    <textarea id="formUsage" placeholder="ÁÖéÁÖÆÊñπÊ≥ï„ÄÅÊúçÁî®ÊôÇÈñì„ÄÅÂäëÈáèÁ≠â..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">
                                            Êî∂Ë≤ªÈ†ÖÁõÆ
                                        </label>
                                        <button type="button" onclick="loadPreviousBillingItems()" 
                                                class="text-xs bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded transition duration-200">
                                            üí∞ ËºâÂÖ•‰∏äÊ¨°Êî∂Ë≤ª
                                        </button>
                                    </div>
                                    
                                    <!-- Êî∂Ë≤ªÈ†ÖÁõÆÊêúÁ¥¢ÂçÄÂüü -->
                                    <div class="mb-3 bg-green-50 rounded-lg p-3 border border-green-200">
                                        <div class="flex items-center mb-2">
                                            <span class="text-sm font-medium text-green-800 mr-2">üí∞ ÈÅ∏ÊìáÊî∂Ë≤ªÈ†ÖÁõÆÔºö</span>
                                            <div class="flex-1 relative">
                                                <input type="text" id="billingSearch" placeholder="ÊêúÁ¥¢Êî∂Ë≤ªÈ†ÖÁõÆÂêçÁ®±..." 
                                                       class="w-full border border-green-300 rounded px-3 py-1 text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                                       oninput="searchBillingForConsultation()">
                                                <button onclick="clearBillingSearch()" class="absolute right-2 top-1 text-gray-400 hover:text-gray-600 text-sm">√ó</button>
                                            </div>
                                        </div>
                                        
                                        <!-- ÊêúÁ¥¢ÁµêÊûú -->
                                        <div id="billingSearchResults" class="hidden">
                                            <div class="bg-white rounded border border-green-200 max-h-48 overflow-y-auto">
                                                <div id="billingSearchList" class="grid grid-cols-1 md:grid-cols-2 gap-2 p-2">
                                                    <!-- ÊêúÁ¥¢ÁµêÊûúÊúÉÂãïÊÖãËºâÂÖ• -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Â∑≤ÈÅ∏ÊìáÁöÑÊî∂Ë≤ªÈ†ÖÁõÆ -->
                                    <div class="border border-gray-300 rounded-lg p-3 min-h-[80px] bg-gray-50">
                                        <div id="selectedBillingItems" class="space-y-2">
                                            <div class="text-sm text-gray-500 text-center py-4">
                                                Ë´ã‰ΩøÁî®‰∏äÊñπÊêúÁ¥¢ÂäüËÉΩÊ∑ªÂä†Êî∂Ë≤ªÈ†ÖÁõÆ
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Á∏ΩË≤ªÁî®È°ØÁ§∫ -->
                                    <div class="mt-2 text-right">
                                        <span class="text-sm font-medium text-gray-700">Á∏ΩË≤ªÁî®Ôºö</span>
                                        <span id="totalBillingAmount" class="text-lg font-bold text-green-600">$0</span>
                                    </div>
                                    
                                    <!-- Èö±ËóèÁöÑÊñáÊú¨ÂüüÁî®ÊñºÂ≠òÂÑ≤Êî∂Ë≤ªÈ†ÖÁõÆ -->
                                    <textarea id="formBillingItems" class="hidden"></textarea>

                                    <!-- ÁóÖ‰∫∫Â•óÁ•®ÁÆ°ÁêÜ -->
                                    <div class="mt-4 border border-purple-200 rounded-lg p-3 bg-purple-50">
                                      <div class="flex items-center justify-between mb-2">
                                        <div class="text-sm font-semibold text-purple-800">üé´ ÁóÖ‰∫∫Â•óÁ•®</div>
                                        <button type="button" onclick="refreshPatientPackagesUI()"
                                                class="text-xs px-2 py-1 bg-purple-600 text-white rounded">Âà∑Êñ∞</button>
                                      </div>
                                      <div id="patientPackagesList" class="space-y-2 text-sm text-gray-700">
                                        <!-- ÂãïÊÖãËºâÂÖ• -->
                                        <div class="text-gray-500">Â∞öÊú™ËºâÂÖ•ÊàñÁÑ°Â•óÁ•®</div>
                                      </div>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        ÁôÇÁ®ã
                                    </label>
                                    <input type="text" id="formTreatmentCourse" placeholder="‰æãÔºö7Â§©„ÄÅ2ÈÄ±„ÄÅ1ÂÄãÊúàÁ≠â..." class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        ÈÜ´ÂõëÂèäÊ≥®ÊÑè‰∫ãÈ†Ö
                                    </label>
                                    <textarea id="formInstructions" placeholder="È£≤È£üÂÆúÂøå„ÄÅÁîüÊ¥ªË™øË≠∑„ÄÅÊ≥®ÊÑè‰∫ãÈ†ÖÁ≠â..." rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ë§áË®∫ÊôÇÈñìÂèäÂÖ∂‰ªñÊôÇÈñìË®≠ÂÆö -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        Ë§áË®∫ÊôÇÈñì
                                    </label>
                                    <input type="datetime-local" id="formFollowUpDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">Âª∫Ë≠∞ÁóÖ‰∫∫‰∏ãÊ¨°ÂõûË®∫ÁöÑÊôÇÈñì</p>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        Âà∞Ë®∫ÊôÇÈñì
                                    </label>
                                    <input type="datetime-local" id="formVisitTime" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">ÂØ¶ÈöõÂà∞Ë®∫ÁöÑÊôÇÈñìÔºàÁî®ÊñºË≠âÊòéÊõ∏Ôºâ</p>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        Âª∫Ë≠∞‰ºëÊÅØÊúüÈñì
                                    </label>
                                    <div class="space-y-2">
                                        <div class="flex items-center space-x-2">
                                            <label class="text-xs text-gray-600 w-12">ÈñãÂßãÔºö</label>
                                            <input type="date" id="formRestStartDate" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" onchange="updateRestPeriod()">
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <label class="text-xs text-gray-600 w-12">ÁµêÊùüÔºö</label>
                                            <input type="date" id="formRestEndDate" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" onchange="updateRestPeriod()">
                                        </div>
                                        <div class="text-center">
                                            <span id="restPeriodDisplay" class="text-sm text-gray-500 font-medium">Ë´ãÈÅ∏ÊìáÈñãÂßãÂíåÁµêÊùüÊó•Êúü</span>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">Áî®ÊñºÁóÖÂÅáË≠âÊòéÊõ∏ÁöÑÂª∫Ë≠∞‰ºëÊÅØÊúüÈñì</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Êìç‰ΩúÊåâÈàï -->
                        <div class="flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200">
                            <button onclick="cancelConsultation()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                ÂèñÊ∂àË®∫Áóá
                            </button>
                            <button onclick="saveConsultation()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                <span id="consultationSaveButtonText">‰øùÂ≠òÁóÖÊ≠∑</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ‰∏≠Ëó•Â∫´ÁÆ°ÁêÜ -->
            <div id="herbLibrary" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">‰∏≠Ëó•Â∫´ÁÆ°ÁêÜ</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchHerb" placeholder="ÊêúÂ∞ã‰∏≠Ëó•ÊùêÊàñÊñπÂäëÂêçÁ®±..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">üîç</span>
                        </div>
                        <button onclick="showAddHerbForm()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + Êñ∞Â¢û‰∏≠Ëó•Êùê
                        </button>
                        <button onclick="showAddFormulaForm()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + Êñ∞Â¢ûÊñπÂäë
                        </button>
                    </div>
                </div>

                <!-- ÂàÜÈ°ûÊ®ôÁ±§ -->
                <div class="mb-6">
                    <div class="flex flex-wrap gap-2">
                        <button onclick="filterHerbLibrary('all')" id="filter-all" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-800 transition duration-200">
                            ÂÖ®ÈÉ®
                        </button>
                        <button onclick="filterHerbLibrary('herb')" id="filter-herb" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            ‰∏≠Ëó•Êùê
                        </button>
                        <button onclick="filterHerbLibrary('formula')" id="filter-formula" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            ÊñπÂäë
                        </button>
                    </div>
                </div>

                <!-- Êñ∞Â¢û/Á∑®ËºØ‰∏≠Ëó•ÊùêË°®ÂñÆÂΩàÁ™ó -->
                <div id="addHerbModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="herbFormTitle" class="text-xl font-bold text-gray-800">Êñ∞Â¢û‰∏≠Ëó•Êùê</h3>
                            <button onclick="hideAddHerbForm()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">‰∏≠Ëó•ÊùêÂêçÁ®± *</label>
                                    <input type="text" id="herbName" placeholder="Ë´ãËº∏ÂÖ•‰∏≠Ëó•ÊùêÂêçÁ®±" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Âà•Âêç</label>
                                    <input type="text" id="herbAlias" placeholder="ÂÖ∂‰ªñÂêçÁ®±ÊàñÂà•Âêç" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ÊÄßÂë≥</label>
                                    <input type="text" id="herbNature" placeholder="‰æãÔºöÁîò„ÄÅÂæÆËã¶ÔºåÊ∫´" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Ê≠∏Á∂ì</label>
                                    <input type="text" id="herbMeridian" placeholder="‰æãÔºöËÇ∫„ÄÅËÑæ„ÄÅËÖéÁ∂ì" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ÂäüÊïà</label>
                                    <textarea id="herbEffects" placeholder="Ë´ãÊèèËø∞‰∏ªË¶ÅÂäüÊïà" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">‰∏ªÊ≤ª</label>
                                    <textarea id="herbIndications" placeholder="Ë´ãÊèèËø∞‰∏ªË¶ÅÊ≤ªÁôÇÁØÑÂúç" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Â∏∏Áî®ÂäëÈáè</label>
                                    <input type="text" id="herbDosage" placeholder="‰æãÔºö3-9g" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">‰ΩøÁî®Ê≥®ÊÑè</label>
                                    <input type="text" id="herbCautions" placeholder="Á¶ÅÂøåÊàñÊ≥®ÊÑè‰∫ãÈ†Ö" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddHerbForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    ÂèñÊ∂à
                                </button>
                                <button onclick="saveHerb()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="herbSaveButtonText">ÂÑ≤Â≠ò</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Êñ∞Â¢û/Á∑®ËºØÊñπÂäëË°®ÂñÆÂΩàÁ™ó -->
                <div id="addFormulaModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="formulaFormTitle" class="text-xl font-bold text-gray-800">Êñ∞Â¢ûÊñπÂäë</h3>
                            <button onclick="hideAddFormulaForm()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">ÊñπÂäëÂêçÁ®± *</label>
                                        <input type="text" id="formulaName" placeholder="Ë´ãËº∏ÂÖ•ÊñπÂäëÂêçÁ®±" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Âá∫Ëôï</label>
                                        <input type="text" id="formulaSource" placeholder="‰æãÔºöÂÇ∑ÂØíË´ñ„ÄÅÈáëÂå±Ë¶ÅÁï•" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">ÂäüÊïà</label>
                                        <textarea id="formulaEffects" placeholder="Ë´ãÊèèËø∞ÊñπÂäë‰∏ªË¶ÅÂäüÊïà" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">‰∏ªÊ≤ª</label>
                                        <textarea id="formulaIndications" placeholder="Ë´ãÊèèËø∞‰∏ªË¶ÅÊ≤ªÁôÇÁóÖÁóá" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                </div>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">ÁµÑÊàê *</label>
                                        <textarea id="formulaComposition" placeholder="Ë´ãËº∏ÂÖ•ÊñπÂäëÁµÑÊàêÔºå‰æãÂ¶ÇÔºö&#10;‰∫∫ÂèÉ&#10;ÁôΩÊúÆ&#10;ËåØËãì&#10;ÁîòËçâ" rows="8" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Áî®Ê≥ï</label>
                                        <textarea id="formulaUsage" placeholder="ÁÖéÁÖÆÊñπÊ≥ï„ÄÅÊúçÁî®ÊñπÂºèÁ≠â" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Ê≥®ÊÑè‰∫ãÈ†Ö</label>
                                        <textarea id="formulaCautions" placeholder="Á¶ÅÂøå„ÄÅÊ≥®ÊÑè‰∫ãÈ†ÖÁ≠â" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddFormulaForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    ÂèñÊ∂à
                                </button>
                                <button onclick="saveFormula()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="formulaSaveButtonText">ÂÑ≤Â≠ò</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ‰∏≠Ëó•Â∫´ÂàóË°® -->
                <div class="overflow-x-auto">
                    <div id="herbLibraryList" class="space-y-4">
                        <!-- ‰∏≠Ëó•Â∫´ÂÖßÂÆπÊúÉÂãïÊÖãËºâÂÖ• -->
                    </div>
                </div>
            </div>

            <!-- Êî∂Ë≤ªÈ†ÖÁõÆÁÆ°ÁêÜ -->
            <div id="billingManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">Êî∂Ë≤ªÈ†ÖÁõÆÁÆ°ÁêÜ</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchBilling" placeholder="ÊêúÂ∞ãÊî∂Ë≤ªÈ†ÖÁõÆÂêçÁ®±..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">üîç</span>
                        </div>
                        <button onclick="showAddBillingItemForm()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + Êñ∞Â¢ûÊî∂Ë≤ªÈ†ÖÁõÆ
                        </button>
                    </div>
                </div>

                <!-- ÂàÜÈ°ûÊ®ôÁ±§ -->
                <div class="mb-6">
                    <div class="flex flex-wrap gap-2">
                        <button onclick="filterBillingItems('all')" id="billing-filter-all" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-800 transition duration-200">
                            ÂÖ®ÈÉ®
                        </button>
                        <button onclick="filterBillingItems('consultation')" id="billing-filter-consultation" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            Ë®∫ÁôÇË≤ª
                        </button>
                        <button onclick="filterBillingItems('medicine')" id="billing-filter-medicine" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            Ëó•Ë≤ª
                        </button>
                        <button onclick="filterBillingItems('treatment')" id="billing-filter-treatment" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            Ê≤ªÁôÇË≤ª
                        </button>
                        <button onclick="filterBillingItems('other')" id="billing-filter-other" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            ÂÖ∂‰ªñ
                        </button>
                        <button onclick="filterBillingItems('discount')" id="billing-filter-discount" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            ÊäòÊâ£È†ÖÁõÆ
                        </button>
                        <button onclick="filterBillingItems('package')" id="billing-filter-package" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            Â•óÁ•®È†ÖÁõÆ
                        </button>
                    </div>
                </div>

                <!-- Êñ∞Â¢û/Á∑®ËºØÊî∂Ë≤ªÈ†ÖÁõÆË°®ÂñÆÂΩàÁ™ó -->
                <div id="addBillingItemModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="billingItemFormTitle" class="text-xl font-bold text-gray-800">Êñ∞Â¢ûÊî∂Ë≤ªÈ†ÖÁõÆ</h3>
                            <button onclick="hideAddBillingItemForm()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">È†ÖÁõÆÂêçÁ®± *</label>
                                    <input type="text" id="billingItemName" placeholder="Ë´ãËº∏ÂÖ•Êî∂Ë≤ªÈ†ÖÁõÆÂêçÁ®±" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">È†ÖÁõÆÈ°ûÂà• *</label>
                                    <select id="billingItemCategory" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                        <option value="">Ë´ãÈÅ∏ÊìáÈ°ûÂà•</option>
                                        <option value="consultation">Ë®∫ÁôÇË≤ª</option>
                                        <option value="medicine">Ëó•Ë≤ª</option>
                                        <option value="treatment">Ê≤ªÁôÇË≤ª</option>
                                        <option value="other">ÂÖ∂‰ªñ</option>
                                        <option value="discount">ÊäòÊâ£È†ÖÁõÆ</option>
                                        <option value="package">Â•óÁ•®È†ÖÁõÆ</option>
                                    </select>
                                </div>
                                <!-- Â•óÁ•®Â∞àÁî®Ê¨Ñ‰ΩçÔºöÁï∂È°ûÂà•ÈÅ∏Êìá package ÊôÇÈ°ØÁ§∫ -->
                                <div id="packageFields" class="md:col-span-2 hidden">
                                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                      <label class="block text-sm font-medium text-gray-700 mb-1">Â•óÁ•®ÂèØÁî®Ê¨°Êï∏ *</label>
                                      <input type="number" id="billingItemPackageUses" placeholder="‰æãÂ¶ÇÔºö10" min="1"
                                             class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    </div>
                                    <div>
                                      <label class="block text-sm font-medium text-gray-700 mb-1">ÊúâÊïàÂ§©Êï∏ *</label>
                                      <input type="number" id="billingItemValidityDays" placeholder="‰æãÂ¶ÇÔºö180ÔºàÂçäÂπ¥Ôºâ" min="1"
                                             class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                      <p class="text-xs text-gray-500 mt-1">Ëá™Ë≥ºË≤∑Êó•Ëµ∑ÁÆó</p>
                                    </div>
                                  </div>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Êî∂Ë≤ªÈáëÈ°ç *</label>
                                    <input type="number" id="billingItemPrice" placeholder="0" step="1" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">ÊäòÊâ£È†ÖÁõÆÔºöËº∏ÂÖ•0.9Ë°®Á§∫9ÊäòÔºåËº∏ÂÖ•9ÊúÉËá™ÂãïËΩâÁÇ∫9ÊäòÔºåÊàñËº∏ÂÖ•Ë≤†Êï∏Ë°®Á§∫Âõ∫ÂÆöÈáëÈ°çÊäòÊâ£</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Ë®àË≤ªÂñÆ‰Ωç</label>
                                    <input type="text" id="billingItemUnit" placeholder="‰æãÔºöÊ¨°„ÄÅÂäë„ÄÅÂåÖ" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">È†ÖÁõÆË™™Êòé</label>
                                    <textarea id="billingItemDescription" placeholder="Ë´ãÊèèËø∞Êî∂Ë≤ªÈ†ÖÁõÆÁöÑË©≥Á¥∞ÂÖßÂÆπ" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="billingItemActive" checked class="mr-2 rounded">
                                        <span class="text-sm font-medium text-gray-700">ÂïüÁî®Ê≠§Êî∂Ë≤ªÈ†ÖÁõÆ</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddBillingItemForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    ÂèñÊ∂à
                                </button>
                                <button onclick="saveBillingItem()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="billingItemSaveButtonText">ÂÑ≤Â≠ò</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Êî∂Ë≤ªÈ†ÖÁõÆÂàóË°® -->
                <div class="overflow-x-auto">
                    <div id="billingItemsList" class="space-y-4">
                        <!-- Êî∂Ë≤ªÈ†ÖÁõÆÂÖßÂÆπÊúÉÂãïÊÖãËºâÂÖ• -->
                    </div>
                </div>
            </div>

            <!-- Ë®∫ÊâÄÁî®Êà∂ÁÆ°ÁêÜ -->
            <div id="userManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">Ë®∫ÊâÄÁî®Êà∂ÁÆ°ÁêÜ</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchUser" placeholder="ÊêúÂ∞ãÁî®Êà∂ÂêçÁ®±ÊàñÈõªÂ≠êÈÉµ‰ª∂..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">üîç</span>
                        </div>
                        <button onclick="showAddUserForm()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + Êñ∞Â¢ûÁî®Êà∂
                        </button>
                    </div>
                </div>

                <!-- ÁãÄÊÖãÁØ©ÈÅ∏Ê®ôÁ±§ -->
                <div class="mb-6">
                    <div class="flex flex-wrap gap-2">
                        <button onclick="filterUsers('all')" id="user-filter-all" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-800 transition duration-200">
                            ÂÖ®ÈÉ®Áî®Êà∂
                        </button>
                        <button onclick="filterUsers('inactive')" id="user-filter-inactive" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            Â∑≤ÂÅúÁî®
                        </button>
                    </div>
                </div>

                <!-- Êñ∞Â¢û/Á∑®ËºØÁî®Êà∂Ë°®ÂñÆÂΩàÁ™ó -->
                <div id="addUserModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="userFormTitle" class="text-xl font-bold text-gray-800">Êñ∞Â¢ûÁî®Êà∂</h3>
                            <button onclick="hideAddUserForm()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <!-- Â∏≥ËôüËàáÂØÜÁ¢ºÊ¨Ñ‰ΩçÂ∑≤ÁßªÈô§ÔºåÁ≥ªÁµ±Â∞áËá™Âãï‰ΩøÁî® Firebase UID ÊàñÈõªÂ≠êÈÉµ‰ª∂Áî¢ÁîüË≠òÂà•ÂêçÁ®± -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ÂßìÂêç *</label>
                                    <input type="text" id="userDisplayName" placeholder="Ë´ãËº∏ÂÖ•ÁúüÂØ¶ÂßìÂêç" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ËÅ∑‰Ωç *</label>
                                    <select id="userPosition" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" onchange="toggleRegistrationNumberField()">
                                        <option value="">Ë´ãÈÅ∏ÊìáËÅ∑‰Ωç</option>
                                        <option value="Ë®∫ÊâÄÁÆ°ÁêÜ">Ë®∫ÊâÄÁÆ°ÁêÜ</option>
                                        <option value="ÈÜ´Â∏´">ÈÜ´Â∏´</option>
                                        <option value="Ë≠∑ÁêÜÂ∏´">Ë≠∑ÁêÜÂ∏´</option>
                                    </select>
                                </div>
                                <div id="registrationNumberField" class="hidden">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">‰∏≠ÈÜ´Ë®ªÂÜäÁ∑®Ëôü *</label>
                                    <input type="text" id="userRegistrationNumber" placeholder="Ë´ãËº∏ÂÖ•‰∏≠ÈÜ´Ë®ªÂÜäÁ∑®Ëôü" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">ÈÜ´Â∏´ËÅ∑‰ΩçÂøÖÈ†àÂ°´ÂØ´Ë®ªÂÜäÁ∑®Ëôü</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ÈõªÂ≠êÈÉµ‰ª∂</label>
                                    <input type="email" id="userEmail" placeholder="Ë´ãËº∏ÂÖ•ÈõªÂ≠êÈÉµ‰ª∂" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">ÈõªË©±ËôüÁ¢º</label>
                                    <input type="tel" id="userPhone" placeholder="Ë´ãËº∏ÂÖ•ÈõªË©±ËôüÁ¢º" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <!-- Firebase UID Ê¨Ñ‰Ωç -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Firebase UID</label>
                                    <input type="text" id="userUID" placeholder="Ë´ãËº∏ÂÖ• Firebase UIDÔºàÂèØ‰∏çÂ°´Ôºâ" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">Â∞çÊáâ Firebase Authentication Â∏≥ËôüÁöÑ UID</p>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="userActive" checked class="mr-2 rounded">
                                        <span class="text-sm font-medium text-gray-700">ÂïüÁî®Ê≠§Áî®Êà∂Â∏≥Ëôü</span>
                                    </label>
                                    <p class="text-xs text-gray-500 mt-1">ÂÅúÁî®ÁöÑÂ∏≥ËôüÂ∞áÁÑ°Ê≥ïÁôªÂÖ•Á≥ªÁµ±</p>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddUserForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    ÂèñÊ∂à
                                </button>
                                <button onclick="saveUser()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="userSaveButtonText">ÂÑ≤Â≠ò</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Áî®Êà∂ÂàóË°® -->
                <div class="overflow-x-auto">
                    <table class="w-full table-auto">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÂßìÂêç</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ËÅ∑‰Ωç</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Ë®ªÂÜäÁ∑®Ëôü</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÈõªÂ≠êÈÉµ‰ª∂</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÁãÄÊÖã</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÊúÄÂæåÁôªÂÖ•</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Êìç‰Ωú</th>
                            </tr>
                        </thead>
                        <tbody id="userList" class="divide-y divide-gray-200">
                            <!-- Áî®Êà∂Ë≥áÊñôÊúÉÂãïÊÖãËºâÂÖ• -->
                        </tbody>
                    </table>
                </div>
            </div>

<!-- Ë≤°ÂãôÂ†±Ë°® -->
            <div id="financialReports" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2 flex items-center">
                        <span class="mr-3">üìä</span>Ë≤°ÂãôÂ†±Ë°®
                    </h2>
                    <p class="text-gray-600">Ë®∫ÊâÄÊî∂ÂÖ•ÂàÜÊûêËàáË≤°ÂãôÁµ±Ë®à</p>
                </div>

                <!-- ÁØ©ÈÅ∏ÊéßÂà∂ÂçÄ -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Â†±Ë°®È°ûÂûã</label>
                            <select id="reportType" onchange="generateFinancialReport()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="daily">Êó•Â†±Ë°®</option>
                                <option value="weekly">ÈÄ±Â†±Ë°®</option>
                                <option value="monthly" selected>ÊúàÂ†±Ë°®</option>
                                <option value="yearly">Âπ¥Â†±Ë°®</option>
                                <option value="custom">Ëá™Ë®ÇÊúüÈñì</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Âø´ÈÄüÈÅ∏Êìá</label>
                            <select id="quickDate" onchange="setQuickDate()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">Ë´ãÈÅ∏Êìá...</option>
                                <option value="today">‰ªäÂ§©</option>
                                <option value="yesterday">Êò®Â§©</option>
                                <option value="thisWeek">Êú¨ÈÄ±</option>
                                <option value="lastWeek">‰∏äÈÄ±</option>
                                <option value="thisMonth">Êú¨Êúà</option>
                                <option value="lastMonth">‰∏äÊúà</option>
                                <option value="thisYear">‰ªäÂπ¥</option>
                                <option value="lastYear">ÂéªÂπ¥</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ÈñãÂßãÊó•Êúü</label>
                            <input type="date" id="startDate" onchange="generateFinancialReport()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ÁµêÊùüÊó•Êúü</label>
                            <input type="date" id="endDate" onchange="generateFinancialReport()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ÈÜ´Â∏´ÁØ©ÈÅ∏</label>
                            <select id="doctorFilter" onchange="generateFinancialReport()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">ÂÖ®ÈÉ®ÈÜ´Â∏´</option>
                            </select>
                        </div>
                        
                        <div class="flex items-end space-x-2">
                            <button onclick="generateFinancialReport()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200 flex items-center">
                                <span class="mr-2">üîÑ</span>Êõ¥Êñ∞Â†±Ë°®
                            </button>
                            <button onclick="exportFinancialReport()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200 flex items-center">
                                <span class="mr-2">üì•</span>ÂåØÂá∫
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ÈóúÈçµÊåáÊ®ôÂç°Áâá -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gradient-to-r from-green-400 to-green-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100 text-sm font-medium">Á∏ΩÊî∂ÂÖ•</p>
                                <h3 id="totalRevenue" class="text-3xl font-bold">$0</h3>
                                <p id="revenueChange" class="text-green-100 text-sm mt-1">Áµ±Ë®àÊúüÈñìÊî∂ÂÖ•</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">üí∞</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-blue-400 to-blue-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100 text-sm font-medium">Ë®∫Áóá‰∫∫Ê¨°</p>
                                <h3 id="totalConsultations" class="text-3xl font-bold">0</h3>
                                <p id="consultationChange" class="text-blue-100 text-sm mt-1">ÂÆåÊàêË®∫ÁóáÊ¨°Êï∏</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">üë•</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-purple-400 to-purple-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm font-medium">Âπ≥ÂùáÊ∂àË≤ª</p>
                                <h3 id="averageRevenue" class="text-3xl font-bold">$0</h3>
                                <p id="averageChange" class="text-purple-100 text-sm mt-1">ÊØèÊ¨°Ë®∫ÁóáÂπ≥Âùá</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">üìä</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-orange-400 to-orange-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-orange-100 text-sm font-medium">Ê¥ªË∫çÈÜ´Â∏´</p>
                                <h3 id="activeDoctors" class="text-3xl font-bold">0</h3>
                                <p id="doctorChange" class="text-orange-100 text-sm mt-1">ÊúâË®∫ÁóáÁöÑÈÜ´Â∏´</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">üë®‚Äç‚öïÔ∏è</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ë©≥Á¥∞Â†±Ë°® -->
                <div class="bg-white border border-gray-200 rounded-lg">
                    <div class="bg-gray-50 px-6 py-4 border-b border-gray-200 rounded-t-lg">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                                <span class="mr-2">üìã</span>Ë©≥Á¥∞Ë≤°ÂãôÂ†±Ë°®
                            </h3>
                            <div class="text-sm text-gray-600">
                                Ë≥áÊñôÊõ¥Êñ∞ÊôÇÈñìÔºö<span id="lastUpdateTime">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ê®ôÁ±§È†Å -->
                    <div class="border-b border-gray-200">
                        <nav class="flex space-x-8 px-6" role="tablist">
                            <button onclick="switchFinancialTab('summary')" id="financialSummaryTab" class="py-4 px-1 border-b-2 border-green-500 text-green-600 font-medium text-sm transition duration-200">
                                Êî∂ÂÖ•ÊëòË¶Å
                            </button>
                            <button onclick="switchFinancialTab('daily')" id="financialDailyTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm transition duration-200">
                                ÊØèÊó•ÊòéÁ¥∞
                            </button>
                            <button onclick="switchFinancialTab('doctor')" id="financialDoctorTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm transition duration-200">
                                ÈÜ´Â∏´Ê•≠Á∏æ
                            </button>
                            <button onclick="switchFinancialTab('service')" id="financialServiceTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm transition duration-200">
                                ÊúçÂãôÂàÜÊûê
                            </button>
                        </nav>
                    </div>
                    
                    <!-- Ê®ôÁ±§ÂÖßÂÆπ -->
                    <div class="p-6">
                        <!-- Êî∂ÂÖ•ÊëòË¶ÅÊ®ôÁ±§ -->
                        <div id="financialSummaryContent" class="financial-tab-content">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">È†ÖÁõÆ</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">ÈáëÈ°ç</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">‰ΩîÊØî</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">ÂÇôË®ª</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialSummaryTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="4" class="px-4 py-8 text-center text-gray-500">
                                                Ë´ãÈªûÊìä„ÄåÊõ¥Êñ∞Â†±Ë°®„Äç‰æÜËºâÂÖ•Ë≥áÊñô
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- ÊØèÊó•ÊòéÁ¥∞Ê®ôÁ±§ -->
                        <div id="financialDailyContent" class="financial-tab-content hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Êó•Êúü</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Ë®∫Áóá‰∫∫Ê¨°</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Êî∂ÂÖ•ÈáëÈ°ç</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Âπ≥ÂùáÊ∂àË≤ª</th>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">‰∏ªË¶ÅÊúçÂãô</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialDailyTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                                Ë´ãÈªûÊìä„ÄåÊõ¥Êñ∞Â†±Ë°®„Äç‰æÜËºâÂÖ•Ë≥áÊñô
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- ÈÜ´Â∏´Ê•≠Á∏æÊ®ôÁ±§ -->
                        <div id="financialDoctorContent" class="financial-tab-content hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÈÜ´Â∏´</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Ë®∫Áóá‰∫∫Ê¨°</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Á∏ΩÊî∂ÂÖ•</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Âπ≥ÂùáÊ∂àË≤ª</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">‰ΩîÊØî</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialDoctorTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                                Ë´ãÈªûÊìä„ÄåÊõ¥Êñ∞Â†±Ë°®„Äç‰æÜËºâÂÖ•Ë≥áÊñô
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- ÊúçÂãôÂàÜÊûêÊ®ôÁ±§ -->
                        <div id="financialServiceContent" class="financial-tab-content hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">ÊúçÂãôÈ°ûÂûã</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Ê¨°Êï∏</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Á∏ΩÈáëÈ°ç</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Âπ≥ÂùáÂñÆÂÉπ</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">Êî∂ÂÖ•‰ΩîÊØî</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialServiceTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                                Ë´ãÈªûÊìä„ÄåÊõ¥Êñ∞Â†±Ë°®„Äç‰æÜËºâÂÖ•Ë≥áÊñô
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Á≥ªÁµ±ÁÆ°ÁêÜ -->
            <div id="systemManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Á≥ªÁµ±ÁÆ°ÁêÜ</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">Ë®∫ÊâÄË®≠ÂÆö</h3>
                        <div class="space-y-3">
                            <div class="text-center py-4" id="clinicSettingsDisplay">
                                <div class="text-sm text-gray-700 mb-3">
                                    <div class="font-medium">Ë®∫ÊâÄ‰∏≠ÊñáÂêçÁ®±Ôºö<span id="displayChineseName">‰∏≠ÈÜ´Ë®∫ÊâÄÁ≥ªÁµ±</span></div>
                                    <div class="text-gray-600 mt-1">Ë®∫ÊâÄËã±ÊñáÂêçÁ®±Ôºö<span id="displayEnglishName">TCM Clinic</span></div>
                                </div>
                                <button onclick="showClinicSettingsModal()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition duration-200">
                                    Ë®∫ÊâÄË≥áÊñô‰øÆÊîπ
                                </button>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>

    <!-- Ë®∫ÊâÄË≥áÊñô‰øÆÊîπÂΩàÁ™ó -->
    <div id="clinicSettingsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                <h3 class="text-xl font-bold text-gray-800">Ë®∫ÊâÄË≥áÊñô‰øÆÊîπ</h3>
                <button onclick="hideClinicSettingsModal()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
            </div>
            
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Ë®∫ÊâÄ‰∏≠ÊñáÂêçÁ®± *</label>
                        <input type="text" id="clinicChineseName" placeholder="Ë´ãËº∏ÂÖ•Ë®∫ÊâÄ‰∏≠ÊñáÂêçÁ®±" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Ë®∫ÊâÄËã±ÊñáÂêçÁ®±</label>
                        <input type="text" id="clinicEnglishName" placeholder="Ë´ãËº∏ÂÖ•Ë®∫ÊâÄËã±ÊñáÂêçÁ®±" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Ë®∫ÊâÄÁáüÊ•≠ÊôÇÈñì</label>
                        <input type="text" id="clinicBusinessHours" placeholder="‰æãÔºöÈÄ±‰∏ÄËá≥ÈÄ±‰∫î 09:00-18:00" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Ë®∫ÊâÄÈõªË©±</label>
                        <input type="tel" id="clinicPhone" placeholder="Ë´ãËº∏ÂÖ•Ë®∫ÊâÄÈõªË©±ËôüÁ¢º" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Ë®∫ÊâÄÂú∞ÂùÄ</label>
                        <textarea id="clinicAddress" placeholder="Ë´ãËº∏ÂÖ•Ë®∫ÊâÄÂÆåÊï¥Âú∞ÂùÄ" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                    <button onclick="hideClinicSettingsModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                        ÂèñÊ∂à
                    </button>
                    <button onclick="saveClinicSettings()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200">
                        ÂÑ≤Â≠ò
                    </button>
                </div>
            </div>
        </div>
    </div>

    
















    <script type="module" src="./src/main.js"></script>
</body>
</html>
