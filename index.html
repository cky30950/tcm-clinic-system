<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>名醫診所系統</title>
    <!-- 新增網站圖標 (favicon) -->
    <link rel="icon" type="image/png" href="images/myLogo.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDK -->
<script type="module" src="firebase_init.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* contenteditable placeholder for針灸備註輸入區 */
        [contenteditable][data-placeholder]:empty:before {
            content: attr(data-placeholder);
            color: #9ca3af; /* text-gray-400 */
        }
        
        /* 浮動提示樣式 */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            min-width: 300px;
            max-width: 500px;
            padding: 16px 20px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transform: translateX(100%);
            transition: all 0.3s ease-in-out;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .toast.error {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        .toast.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .toast.info {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }
        
        .toast-icon {
            font-size: 20px;
            flex-shrink: 0;
        }
        
        .toast-content {
            flex: 1;
            line-height: 1.4;
        }

        /* 讓病歷欄位內容長字串換行避免溢出 */
        .medical-field {
            /* 允許在任意字元斷行，避免內容溢出欄位 */
            word-break: break-all;
            overflow-wrap: break-word;
        }

        /* 調整針灸備註中穴位方塊的字體大小，原本為 text-xs，改為較大的大小 */
        #formAcupunctureNotes span[data-acupoint-name] {
            /* 使用與 Tailwind text-sm 相當的字體大小 (0.875rem) 以提升可讀性 */
            font-size: 0.875rem;
        }

        /*
         * ============================================
         * 手機版排版優化
         *
         * 設置了一些媒體查詢，當螢幕寬度小於 640px（即常見手機螢幕寬度）時，
         * 將會覆寫部分 Tailwind 的固定寬度或最大寬度設定，並允許文字換行，
         * 以避免版面橫向溢出造成需要左右捲動。
         *
         * 這裡覆寫常見的 max-w-* 與 w-* 類別，使其在小螢幕上擴充為 100%，
         * 同時亦將 whitespace-nowrap 改為 normal，使按鈕或標題可自動換行。
         *
         * 另外也調整 toast 提示的寬度與位置，使其在手機上不會超出螢幕範圍。
         */
        @media (max-width: 640px) {
            /* Modal、表單以及最大寬度類別的元素在手機上寬度設為 100% */
            .max-w-md, .max-w-lg, .max-w-xl, .max-w-2xl, .max-w-3xl,
            .max-w-4xl, .max-w-5xl, .max-w-6xl, .max-w-7xl {
                max-width: 100% !important;
                width: 100% !important;
            }

            /* 常用固定寬度類別在手機上設為 100% 寬，避免橫向溢出 */
            .w-64, .w-72, .w-80, .w-96 {
                width: 100% !important;
            }

            /* 允許按鈕等元素內文換行 */
            .whitespace-nowrap {
                white-space: normal !important;
            }

            /* 將具有多欄的 Grid 強制成單欄顯示，減少橫向擁擠 */
            .grid-cols-2, .grid-cols-3, .grid-cols-4, .grid-cols-5, .grid-cols-6 {
                grid-template-columns: repeat(1, minmax(0, 1fr)) !important;
            }

            /* Toast 提示在手機上自適應寬度並靠左右居中 */
            .toast {
                min-width: auto !important;
                max-width: 90% !important;
                right: 5% !important;
                left: 5% !important;
            }

            /*
             * 手機檢視時，診症記錄卡片的日期／醫師資訊與列印按鈕等操作無法全部水平顯示，
             * 容易造成內容被擋住或需要橫向捲動。為了提升使用者體驗，
             * 在寬度小於 640px 時將標題與按鈕群組改為垂直排列，
             * 讓按鈕顯示在日期與醫師資訊的下方。
             * 這裡鎖定診症記錄卡片的標題區塊（使用藍灰漸層背景的容器），
             * 並覆寫 Tailwind 的 flex 排版設定。
             */
            .bg-gradient-to-r.from-gray-50.to-blue-50 > .flex.justify-between.items-center {
                flex-direction: column !important;
                align-items: flex-start !important;
            }

            /* 當按鈕群組換行到下一層時，增加上邊距以區隔日期資訊與按鈕 */
            .bg-gradient-to-r.from-gray-50.to-blue-50 > .flex.justify-between.items-center > .flex.flex-wrap {
                margin-top: 0.5rem !important;
            }

            /*
             * 掛號列表標題在手機上會因為日期選擇器與總計人數區塊佔據寬度而造成橫向溢出。
             * 為了讓內容在窄螢幕上換行顯示，將整個標題容器改為垂直排列，
             * 並將左右兩側的內容堆疊在下一行。另外允許內部項目自動換行，
             * 並調整間距使其上下排列時更為整齊。
             */
            #registrationHeader > .flex {
                flex-direction: column !important;
                align-items: flex-start !important;
            }
            #registrationHeader > .flex > .flex.items-center {
                /* 允許標題中的日期區塊換行，並加入間距 */
                flex-wrap: wrap !important;
                gap: 0.25rem !important;
            }
            #registrationHeader > .flex > .text-sm.text-gray-600 {
                /* 總計人數區塊移到下一行後增加上邊距 */
                margin-top: 0.5rem !important;
            }

            /*
             * 診症記錄與病歷記錄卡片中的日期、醫師、病歷編號等資訊預設為橫向排列，
             * 在手機上容易造成內容被截斷。啟用 flex-wrap 並設置 gap，讓資訊能夠換行顯示。
             */
            .bg-gradient-to-r.from-gray-50.to-blue-50 .flex.items-center.space-x-4 {
                flex-wrap: wrap !important;
                gap: 0.5rem !important;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-50 to-blue-50 min-h-screen">
    <!-- 語言切換器將放置於登入卡片內 -->
    <!-- 登入頁面 -->
    <div id="loginPage" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md relative">
            <!-- 在登入卡片右上角放置語言切換器 -->
            <div class="absolute top-2 right-2">
                <select id="languageSelector" class="border border-gray-300 rounded px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="zh">中文</option>
                    <option value="en">English</option>
                </select>
            </div>
            <div class="text-center mb-8">
                <div class="text-4xl mb-4">
                    <!-- 使用自定義 Logo 圖片取代原有的 Emoji -->
                    <img src="images/myLogo.png" alt="Logo" class="h-20 mx-auto">
                </div>
                <h1 id="loginTitle" class="text-2xl font-bold text-gray-800 mb-2">名醫診所系統</h1>
                <p id="loginEnglishTitle" class="text-sm text-gray-500 mb-3">TCM Clinic</p>
                <p class="text-gray-600">請輸入您的電子郵件及密碼登入</p>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">電子郵件</label>
                    <input type="email" id="mainLoginUsername" placeholder="請輸入電子郵件" 
                           class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           data-login-email>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">密碼</label>
                    <input type="password" id="mainLoginPassword" placeholder="請輸入密碼" 
                           class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                           data-login-password>
                </div>
                
                <button id="loginButton" 
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200">
                    登入系統
                </button>
                
            </div>
            <!-- 登入頁面不再包含版權聲明，由全局頁腳統一呈現 -->
        </div>

    </div>
    <!-- 主系統頁面 -->
    <div id="mainSystem" class="hidden fade-in">
        <!-- 側邊選單 -->
        <div id="sidebar" class="fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-2xl transform -translate-x-full transition-transform duration-300 ease-in-out">
            <div class="flex flex-col h-full">
                <!-- 選單標題 -->
                <div class="bg-green-600 text-white p-6">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="mr-3">
                                <!-- 使用自定義 Logo 圖片取代原有的 Emoji -->
                                <img src="images/myLogo.png" alt="Logo" class="h-6">
                            </span>
                            <h2 class="text-lg font-bold">診所功能</h2>
                        </div>
                        <button id="closeSidebarButton" class="text-white hover:text-gray-200 text-xl">
                            ×
                        </button>
                    </div>
                    <div id="sidebarUserRole" class="text-sm text-green-100 mt-2"></div>
                </div>
                <!-- 功能選單項目 -->
                <div class="flex-1 py-4 overflow-y-auto">
                    <div id="sidebarMenu" class="space-y-2 px-4">
                        <!-- 選單項目會動態生成 -->
                    </div>
                </div>
                <!-- 底部操作 -->
                <div class="border-t border-gray-200 p-4">
                    <button id="sidebarLogoutButton" class="w-full bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg text-sm transition duration-200 flex items-center justify-center">
                        <span class="mr-2">🚪</span>
                        登出系統
                    </button>
                </div>
            </div>
        </div>
        <!-- 遮罩層 -->
        <div id="sidebarOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>
        <!-- 頂部導航 -->
        <nav class="bg-white shadow-lg border-b-4 border-green-500">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <button id="openSidebarButton" class="mr-4 p-2 rounded-lg hover:bg-gray-100 transition duration-200">
                            <div class="w-6 h-6 flex flex-col justify-center space-y-1">
                                <div class="w-full h-0.5 bg-gray-600"></div>
                                <div class="w-full h-0.5 bg-gray-600"></div>
                                <div class="w-full h-0.5 bg-gray-600"></div>
                            </div>
                        </button>
                        <span class="mr-3">
                            <!-- 使用自定義 Logo 圖片取代原有的 Emoji -->
                            <img src="images/myLogo.png" alt="Logo" class="h-6">
                        </span>
                        <div>
                            <h1 id="systemTitle" class="text-xl font-bold text-gray-800">名醫診所系統</h1>
                            <p id="systemEnglishTitle" class="text-xs text-gray-500">TCM Clinic</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span id="userRole" class="text-sm text-gray-600"></span>
                        <button id="logoutButton" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm transition duration-200">
                            登出
                        </button>
                    </div>
                </div>
            </div>
        </nav>
        <!-- 主要內容區域 -->
        <!-- 主要內容包裝區，新增 id 方便在顯示個人設置或模板庫時隱藏整個包裝 -->
        <div id="contentWrapper" class="max-w-7xl mx-auto px-4 py-6">
            <!-- 歡迎頁面 -->
            <div id="welcomePage" class="text-center py-16">
                <div class="text-6xl mb-6">
                    <!-- 使用自定義 Logo 圖片取代原有的 Emoji -->
                    <img src="images/myLogo.png" alt="Logo" class="h-16 mx-auto">
                </div>
                <h2 id="welcomeTitle" class="text-3xl font-bold text-gray-800 mb-2">歡迎使用名醫診所系統</h2>
                <p id="welcomeEnglishTitle" class="text-lg text-gray-500 mb-4">Welcome to TCM Clinic</p>
                <p class="text-gray-600 text-lg mb-8">請點擊左上角選單按鈕開始使用系統功能</p>
                <div class="bg-white rounded-xl shadow-lg p-8 max-w-4xl mx-auto">
                    <h3 class="text-xl font-semibold mb-4">系統功能概覽</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm">
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="text-2xl mb-2">👥</div>
                            <div class="font-semibold">病人資料管理</div>
                            <div class="text-gray-600 mt-1">新增、查看、管理病人資料</div>
                        </div>
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="text-2xl mb-2">🩺</div>
                            <div class="font-semibold">診症系統</div>
                            <div class="text-gray-600 mt-1">記錄症狀、診斷、開立處方</div>
                        </div>
                        <div class="text-center p-4 bg-purple-50 rounded-lg">
                            <!-- 使用多人圖示代表診所用戶管理 -->
                            <div class="text-2xl mb-2">👥</div>
                            <div class="font-semibold">用戶管理</div>
                            <div class="text-gray-600 mt-1">管理診所用戶權限</div>
                        </div>
                        <div class="text-center p-4 bg-red-50 rounded-lg">
                            <div class="text-2xl mb-2">⚙️</div>
                            <div class="font-semibold">系統管理</div>
                            <div class="text-gray-600 mt-1">統計資料、備份匯出</div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 病人資料管理 -->
            <div id="patientManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800"> <span class="text-3xl mr-3">👥</span>病人資料管理</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchPatient" placeholder="搜尋病人編號、姓名或電話..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                        </div>
                        <button id="showAddPatientButton" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + 新增病人
                        </button>
                    </div>
                </div>
                <!-- 新增/編輯病人表單彈窗 -->
                <div id="addPatientModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="formTitle" class="text-xl font-bold text-gray-800">新增病人資料</h3>
                            <button id="hideAddPatientButtonTop" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">姓名 *</label>
                                    <input type="text" id="patientName" placeholder="請輸入姓名" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">年齡</label>
                                    <input type="number" id="patientAge" placeholder="系統自動計算" min="0" max="120" readonly class="w-full border border-gray-300 rounded-lg px-4 py-2 bg-gray-100 text-gray-600">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">性別 *</label>
                                    <select id="patientGender" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                        <option value="">請選擇性別</option>
                                        <option value="男">男</option>
                                        <option value="女">女</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">電話號碼 *</label>
                                    <input type="tel" id="patientPhone" placeholder="例：0912-345-678" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <!-- 將身分證字號設為必填，並移除固定長度限制 -->
                                    <label class="block text-sm font-medium text-gray-700 mb-1">身分證字號 *</label>
                                    <input type="text" id="patientIdCard" placeholder="例：A123456789" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">出生日期 *</label>
                                    <input type="date" id="patientBirthDate" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" onchange="updatePatientAge()">
                                </div>
                                <div class="md:col-span-2 lg:col-span-3">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">聯絡地址</label>
                                    <textarea id="patientAddress" placeholder="請輸入完整地址" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div class="md:col-span-2 lg:col-span-3">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">過敏史</label>
                                    <textarea id="patientAllergies" placeholder="請詳細記錄藥物過敏或食物過敏史" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent break-all"></textarea>
                                </div>
                                <div class="md:col-span-2 lg:col-span-3">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">病史及備註</label>
                                    <textarea id="patientHistory" placeholder="請記錄重要病史、家族病史、慢性疾病等" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent break-all"></textarea>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button id="cancelAddPatientButton" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <button id="savePatientButton" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="saveButtonText">儲存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 病人列表 -->
                <div class="overflow-x-auto">
                    <table class="w-full table-auto">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">編號</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">姓名</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">年齡</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">性別</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">電話</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">操作</th>
                            </tr>
                        </thead>
                        <tbody id="patientList" class="divide-y divide-gray-200">
                            <!-- 病人資料會動態載入 -->
                        </tbody>
                    </table>
                </div>
                <!-- 病人詳細資料彈窗 -->
                <div id="patientDetailModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center">
                            <h3 class="text-xl font-bold text-gray-800">病人詳細資料</h3>
                            <button onclick="closePatientDetail()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        <div id="patientDetailContent" class="p-6">
                            <!-- 詳細內容會動態載入 -->
                        </div>
                    </div>
                </div>
                <!-- 病人病歷查看彈窗 -->
                <div id="patientMedicalHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="patientMedicalHistoryTitle" class="text-xl font-bold text-gray-800">病歷記錄</h3>
                            <button onclick="closePatientMedicalHistoryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <!-- 病人基本資訊 -->
                            <div id="patientMedicalHistoryPatientInfo" class="bg-blue-50 rounded-lg p-4 mb-6">
                                <!-- 病人資訊會動態載入 -->
                            </div>
                            
                            <!-- 診症記錄列表 -->
                            <div id="patientMedicalHistoryContent">
                                <!-- 診症記錄會動態載入 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 診症系統 -->
            <div id="consultationSystem" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800"> <span class="text-3xl mr-3">🩺</span>掛號診症系統</h2>
                    <p class="text-gray-600 mt-2">簡潔的掛號流程管理</p>
                </div>
                
                <!-- 病人搜索掛號 -->
                <div class="bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-6 mb-6">
                    <div class="mb-4">
                        <h3 class="text-lg font-semibold text-gray-800 flex items-center mb-2">
                            <span class="mr-2">🔍</span><span>搜索病人掛號</span>
                        </h3>
                        <p class="text-sm text-gray-600">請輸入病人姓名、編號或電話進行搜索</p>
                    </div>
                    
                    <div class="flex gap-3">
                        <div class="flex-1 relative">
                            <input type="text" id="patientSearchInput" placeholder="搜尋病人姓名、編號或電話..." 
                                   class="w-full border border-gray-300 rounded-lg px-4 py-3 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                   >
                            <span class="absolute right-3 top-3.5 text-gray-400">🔍</span>
                        </div>
                        <button onclick="clearPatientSearch()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-3 rounded-lg transition duration-200">
                            清除
                        </button>
                    </div>
                    
                    <!-- 搜索結果 -->
                    <div id="patientSearchResults" class="mt-4 hidden">
                        <div class="bg-white rounded-lg border border-gray-200 max-h-64 overflow-y-auto">
                            <div id="searchResultsList" class="divide-y divide-gray-200">
                                <!-- 搜索結果會動態載入 -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 掛號彈窗 -->
                <div id="registrationModal" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
                        <div class="bg-green-600 text-white px-6 py-4 rounded-t-xl">
                            <div class="flex justify-between items-center">
                                <h3 class="text-xl font-bold">病人掛號</h3>
                                <button onclick="closeRegistrationModal()" class="text-white hover:text-gray-200 text-2xl">×</button>
                            </div>
                        </div>
                        
                        <div class="p-6 space-y-4">
                            <!-- 選中的病人資訊 -->
                            <div class="bg-blue-50 rounded-lg p-4">
                                <div class="flex items-center mb-2">
                                    <span class="mr-2">👤</span>
                                    <span class="font-semibold text-gray-700">病人資訊</span>
                                </div>
                                <div id="selectedPatientInfo" class="text-sm text-gray-600">
                                    <!-- 病人資訊會動態載入 -->
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">👨‍⚕️</span><span>掛號醫師 *</span>
                                </label>
                                <select id="appointmentDoctor" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option value="">請選擇醫師</option>
                                    <!-- 醫師選項會動態載入 -->
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">⏰</span><span>掛號時間</span>
                                </label>
                                <input type="datetime-local" id="appointmentDateTime" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>

                            <!-- 問診資料選擇：允許醫師於掛號時選擇患者先前填寫的問診資料 -->
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">🧾</span><span>選擇問診資料</span>
                                </label>
                                <select id="inquirySelect" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <option value="">不使用問診資料</option>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">若病人已填寫問診，可在此選擇預填資訊</p>
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <span class="mr-2">📝</span><span>主訴症狀</span>
                                </label>
                                <textarea id="quickChiefComplaint" placeholder="請簡述病人的主要症狀..." rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                            </div>
                            
                            <div class="flex space-x-3 pt-4">
                                <button onclick="closeRegistrationModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <button onclick="confirmRegistration()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition duration-200">
                                    確認掛號
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 掛號列表 -->
                <div class="bg-white border border-gray-200 rounded-lg">
                    <!-- 為掛號列表標題區塊添加唯一 ID，方便在 CSS 中針對窄螢幕進行排版調整 -->
                    <div id="registrationHeader" class="bg-gray-50 px-6 py-4 border-b border-gray-200 rounded-t-lg">
                        <div class="flex justify-between items-center">
                            <!-- 左側：標題與日期選擇器 -->
                            <div class="flex items-center space-x-3">
                                <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                                    <span class="mr-2">📅</span><span>掛號列表</span>
                                </h3>
                                <div class="flex items-center space-x-1">
                                    <span class="whitespace-nowrap text-sm text-gray-600">日期</span>
                                    <input
                                        type="date"
                                        id="appointmentDatePicker"
                                        class="border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-green-500 focus:border-transparent text-gray-700 text-sm"
                                    />
                                </div>
                            </div>
                            <!-- 右側：總計人數顯示 -->
                            <div class="text-sm text-gray-600 flex items-center space-x-3">
                                <!-- 將標籤、數值和單位拆分為獨立元素，方便 i18n.js 處理翻譯 -->
                                <span>總計：</span>
                                <span id="todayTotal" class="font-semibold text-blue-600">0</span>
                                <span>人</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">序號</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">病人姓名</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">掛號醫師</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">掛號時間</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">主訴症狀</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">狀態</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="todayAppointmentsList" class="divide-y divide-gray-200">
                                    <!-- 掛號列表會動態載入 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!-- 診症記錄查看彈窗 -->
                <div id="medicalHistoryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="medicalHistoryTitle" class="text-xl font-bold text-gray-800">診症記錄</h3>
                            <button onclick="closeMedicalHistoryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <!-- 病人基本資訊 -->
                            <div id="medicalHistoryPatientInfo" class="bg-blue-50 rounded-lg p-4 mb-6">
                                <!-- 病人資訊會動態載入 -->
                            </div>
                            
                            <!-- 診症記錄列表 -->
                            <div id="medicalHistoryContent">
                                <!-- 診症記錄會動態載入 -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 診症表單區域 -->
                <div id="consultationForm" class="hidden bg-white border border-gray-200 rounded-lg mt-6">
                    <div class="bg-green-600 text-white px-6 py-4 rounded-t-lg">
                        <h3 class="text-xl font-bold">診症記錄</h3>
                    </div>
                    
                    <div class="p-6">
                        <!-- 病人資訊 -->
                        <div class="bg-blue-50 rounded-lg p-4 mb-6">
                            <!--
                              將診症表單中的病人基本資訊區域擴充，加入年齡、性別、過敏史以及病史備註的顯示。
                              其中過敏史與病史在無資料時會隱藏，其容器設置了對應的 ID 供 JavaScript 控制。
                            -->
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm">
                                <div>
                                    <span class="font-medium">病人：</span>
                                    <span id="formPatientName" class="text-blue-600 font-semibold"></span>
                                </div>
                                <div>
                                    <span class="font-medium">年齡：</span>
                                    <span id="formPatientAge"></span>
                                </div>
                                <div>
                                    <span class="font-medium">性別：</span>
                                    <span id="formPatientGender"></span>
                                </div>
                                <div>
                                    <span class="font-medium">掛號時間：</span>
                                    <span id="formAppointmentTime"></span>
                                </div>
                                <!-- 病史及備註：若無資料則隱藏 -->
                                <div id="historyContainer" class="md:col-span-1 lg:col-span-2" style="display: none;">
                                    <span class="font-medium">病史及備註：</span>
                                    <span id="formPatientHistory" class="medical-field text-gray-700"></span>
                                </div>
                                <!-- 過敏史：以紅色高亮顯示，若無資料則隱藏 -->
                                <div id="allergiesContainer" class="md:col-span-1 lg:col-span-2" style="display: none;">
                                    <span class="font-medium text-red-600">過敏史：</span>
                                    <span id="formPatientAllergies" class="medical-field text-red-700 bg-red-50 px-2 py-1 rounded"></span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 診症表單 -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- 左側 -->
                            <div class="space-y-4">
                                <div>
                                    <!-- 在主訴欄位旁新增載入診斷模板按鈕 -->
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">主訴 *</label>
                                        <!-- 診斷模板按鈕：點擊後開啟診斷模板選擇彈窗 -->
                                        <!-- 診斷模板載入按鈕：使用新的 openDiagnosisTemplate 包裝函式以顯示載入圈效果 -->
                                        <button
                                            type="button"
                                            onclick="openDiagnosisTemplate(event)"
                                            class="text-xs bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded transition duration-200"
                                        >
                                            🔍 載入診斷模板
                                        </button>
                                    </div>
                                    <textarea id="formSymptoms" placeholder="病人主要不適症狀、發病時間、症狀特點等..." rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>

                                <!-- 現病史欄位移至主訴下方，並調整高度為主訴的兩倍 -->
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        現病史
                                    </label>
                                    <textarea id="formCurrentHistory" placeholder="發病經過、症狀變化、治療經過等..." rows="6" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        舌象
                                    </label>
                                    <textarea id="formTongue" placeholder="舌質、舌苔、舌形等..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        脈象
                                    </label>
                                    <textarea id="formPulse" placeholder="脈位、脈率、脈力、脈形等..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        中醫診斷 *
                                    </label>
                                    <textarea id="formDiagnosis" placeholder="中醫病名診斷..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        證型診斷
                                    </label>
                                    <textarea id="formSyndrome" placeholder="辨證分型、病機分析..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                                
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">針灸備註</label>
                                        <button type="button" onclick="openAcupointCombo(event)" class="text-xs bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded transition duration-200">📍 載入常用穴位</button>
                                    </div>
                                    <!-- 搜索穴位並添加至針灸備註 -->
                                    <div class="mb-3 bg-blue-50 rounded-lg p-3 border border-blue-200">
                                        <div class="flex items-center mb-2">
                                            <span class="text-sm font-medium text-blue-800 mr-2">🔍 搜索穴位：</span>
                                            <div class="flex-1 relative">
                                                <input type="text" id="acupointNotesSearch" placeholder="搜尋穴位名稱、經絡或定位..." 
                                                       class="w-full border border-blue-300 rounded px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                       oninput="searchAcupointForNotes()">
                                                <button type="button" onclick="clearAcupointNotesSearch()" class="absolute right-2 top-1 text-gray-400 hover:text-gray-600 text-sm">×</button>
                                            </div>
                                        </div>
                                        <!-- 搜索結果 -->
                                        <div id="acupointNotesSearchResults" class="hidden">
                                            <div class="bg-white rounded border border-blue-200 max-h-40 overflow-y-auto">
                                                <div id="acupointNotesSearchList" class="grid grid-cols-1 md:grid-cols-2 gap-2 p-2">
                                                    <!-- 搜索結果會動態載入 -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- 針灸備註輸入區，使用 contenteditable 以便嵌入穴位方塊 -->
                                    <div id="formAcupunctureNotes" contenteditable="true" data-placeholder="針灸穴位、手法、注意事項等..."
                                         class="w-full border border-gray-300 rounded-lg px-3 py-2 min-h-[80px] focus:ring-2 focus:ring-blue-500 focus:border-transparent mb-2"></div>
                                </div>
                            </div>

                            
                            <!-- 右側 -->
                            <div class="space-y-4">
                                
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">處方內容</label>
                                        <div class="flex gap-2">
                                            <button type="button" onclick="openHerbCombo(event)" 
                                                    class="text-xs bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded transition duration-200">
                                                🌿 載入常用藥方
                                            </button>
                                            <button type="button" onclick="loadPreviousPrescription()" 
                                                    class="text-xs bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded transition duration-200">
                                                📋 載入上次處方
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- 中藥庫搜索區域 -->
                                    <div class="mb-3 bg-yellow-50 rounded-lg p-3 border border-yellow-200">
                                        <div class="flex items-center mb-2">
                                            <span class="text-sm font-medium text-yellow-800 mr-2">🔍 搜索中藥庫：</span>
                                            <div class="flex-1 relative">
                                                <input type="text" id="prescriptionSearch" placeholder="搜索中藥材、方劑名稱或功能..." 
                                                       class="w-full border border-yellow-300 rounded px-3 py-1 text-sm focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
                                                       oninput="searchHerbsForPrescription()">
                                                <button onclick="clearPrescriptionSearch()" class="absolute right-2 top-1 text-gray-400 hover:text-gray-600 text-sm">×</button>
                                            </div>
                                        </div>
                                        
                                        <!-- 搜索結果 -->
                                        <div id="prescriptionSearchResults" class="hidden">
                                            <div class="bg-white rounded border border-yellow-200 max-h-48 overflow-y-auto">
                                                <div id="prescriptionSearchList" class="grid grid-cols-1 md:grid-cols-2 gap-2 p-2">
                                                    <!-- 搜索結果會動態載入 -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 已選擇的處方內容 -->
                                    <div class="border border-gray-300 rounded-lg p-3 min-h-[120px] bg-gray-50">
                                        <div id="selectedPrescriptionItems" class="space-y-2">
                                            <div class="text-sm text-gray-500 text-center py-4">
                                                請使用上方搜索功能添加中藥材或方劑
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 服藥天數及次數設定（只在有處方內容時顯示） -->
                                    <div id="medicationSettings" class="mt-3 bg-yellow-50 rounded-lg p-3 border border-yellow-200" style="display: none;">
                                        <div class="space-y-3">
                                            <!-- 服藥天數 -->
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium text-yellow-800">服藥天數</span>
                                                <div class="flex items-center space-x-2">
                                                    <button onclick="updateMedicationDays(-1)" class="w-7 h-7 bg-yellow-500 text-white rounded-full text-sm hover:bg-yellow-600 transition duration-200">-</button>
                                                    <input type="number" id="medicationDays" value="5" min="1" max="30" 
                                                           class="w-14 px-2 py-1 text-center border border-yellow-300 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-sm"
                                                           onchange="updateMedicationDaysFromInput()" onclick="this.select()">
                                                    <button onclick="updateMedicationDays(1)" class="w-7 h-7 bg-yellow-500 text-white rounded-full text-sm hover:bg-yellow-600 transition duration-200">+</button>
                                                    <span class="text-sm text-yellow-800">天</span>
                                                </div>
                                            </div>
                                            
                                            <!-- 服藥次數 -->
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm font-medium text-yellow-800">每日次數</span>
                                                <div class="flex items-center space-x-2">
                                                    <button onclick="updateMedicationFrequency(-1)" class="w-7 h-7 bg-yellow-500 text-white rounded-full text-sm hover:bg-yellow-600 transition duration-200">-</button>
                                                    <input type="number" id="medicationFrequency" value="2" min="1" max="6" 
                                                           class="w-14 px-2 py-1 text-center border border-yellow-300 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-sm"
                                                           onchange="updateMedicationFrequency(0)" onclick="this.select()">
                                                    <button onclick="updateMedicationFrequency(1)" class="w-7 h-7 bg-yellow-500 text-white rounded-full text-sm hover:bg-yellow-600 transition duration-200">+</button>
                                                    <span class="text-sm text-yellow-800">次/日</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 隱藏的文本域用於存儲處方內容 -->
                                    <textarea id="formPrescription" class="hidden"></textarea>
                                </div>
                                
                                <!-- 將原本的「服用方法」欄位移至療程上方，並改名為「中藥服用方法」 -->

                                
                                <div>
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">
                                            收費項目
                                        </label>
                                        <button type="button" onclick="loadPreviousBillingItems()" 
                                                class="text-xs bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded transition duration-200">
                                            💰 載入上次收費
                                        </button>
                                    </div>
                                    
                                    <!-- 收費項目搜索區域 -->
                                    <div class="mb-3 bg-green-50 rounded-lg p-3 border border-green-200">
                                        <div class="flex items-center mb-2">
                                            <span class="text-sm font-medium text-green-800 mr-2">💰 選擇收費項目：</span>
                                            <div class="flex-1 relative">
                                                <input type="text" id="billingSearch" placeholder="搜索收費項目名稱..." 
                                                       class="w-full border border-green-300 rounded px-3 py-1 text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                                       oninput="searchBillingForConsultation()">
                                                <button onclick="clearBillingSearch()" class="absolute right-2 top-1 text-gray-400 hover:text-gray-600 text-sm">×</button>
                                            </div>
                                        </div>
                                        
                                        <!-- 搜索結果 -->
                                        <div id="billingSearchResults" class="hidden">
                                            <div class="bg-white rounded border border-green-200 max-h-48 overflow-y-auto">
                                                <div id="billingSearchList" class="grid grid-cols-1 md:grid-cols-2 gap-2 p-2">
                                                    <!-- 搜索結果會動態載入 -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 已選擇的收費項目 -->
                                    <div class="border border-gray-300 rounded-lg p-3 min-h-[80px] bg-gray-50">
                                        <div id="selectedBillingItems" class="space-y-2">
                                            <div class="text-sm text-gray-500 text-center py-4">
                                                請使用上方搜索功能添加收費項目
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 總費用顯示 -->
                                    <div class="mt-2 text-right">
                                        <span class="text-sm font-medium text-gray-700">總費用：</span>
                                        <span id="totalBillingAmount" class="text-lg font-bold text-green-600">$0</span>
                                    </div>
                                    
                                    <!-- 隱藏的文本域用於存儲收費項目 -->
                                    <textarea id="formBillingItems" class="hidden"></textarea>
                                    <!-- 病人套票管理 -->
                                    <div class="mt-4 border border-purple-200 rounded-lg p-3 bg-purple-50">
                                      <div class="flex items-center justify-between mb-2">
                                        <div class="text-sm font-semibold text-purple-800">🎫 病人套票</div>
                                        <button type="button" onclick="refreshPatientPackagesUI()"
                                                class="text-xs px-2 py-1 bg-purple-600 text-white rounded">刷新</button>
                                      </div>
                                      <div id="patientPackagesList" class="space-y-2 text-sm text-gray-700">
                                        <!-- 動態載入 -->
                                        <div class="text-gray-500">尚未載入或無套票</div>
                                      </div>
                                    </div>
                                </div>
                                
                                <!-- 新增「中藥服用方法」欄位，移到療程欄位上方 -->
                                <div>
                                    <!-- 在中藥服用方法欄位旁新增載入醫囑模板按鈕 -->
                                    <div class="flex justify-between items-center mb-2">
                                        <label class="block text-sm font-semibold text-gray-700">中藥服用方法</label>
                                        <!-- 醫囑模板按鈕：點擊後開啟醫囑模板選擇彈窗 -->
                                        <!-- 醫囑模板載入按鈕：使用新的 openPrescriptionTemplate 包裝函式以顯示載入圈效果 -->
                                        <button
                                            type="button"
                                            onclick="openPrescriptionTemplate(event)"
                                            class="text-xs bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded transition duration-200"
                                        >
                                            📋 載入醫囑模板
                                        </button>
                                    </div>
                                    <textarea id="formUsage" placeholder="煎煮方法、服用時間、劑量等..." rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        療程
                                    </label>
                                    <input type="text" id="formTreatmentCourse" placeholder="例：7天、2週、1個月等..." class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        醫囑及注意事項
                                    </label>
                                    <textarea id="formInstructions" placeholder="飲食宜忌、生活調護、注意事項等..." rows="3" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 複診時間及其他時間設定 -->
                        <div class="mt-6 pt-4 border-t border-gray-200">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        複診時間
                                    </label>
                                    <input type="datetime-local" id="formFollowUpDate" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">建議病人下次回診的時間</p>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        到診時間
                                    </label>
                                    <input type="datetime-local" id="formVisitTime" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">實際到診的時間（用於證明書）</p>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">
                                        建議休息期間
                                    </label>
                                    <div class="space-y-2">
                                        <div class="flex items-center space-x-2">
                                            <label class="text-xs text-gray-600 w-12">開始：</label>
                                            <input type="date" id="formRestStartDate" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" onchange="updateRestPeriod()">
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <label class="text-xs text-gray-600 w-12">結束：</label>
                                            <input type="date" id="formRestEndDate" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" onchange="updateRestPeriod()">
                                        </div>
                                        <div class="text-center">
                                            <span id="restPeriodDisplay" class="text-sm text-gray-500 font-medium">請選擇開始和結束日期</span>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">用於病假證明書的建議休息期間</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 操作按鈕 -->
                        <div class="flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200">
                            <button onclick="cancelConsultation()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                取消診症
                            </button>
                            <button onclick="saveConsultation()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                <span id="consultationSaveButtonText">保存病歷</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 中藥庫 -->
            <div id="herbLibrary" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800"> <span class="text-3xl mr-3">🌿</span>中藥庫</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchHerb" placeholder="搜尋中藥材、方劑名稱或功能..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                        </div>
                    </div>
                </div>
                <!-- 分類標籤 -->
                <div class="mb-6">
                    <div class="flex flex-wrap items-center gap-2">
                        <button onclick="filterHerbLibrary('all')" id="filter-all" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-800 transition duration-200">
                            全部
                        </button>
                        <button onclick="filterHerbLibrary('herb')" id="filter-herb" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            中藥材
                        </button>
                        <button onclick="filterHerbLibrary('formula')" id="filter-formula" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            方劑
                        </button>
                        <select id="herbSortSelect" onchange="changeHerbSortOrder(this.value)" class="ml-auto px-4 py-2 rounded-lg text-sm font-medium bg-white border border-gray-300 text-gray-700">
                            <option value="">排序方式</option>
                            <option value="most">庫存最多</option>
                            <option value="least">庫存最少</option>
                            <!-- 新增使用次數排序選項 -->
                            <option value="useMost">使用最多</option>
                            <option value="useLeast">使用最少</option>
                        </select>
                    </div>
                </div>
                <!-- 新增/編輯中藥材表單彈窗 -->
                <div id="addHerbModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="herbFormTitle" class="text-xl font-bold text-gray-800">新增中藥材</h3>
                            <button onclick="hideAddHerbForm()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">中藥材名稱 *</label>
                                    <input type="text" id="herbName" placeholder="請輸入中藥材名稱" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">別名</label>
                                    <input type="text" id="herbAlias" placeholder="其他名稱或別名" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <!-- 新增性味與歸經欄位 -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">性味</label>
                                    <input type="text" id="herbNature" placeholder="例：辛、溫" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">歸經</label>
                                    <input type="text" id="herbMeridian" placeholder="例：肺、脾經" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">功效</label>
                                    <textarea id="herbEffects" placeholder="請描述主要功效" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <!-- 新增主治欄位 -->
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">主治</label>
                                    <textarea id="herbIndications" placeholder="請描述主治" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">常用劑量</label>
                                    <input type="text" id="herbDosage" placeholder="例：3-9g" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">使用注意</label>
                                    <input type="text" id="herbCautions" placeholder="禁忌或注意事項" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <!-- 新增庫存量與警戒量欄位 -->
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">存庫量 (g)</label>
                                    <input type="number" id="herbStock" placeholder="請輸入存庫量" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" min="0" step="0.5">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">補貨警戒量 (g)</label>
                                    <input type="number" id="herbThreshold" placeholder="庫存低於此值顯示紅色" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" min="0" step="0.5">
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddHerbForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <button onclick="saveHerb()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="herbSaveButtonText">儲存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 新增/編輯方劑表單彈窗 -->
                <div id="addFormulaModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="formulaFormTitle" class="text-xl font-bold text-gray-800">新增方劑</h3>
                            <button onclick="hideAddFormulaForm()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">方劑名稱 *</label>
                                        <input type="text" id="formulaName" placeholder="請輸入方劑名稱" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">出處</label>
                                        <input type="text" id="formulaSource" placeholder="例：傷寒論、金匱要略" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">功效</label>
                                        <textarea id="formulaEffects" placeholder="請描述方劑主要功效" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                </div>
                                
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">組成 *</label>
                                        <textarea id="formulaComposition" placeholder="請輸入方劑組成，例如：&#10;人參&#10;白朮&#10;茯苓&#10;甘草" rows="8" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">注意事項</label>
                                        <textarea id="formulaCautions" placeholder="禁忌、注意事項等" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <!-- 新增主治與用法欄位 -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">主治</label>
                                        <textarea id="formulaIndications" placeholder="請描述方劑主治" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">用法</label>
                                        <textarea id="formulaUsage" placeholder="請描述方劑用法" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                                    </div>
                                    <!-- 新增庫存量與警戒量欄位 -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">存庫量 (g)</label>
                                        <input type="number" id="formulaStock" placeholder="請輸入存庫量" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.5">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">補貨警戒量 (g)</label>
                                        <input type="number" id="formulaThreshold" placeholder="庫存低於此值顯示紅色" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.5">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddFormulaForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <button onclick="saveFormula()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="formulaSaveButtonText">儲存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 庫存編輯彈窗 -->
                <div id="inventoryModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
                        <div class="p-6">
                            <h3 id="inventoryModalTitle" class="text-xl font-bold mb-4">編輯庫存</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">剩餘數量</label>
                                    <!-- 將輸入框與單位下拉改為響應式：手機垂直排列，桌面橫向排列 -->
                                    <div class="flex flex-col sm:flex-row items-center">
                                        <input type="number" id="inventoryQuantity" class="w-full flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.5">
                                        <select id="inventoryQuantityUnit" class="mt-2 sm:mt-0 sm:ml-2 border border-gray-300 rounded px-2 py-2 text-sm">
                                            <option value="g" selected>克</option>
                                            <option value="jin">斤</option>
                                            <option value="liang">兩</option>
                                            <option value="qian">錢</option>
                                        </select>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">補貨警戒量</label>
                                    <div class="flex items-center">
                                        <!-- 讓輸入框在小螢幕時佔滿整行，避免超出右邊邊框 -->
                                        <input type="number" id="inventoryThreshold" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.5">
                                    </div>
                                </div>
                            </div>
                            <div class="mt-6 flex justify-end space-x-4">
                                <button onclick="hideInventoryModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">取消</button>
                                <button onclick="saveInventoryChanges()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">儲存</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 中藥庫列表 -->
                <div class="overflow-x-auto">
                    <div id="herbLibraryList" class="space-y-4">
                        <!-- 中藥庫內容會動態載入 -->
                    </div>
                </div>
            </div>

            <!-- 穴位庫 -->
            <div id="acupointLibrary" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800"> <span class="text-3xl mr-3">📌</span>穴位庫</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchAcupoint" placeholder="搜尋穴位、經絡名稱或功能..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                        </div>
                    </div>
                </div>
                <!-- 分類標籤 -->
                <div class="mb-6">
                    <div id="acupointFilterContainer" class="flex flex-wrap gap-2">
                        <!-- 動態產生的經絡分類按鈕 -->
                    </div>
                </div>
                <!-- 穴位庫列表 -->
                <div class="overflow-x-auto">
                    <div id="acupointLibraryList" class="space-y-4">
                        <!-- 穴位庫內容會動態載入 -->
                    </div>
                </div>
            </div>

            <!-- 收費項目管理 -->
            <div id="billingManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800"> <span class="text-3xl mr-3">💰</span>收費項目管理</h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchBilling" placeholder="搜尋收費項目名稱..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                        </div>
                        <button onclick="showAddBillingItemForm()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + 新增收費項目
                        </button>
                    </div>
                </div>
                <!-- 分類標籤 -->
                <div class="mb-6">
                    <div class="flex flex-wrap gap-2">
                        <button onclick="filterBillingItems('all')" id="billing-filter-all" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-800 transition duration-200">
                            全部
                        </button>
                        <button onclick="filterBillingItems('consultation')" id="billing-filter-consultation" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            診療費
                        </button>
                        <button onclick="filterBillingItems('medicine')" id="billing-filter-medicine" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            藥費
                        </button>
                        <button onclick="filterBillingItems('treatment')" id="billing-filter-treatment" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            治療費
                        </button>
                        <button onclick="filterBillingItems('other')" id="billing-filter-other" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            其他
                        </button>
                        <button onclick="filterBillingItems('discount')" id="billing-filter-discount" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            折扣項目
                        </button>
                        <button onclick="filterBillingItems('package')" id="billing-filter-package" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            套票項目
                        </button>
                    </div>
                </div>
                <!-- 新增/編輯收費項目表單彈窗 -->
                <div id="addBillingItemModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="billingItemFormTitle" class="text-xl font-bold text-gray-800">新增收費項目</h3>
                            <button onclick="hideAddBillingItemForm()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">項目名稱 *</label>
                                    <input type="text" id="billingItemName" placeholder="請輸入收費項目名稱" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">項目類別 *</label>
                                    <select id="billingItemCategory" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                        <option value="">請選擇類別</option>
                                        <option value="consultation">診療費</option>
                                        <option value="medicine">藥費</option>
                                        <option value="treatment">治療費</option>
                                        <option value="other">其他</option>
                                        <option value="discount">折扣項目</option>
                                        <option value="package">套票項目</option>
                                    </select>
                                </div>
                                <!-- 套票專用欄位：當類別選擇 package 時顯示 -->
                                <div id="packageFields" class="md:col-span-2 hidden">
                                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                      <label class="block text-sm font-medium text-gray-700 mb-1">套票可用次數 *</label>
                                      <input type="number" id="billingItemPackageUses" placeholder="例如：10" min="1"
                                             class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    </div>
                                    <div>
                                      <label class="block text-sm font-medium text-gray-700 mb-1">有效天數 *</label>
                                      <input type="number" id="billingItemValidityDays" placeholder="例如：180（半年）" min="1"
                                             class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                      <p class="text-xs text-gray-500 mt-1">自購買日起算</p>
                                    </div>
                                  </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">收費金額 *</label>
                                    <input type="number" id="billingItemPrice" placeholder="0" step="1" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">折扣項目：輸入0.9表示9折，輸入9會自動轉為9折，或輸入負數表示固定金額折扣</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">計費單位</label>
                                    <input type="text" id="billingItemUnit" placeholder="例：次、劑、包" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">項目說明</label>
                                    <textarea id="billingItemDescription" placeholder="請描述收費項目的詳細內容" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"></textarea>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="billingItemActive" checked class="mr-2 rounded">
                                        <span class="text-sm font-medium text-gray-700">啟用此收費項目</span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddBillingItemForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <button onclick="saveBillingItem()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="billingItemSaveButtonText">儲存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 收費項目列表 -->
                <div class="overflow-x-auto">
                    <div id="billingItemsList" class="space-y-4">
                        <!-- 收費項目內容會動態載入 -->
                    </div>
                </div>
            </div>
            <!-- 診所用戶管理 -->
            <div id="userManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                        <!-- 使用單人圖示代表診所用戶管理 -->
                        <span class="text-3xl mr-3">👤</span>
                        診所用戶管理
                    </h2>
                    <div class="flex flex-col md:flex-row gap-3">
                        <div class="relative">
                            <input type="text" id="searchUser" placeholder="搜尋用戶名稱或電子郵件..." class="border border-gray-300 rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
                            <span class="absolute right-3 top-2.5 text-gray-400">🔍</span>
                        </div>
                        <button onclick="showAddUserForm()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition duration-200 whitespace-nowrap">
                            + 新增用戶
                        </button>
                    </div>
                </div>
                <!-- 狀態篩選標籤 -->
                <div class="mb-6">
                    <div class="flex flex-wrap gap-2">
                        <button onclick="filterUsers('all')" id="user-filter-all" class="px-4 py-2 rounded-lg text-sm font-medium bg-blue-100 text-blue-800 transition duration-200">
                            全部用戶
                        </button>
                        <button onclick="filterUsers('inactive')" id="user-filter-inactive" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition duration-200">
                            已停用
                        </button>
                    </div>
                </div>
                <!-- 新增/編輯用戶表單彈窗 -->
                <div id="addUserModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
                    <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                        <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                            <h3 id="userFormTitle" class="text-xl font-bold text-gray-800">新增用戶</h3>
                            <button onclick="hideAddUserForm()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
                        </div>
                        
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">姓名 *</label>
                                    <input type="text" id="userDisplayName" placeholder="請輸入真實姓名" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">職位 *</label>
                                    <select id="userPosition" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" onchange="toggleRegistrationNumberField()">
                                        <option value="">請選擇職位</option>
                                        <option value="診所管理">診所管理</option>
                                        <option value="醫師">醫師</option>
                                        <option value="護理師">護理師</option>
        <option value="用戶">一般用戶</option>
                                    </select>
                                </div>
                                <div id="registrationNumberField" class="hidden">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">中醫註冊編號 *</label>
                                    <input type="text" id="userRegistrationNumber" placeholder="請輸入中醫註冊編號" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">醫師職位必須填寫註冊編號</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">電子郵件 *</label>
                                    <input type="email" id="userEmail" placeholder="請輸入電子郵件" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">電話號碼</label>
                                    <input type="tel" id="userPhone" placeholder="請輸入電話號碼" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                </div>
                                <!-- Firebase UID 欄位 -->
                                <div id="uidField">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Firebase UID</label>
                                    <input type="text" id="userUID" placeholder="請輸入 Firebase UID（可不填）" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                    <p class="text-xs text-gray-500 mt-1">對應 Firebase Authentication 帳號的 UID</p>
                                </div>

        <!-- 初始密碼與確認密碼欄位，僅新增用戶時顯示 -->
        <div id="passwordFields" class="grid grid-cols-1 md:grid-cols-2 gap-4 md:col-span-2">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">初始密碼 *</label>
                <input type="password" id="userPassword" placeholder="請輸入初始密碼" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">確認密碼 *</label>
                <input type="password" id="userPasswordConfirm" placeholder="請再次輸入密碼" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
            </div>
        </div>
                                <div class="md:col-span-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="userActive" checked class="mr-2 rounded">
                                        <span class="text-sm font-medium text-gray-700">啟用此用戶帳號</span>
                                    </label>
                                    <p class="text-xs text-gray-500 mt-1">停用的帳號將無法登入系統</p>
                                </div>
                            </div>
                            
                            <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                                <button onclick="hideAddUserForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                                    取消
                                </button>
                                <!-- 為用戶儲存按鈕增加 id，便於顯示讀取圈 -->
                                <button id="userSaveButton" onclick="saveUser()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200">
                                    <span id="userSaveButtonText">儲存</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 用戶列表 -->
                <div class="overflow-x-auto">
                    <table class="w-full table-auto">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">姓名</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">職位</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">註冊編號</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">電子郵件</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">狀態</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">最後登入</th>
                                <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">操作</th>
                            </tr>
                        </thead>
                        <tbody id="userList" class="divide-y divide-gray-200">
                            <!-- 用戶資料會動態載入 -->
                        </tbody>
                    </table>
                </div>
            </div>
<!-- 財務報表 -->
            <div id="financialReports" class="hidden bg-white rounded-xl shadow-lg p-6">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2 flex items-center">
                        <span class="mr-3">📊</span>財務報表
                    </h2>
                    <p class="text-gray-600">診所收入分析與財務統計</p>
                </div>
                <!-- 篩選控制區 -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">報表類型</label>
                            <select id="quickDate" onchange="setQuickDate()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">請選擇...</option>
                                <option value="today">今天</option>
                                <option value="yesterday">昨天</option>
                                <option value="thisWeek">本週</option>
                                <option value="lastWeek">上週</option>
                                <option value="thisMonth">本月</option>
                                <option value="lastMonth">上月</option>
                                <option value="thisYear">今年</option>
                                <option value="lastYear">去年</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">開始日期</label>
                            <input type="date" id="startDate" onchange="generateFinancialReport()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">結束日期</label>
                            <input type="date" id="endDate" onchange="generateFinancialReport()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">醫師篩選</label>
                            <select id="doctorFilter" onchange="generateFinancialReport()" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                                <option value="">全部醫師</option>
                            </select>
                        </div>
                        
                        <div class="flex items-end space-x-2">
                            <button onclick="generateFinancialReport()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition duration-200 flex items-center">
                                <span class="mr-2">🔄</span><span>更新報表</span>
                            </button>
                            <button onclick="exportFinancialReport()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200 flex items-center">
                                <span class="mr-2">📥</span><span>匯出</span>
                            </button>
                        </div>
                    </div>
                </div>
                <!-- 關鍵指標卡片 -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gradient-to-r from-green-400 to-green-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-green-100 text-sm font-medium">總收入</p>
                                <h3 id="totalRevenue" class="text-3xl font-bold">$0</h3>
                                <p id="revenueChange" class="text-green-100 text-sm mt-1">統計期間收入</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">💰</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-blue-400 to-blue-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-blue-100 text-sm font-medium">診症人次</p>
                                <h3 id="totalConsultations" class="text-3xl font-bold">0</h3>
                                <p id="consultationChange" class="text-blue-100 text-sm mt-1">完成診症次數</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">👥</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-purple-400 to-purple-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-purple-100 text-sm font-medium">平均消費</p>
                                <h3 id="averageRevenue" class="text-3xl font-bold">$0</h3>
                                <p id="averageChange" class="text-purple-100 text-sm mt-1">每次診症平均</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">📊</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gradient-to-r from-orange-400 to-orange-600 text-white rounded-xl p-6 shadow-lg transform hover:scale-105 transition duration-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-orange-100 text-sm font-medium">活躍醫師</p>
                                <h3 id="activeDoctors" class="text-3xl font-bold">0</h3>
                                <p id="doctorChange" class="text-orange-100 text-sm mt-1">有診症的醫師</p>
                            </div>
                            <div class="bg-white bg-opacity-20 rounded-full p-3">
                                <span class="text-2xl">👨‍⚕️</span>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 詳細報表 -->
                <div class="bg-white border border-gray-200 rounded-lg">
                    <div class="bg-gray-50 px-6 py-4 border-b border-gray-200 rounded-t-lg">
                        <div class="flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                                <span class="mr-2">📋</span><span>詳細財務報表</span>
                            </h3>
                            <div class="text-sm text-gray-600 flex items-center space-x-1">
                                <!-- 將標籤與時間拆分，使多語系翻譯可以套用 -->
                                <span>資料更新時間：</span>
                                <span id="lastUpdateTime">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 標籤頁 -->
                    <div class="border-b border-gray-200">
                        <nav class="flex space-x-8 px-6" role="tablist">
                            <button onclick="switchFinancialTab('summary')" id="financialSummaryTab" class="py-4 px-1 border-b-2 border-green-500 text-green-600 font-medium text-sm transition duration-200">
                                收入摘要
                            </button>
                            <button onclick="switchFinancialTab('daily')" id="financialDailyTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm transition duration-200">
                                每日明細
                            </button>
                            <button onclick="switchFinancialTab('doctor')" id="financialDoctorTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm transition duration-200">
                                醫師業績
                            </button>
                            <button onclick="switchFinancialTab('service')" id="financialServiceTab" class="py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm transition duration-200">
                                服務分析
                            </button>
                        </nav>
                    </div>
                    
                    <!-- 標籤內容 -->
                    <div class="p-6">
                        <!-- 收入摘要標籤 -->
                        <div id="financialSummaryContent" class="financial-tab-content">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">項目</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">金額</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">佔比</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">備註</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialSummaryTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="4" class="px-4 py-8 text-center text-gray-500">
                                                請點擊「更新報表」來載入資料
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- 每日明細標籤 -->
                        <div id="financialDailyContent" class="financial-tab-content hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">日期</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">診症人次</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">收入金額</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">平均消費</th>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">主要服務</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialDailyTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                                請點擊「更新報表」來載入資料
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- 醫師業績標籤 -->
                        <div id="financialDoctorContent" class="financial-tab-content hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">醫師</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">診症人次</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">總收入</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">平均消費</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">佔比</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialDoctorTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                                請點擊「更新報表」來載入資料
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- 服務分析標籤 -->
                        <div id="financialServiceContent" class="financial-tab-content hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">服務類型</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">次數</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">總金額</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">平均單價</th>
                                            <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700">收入佔比</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financialServiceTableBody" class="divide-y divide-gray-200">
                                        <tr>
                                            <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                                請點擊「更新報表」來載入資料
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 系統管理 -->
            <div id="systemManagement" class="hidden bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6"> <span class="text-3xl mr-3">⚙️</span>系統管理</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

<div class="bg-gray-50 rounded-lg p-6">
    <h3 class="text-lg font-semibold mb-4">資料備份與還原</h3>
    <!-- 說明備份內容：模板庫、中藥庫及穴位庫不包含在匯出備份中 -->
    <p class="text-sm text-gray-600 mb-4">您可以匯出診所資料備份（包含所有功能資料，不含模板庫、中藥庫及穴位庫），或匯入之前的備份檔案。實時掛號及問診資料不包含在備份中。</p>
    <div class="flex flex-col md:flex-row gap-4">
        <button id="backupExportBtn" onclick="exportClinicBackup()" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition duration-200">
            匯出備份
        </button>
        <button id="backupImportBtn" onclick="triggerBackupImport()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition duration-200">
            匯入備份
        </button>
        <input type="file" id="backupFileInput" accept=".json" class="hidden" onchange="handleBackupFile(this.files[0])">
    </div>
    <!-- 匯入進度條 -->
    <div id="backupProgressContainer" class="hidden mt-4">
        <div class="w-full bg-gray-200 rounded-full h-2.5">
            <div id="backupProgressBar" class="bg-blue-600 h-2.5 rounded-full" style="width:0%"></div>
        </div>
        <div id="backupProgressText" class="mt-2 text-sm text-gray-700"></div>
    </div>
</div>
                                
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">診所設定</h3>
                        <div class="space-y-3">
                            <div class="text-center py-4" id="clinicSettingsDisplay">
                                <div class="text-sm text-gray-700 mb-3">
                                    <!-- 將標籤與值拆分為不同的元素，以便 i18n.js 處理翻譯 -->
                                    <div class="font-medium flex items-center space-x-1">
                                        <span>診所中文名稱：</span><span id="displayChineseName">名醫診所系統</span>
                                    </div>
                                    <div class="text-gray-600 mt-1 flex items-center space-x-1">
                                        <span>診所英文名稱：</span><span id="displayEnglishName">TCM Clinic</span>
                                    </div>
                                </div>
                                <button onclick="showClinicSettingsModal()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition duration-200">
                                    診所資料修改
                                </button>
                            </div>
                        </div>
                    </div>

                    
                </div>
            </div>
        </div>
        <!-- 個人設置與模板庫內容 -->
        <!-- 個人設置區：在外層加入與其他頁面一致的寬度與內邊距容器，卡片樣式位於內層 -->
        <!-- 個人設置區：包裝在與其他頁面相同的寬度限制與內外邊距容器中，使版面保持一致 -->
        <div id="personalSettings" class="hidden max-w-7xl mx-auto px-4 py-6">
          <div class="bg-white rounded-xl shadow-lg p-6">
            <!-- 移除內層多餘的背景框，避免重複包裹 -->
            <div>
            <h2 class="text-2xl font-bold text-amber-800 mb-6 flex items-center">
              <span class="text-3xl mr-3">🔧</span>
              個人設置
            </h2>
            
            <!-- 標籤切換 -->
            <div class="mb-6">
              <div class="flex border-b border-gray-200">
                <button class="px-6 py-3 text-amber-700 border-b-2 border-amber-500 font-medium" onclick="switchPersonalTab('herbs')" id="herbsTab">
                  🌿 慣用中藥組合
                  <!-- 動態顯示慣用中藥組合數量 -->
                  <span id="herbCount" class="ml-2 text-xs font-semibold bg-green-100 text-green-700 rounded-full px-2 py-0.5"></span>
                </button>
                <button class="px-6 py-3 text-gray-500 hover:text-amber-700 font-medium" onclick="switchPersonalTab('acupoints')" id="acupointsTab">
                  📍 慣用穴位組合
                  <!-- 動態顯示慣用穴位組合數量 -->
                  <span id="acupointCount" class="ml-2 text-xs font-semibold bg-blue-100 text-blue-700 rounded-full px-2 py-0.5"></span>
                </button>
              </div>
            </div>

            <!-- 中藥組合內容 -->
            <div id="herbsContent" class="personal-tab-content">
              <div class="mb-6 space-y-4">
                <div class="flex gap-4 flex-wrap">
                  <button class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors" onclick="addNewHerbCombination()">
                    + 新增藥方組合
                  </button>
                  <button class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors" onclick="showCategoryModal('herbs')">
                    + 管理分類
                  </button>
                </div>
                <div class="flex gap-4 flex-wrap">
                  <!-- 個人慣用中藥組合：底層搜尋欄與分類篩選 -->
                  <input id="herbComboSearchInput" type="text" placeholder="搜尋藥方組合名稱..." class="px-4 py-2 border-2 border-green-200 rounded-lg focus:border-green-400 focus:outline-none flex-1 min-w-64">
                  <select id="herbComboCategoryFilter" class="px-4 py-2 border-2 border-green-200 rounded-lg focus:border-green-400 focus:outline-none">
                    <option>全部分類</option>
                    <option>感冒類</option>
                    <option>消化系統</option>
                    <option>婦科調理</option>
                    <option>補益類</option>
                    <option>清熱類</option>
                  </select>
                  <!-- 移除使用頻率篩選下拉選單 -->
                </div>
              </div>
              <div class="grid md:grid-cols-2 gap-6" id="herbCombinationsContainer">
                <!-- 動態載入中藥組合 -->
              </div>
            </div>

            <!-- 穴位組合內容 -->
            <div id="acupointsContent" class="personal-tab-content hidden">
              <div class="mb-6 space-y-4">
                <div class="flex gap-4 flex-wrap">
                  <button class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors" onclick="addNewAcupointCombination()">
                    + 新增穴位組合
                  </button>
                  <button class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors" onclick="showCategoryModal('acupoints')">
                    + 管理分類
                  </button>
                </div>
                <div class="flex gap-4 flex-wrap">
                  <!-- 個人慣用穴位組合：底層搜尋欄與分類篩選 -->
                  <input id="acupointComboSearchInput" type="text" placeholder="搜尋穴位組合名稱..." class="px-4 py-2 border-2 border-blue-200 rounded-lg focus:border-blue-400 focus:outline-none flex-1 min-w-64">
                  <select id="acupointComboCategoryFilter" class="px-4 py-2 border-2 border-blue-200 rounded-lg focus:border-blue-400 focus:outline-none">
                    <option>全部分類</option>
                    <option>頭面部</option>
                    <option>胸腹部</option>
                    <option>四肢部</option>
                    <option>背腰部</option>
                    <option>內科疾病</option>
                    <option>婦科疾病</option>
                  </select>
                  <select class="px-4 py-2 border-2 border-blue-200 rounded-lg focus:border-blue-400 focus:outline-none">
                    <option>全部針法</option>
                    <option>補法</option>
                    <option>瀉法</option>
                    <option>平補平瀉</option>
                    <option>配合艾灸</option>
                  </select>
                </div>
              </div>
              <div class="grid md:grid-cols-2 gap-6" id="acupointCombinationsContainer">
                <!-- 動態載入穴位組合 -->
              </div>
            </div>
            </div>
          </div>
        </div>

        <!-- 個人統計分析區：包裝在與其他頁面相同的寬度限制與內外邊距容器中，統計醫師個人用藥與穴位偏好 -->
        <div id="personalStatistics" class="hidden max-w-7xl mx-auto px-4 py-6">
          <div class="bg-white rounded-xl shadow-lg p-6">
            <div>
            <h2 class="text-2xl font-bold text-amber-800 mb-6 flex items-center">
              <span class="text-3xl mr-3">📈</span>
              個人統計分析
            </h2>
            <!-- 說明文字：指引使用者此功能用途 -->
            <p class="text-gray-600 mb-6">統計醫師個人用藥與穴位使用情況，提供用藥和穴位偏好分析。</p>
            <!-- 依序排列：方劑在上，中藥在下，穴位置底。每個卡片內部使用二欄佈局：圖表與列表並列 -->
            <div class="space-y-8">
              <!-- 常用方劑統計區塊 -->
              <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                  <span class="mr-2">📋</span>常用方劑
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                  <!-- 圖表 -->
                  <div>
                    <canvas id="personalFormulaChart" class="w-full h-60"></canvas>
                  </div>
                  <!-- 清單 -->
                  <ul id="personalFormulaList" class="divide-y divide-gray-200 text-sm">
                    <!-- 動態載入方劑統計 -->
                  </ul>
                </div>
              </div>
              <!-- 常用中藥統計區塊 -->
              <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                  <span class="mr-2">🌿</span>常用中藥
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                  <div>
                    <canvas id="personalHerbChart" class="w-full h-60"></canvas>
                  </div>
                  <ul id="personalHerbList" class="divide-y divide-gray-200 text-sm">
                    <!-- 動態載入中藥統計 -->
                  </ul>
                </div>
              </div>
              <!-- 常用穴位統計區塊 -->
              <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                  <span class="mr-2">📍</span>常用穴位
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                  <div>
                    <canvas id="personalAcupointChart" class="w-full h-60"></canvas>
                  </div>
                  <ul id="personalAcupointList" class="divide-y divide-gray-200 text-sm">
                    <!-- 動態載入穴位統計 -->
                  </ul>
                </div>
              </div>
            </div>
            </div>
          </div>
        </div>

        <!-- 帳號安全設定區：允許使用者變更密碼及刪除帳號 -->
        <div id="accountSecurity" class="hidden max-w-7xl mx-auto px-4 py-6">
          <div class="bg-white rounded-xl shadow-lg p-6">
            <div>
            <h2 class="text-2xl font-bold text-amber-800 mb-6 flex items-center">
              <span class="text-3xl mr-3">🔐</span>
              帳號安全設定
            </h2>
            <p class="text-gray-600 mb-6">在此可以安全地變更您的登入密碼或刪除帳號。此操作將影響您在系統中的登入權限，請謹慎操作。</p>
            <div class="space-y-8">
              <!-- 變更密碼區塊 -->
              <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">變更密碼</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div>
                    <label for="changeCurrentPassword" class="block text-sm font-medium text-gray-700 mb-1">當前密碼</label>
                    <input type="password" id="changeCurrentPassword" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請輸入當前密碼">
                  </div>
                  <div>
                    <label for="changeNewPassword" class="block text-sm font-medium text-gray-700 mb-1">新密碼</label>
                    <input type="password" id="changeNewPassword" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請輸入新密碼">
                  </div>
                  <div>
                    <label for="changeConfirmPassword" class="block text-sm font-medium text-gray-700 mb-1">確認新密碼</label>
                    <input type="password" id="changeConfirmPassword" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請再次輸入新密碼">
                  </div>
                </div>
                <div class="mt-4 flex justify-end">
                  <!-- 為更新密碼按鈕增加 id，以便 JavaScript 能準確找到此元素並顯示讀取圈 -->
                  <button id="updatePasswordButton" onclick="changeCurrentUserPassword()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200">更新密碼</button>
                </div>
              </div>
              <!-- 刪除帳號區塊 -->
              <div class="bg-red-50 rounded-lg p-6">
                <h3 class="text-lg font-semibold text-red-800 mb-4">刪除帳號</h3>
                <p class="text-sm text-red-700 mb-4">刪除帳號後，您將無法再登入系統，且所有與此帳號相關的資料將無法恢復。請慎重操作！</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label for="deleteAccountPassword" class="block text-sm font-medium text-gray-700 mb-1">密碼確認</label>
                    <input type="password" id="deleteAccountPassword" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-red-500 focus:border-transparent" placeholder="請輸入您的密碼">
                  </div>
                </div>
                <div class="mt-4 flex justify-end">
                  <!-- 為刪除帳號按鈕增加 id，以便 JavaScript 能準確找到此元素並顯示讀取圈 -->
                  <button id="deleteAccountButton" onclick="deleteCurrentUserAccount()" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg transition duration-200">刪除帳號</button>
                </div>
              </div>
            </div>
            </div>
          </div>
        </div>

        <!-- 模板庫區：在外層加入與其他頁面一致的寬度與內邊距容器，卡片樣式位於內層 -->
        <!-- 模板庫區：包裝在與其他頁面相同的寬度限制與內外邊距容器中，使版面保持一致 -->
        <div id="templateLibrary" class="hidden max-w-7xl mx-auto px-4 py-6">
          <div class="bg-white rounded-xl shadow-lg p-6">
            <!-- 移除內層多餘的背景框，避免重複包裹 -->
            <div>
            <h2 class="text-2xl font-bold text-amber-800 mb-6 flex items-center">
              <span class="text-3xl mr-3">📚</span>
              模板庫
            </h2>
            
            <!-- 標籤切換：診斷模板與醫囑模板位置互換 -->
            <div class="mb-6">
              <div class="flex border-b border-gray-200">
                <!-- 將診斷模板放在前面，並預設為啟用狀態 -->
                <button class="px-6 py-3 text-amber-700 border-b-2 border-amber-500 font-medium"
                        onclick="switchTemplateTab('diagnosis')" id="diagnosisTab">
                  🔍 診斷模板
                  <!-- 動態顯示診斷模板數量 -->
                  <span id="diagnosisCount" class="ml-2 text-xs font-semibold bg-orange-100 text-orange-700 rounded-full px-2 py-0.5"></span>
                </button>
                <button class="px-6 py-3 text-gray-500 hover:text-amber-700 font-medium"
                        onclick="switchTemplateTab('prescriptions')" id="prescriptionsTab">
                  📋 醫囑模板
                  <!-- 動態顯示醫囑模板數量 -->
                  <span id="prescriptionCount" class="ml-2 text-xs font-semibold bg-purple-100 text-purple-700 rounded-full px-2 py-0.5"></span>
                </button>
              </div>
            </div>

            <!-- 診斷模板內容放在前面 -->
            <div id="diagnosisContent" class="template-tab-content">
              <div class="mb-6 space-y-4">
                <div class="flex gap-4 flex-wrap">
                </div>
                <div class="flex gap-4 flex-wrap">
                  <!-- 搜尋診斷模板名稱 -->
                  <input type="text" id="diagnosisTemplateSearch" placeholder="搜尋診斷模板名稱或內容..." class="px-4 py-2 border-2 border-orange-200 rounded-lg focus:border-orange-400 focus:outline-none flex-1 min-w-64">
                  <!-- 診斷科別篩選 -->
                  <select id="diagnosisTemplateCategoryFilter" class="px-4 py-2 border-2 border-orange-200 rounded-lg focus:border-orange-400 focus:outline-none">
                    <!-- 為了避免顯示已儲存的分類，此下拉選單僅提供整體科別篩選選項 -->
                    <option>全部科別</option>
                  </select>
                </div>
              </div>
              <div class="space-y-4" id="diagnosisTemplatesContainer">
                <!-- 動態載入診斷模板 -->
              </div>
            </div>

            <!-- 醫囑模板內容放在後面，預設隱藏 -->
            <div id="prescriptionsContent" class="template-tab-content hidden">
              <div class="mb-6 space-y-4">
                <div class="flex gap-4 flex-wrap">
                </div>
                <div class="flex gap-4 flex-wrap">
                  <!-- 搜尋醫囑模板名稱 -->
                  <input type="text" id="prescriptionTemplateSearch" placeholder="搜尋醫囑模板名稱..." class="px-4 py-2 border-2 border-purple-200 rounded-lg focus:border-purple-400 focus:outline-none flex-1 min-w-64">
                  <!-- 醫囑分類篩選 -->
                  <select id="prescriptionTemplateCategoryFilter" class="px-4 py-2 border-2 border-purple-200 rounded-lg focus:border-purple-400 focus:outline-none">
                    <!-- 為了避免顯示已儲存的分類，此下拉選單僅提供整體類別篩選選項 -->
                    <option>全部類別</option>
                  </select>
                </div>
              </div>
              <div class="space-y-4" id="prescriptionTemplatesContainer">
                <!-- 動態載入醫囑模板 -->
              </div>
            </div>
          </div>
        </div>

        <!-- 分類管理彈窗 -->
        <div id="categoryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
          <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
              <h3 class="text-xl font-bold text-gray-800" id="categoryModalTitle">管理分類</h3>
              <button onclick="hideCategoryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div class="mb-6">
              <label class="block text-gray-700 font-medium mb-2">新增分類</label>
              <div class="flex gap-2">
                <!-- 將分類名稱欄位寬度縮短為一半，避免過長 -->
                <input type="text" id="newCategoryInput" placeholder="輸入分類名稱..." class="w-1/2 px-3 py-2 border border-gray-300 rounded-lg focus:border-blue-400 focus:outline-none">
                <button onclick="addCategory()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                  新增
                </button>
              </div>
            </div>
            
            <div>
              <label class="block text-gray-700 font-medium mb-2">現有分類</label>
              <div id="categoryList" class="space-y-2 max-h-64 overflow-y-auto">
                <!-- 分類列表將在這裡動態生成 -->
              </div>
            </div>
            
            <div class="mt-6 flex justify-end">
              <button onclick="hideCategoryModal()" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                關閉
              </button>
            </div>
          </div>
        </div>

        <!-- 編輯彈窗 -->
        <div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
          <div class="bg-white rounded-xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
              <h3 class="text-xl font-bold text-gray-800" id="editModalTitle">編輯組合</h3>
              <button onclick="hideEditModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div id="editModalContent">
              <!-- 編輯內容將在這裡動態生成 -->
            </div>
            
            <div class="mt-6 flex justify-end gap-4">
              <button onclick="hideEditModal()" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                取消
              </button>
              <button onclick="saveEdit()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                保存
              </button>
            </div>
          </div>
        </div>

        <!--
            以下為常用藥方和穴位組合選擇彈窗。這兩個彈窗在診症頁面中
            讓醫師快速載入個人慣用的中藥方或針灸穴位組合。彈窗
            預設為隱藏(hidden)，當使用者點擊對應的按鈕時會透過
            JavaScript 函式 showHerbComboModal() 或 showAcupointComboModal()
            顯示。內部的列表內容會由系統.js 動態渲染。
        -->

        <!-- 排班管理區：以 iframe 方式載入排班系統 -->
        <div id="scheduleManagement" class="hidden max-w-7xl mx-auto px-4 py-6">
          <div class="bg-white rounded-xl shadow-lg p-6">
            <h2 class="text-2xl font-bold text-amber-800 mb-6 flex items-center">
              <span class="text-3xl mr-3">📅</span>排班管理
            </h2>
            <!-- 使用 iframe 的 srcdoc 注入排班系統內容 -->
            <iframe id="scheduleIframe" class="w-full" style="height: calc(100vh - 16rem);" loading="lazy"></iframe>
          </div>
        </div>

        <!-- 排班系統的 base64 內容解碼及載入 -->
        <script>
        // 將排班系統 HTML 分段 base64 字串組合於陣列，避免單行過長
        window.scheduleHtmlB64Parts = [
            'PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJ6aC1UVyI+DQo8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+DQogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPg0KICAgIDx0aXRsZT7pgLLpmo7phqvnmYLmjpLnj63nrqHnkIbns7vntbE8L3RpdGxlPg0KICAgIDxzdHlsZT4NCiAgICAgICAgYm9keSB7DQogICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdTZWdvZSBVSScsIFRhaG9tYSwgR2VuZXZhLCBWZXJkYW5hLCBzYW5zLXNlcmlmOw0KICAgICAgICAgICAgbWFyZ2luOiAwOw0KICAgICAgICAgICAgcGFkZGluZzogMDsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICM2NjdlZWEgMCUsICM3NjRiYTIgMTAwJSk7DQogICAgICAgICAgICBtaW4taGVpZ2h0OiAxMDB2aDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5jb250YWluZXIgew0KICAgICAgICAgICAgbWF4LXdpZHRoOiAxNDAwcHg7DQogICAgICAgICAgICBtYXJnaW46IDAgYXV0bzsNCiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHg7DQogICAgICAgIH0NCg0KICAgICAgICAuaGVhZGVyIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlOw0KICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTVweDsNCiAgICAgICAgICAgIHBhZGRpbmc6IDI1cHg7DQogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDMwcHggcmdiYSgwLDAsMCwwLjEpOw0KICAgICAgICB9DQoNCiAgICAgICAgLmhlYWRlciBoMSB7DQogICAgICAgICAgICBtYXJnaW46IDAgMCAyMHB4IDA7DQogICAgICAgICAgICBjb2xvcjogIzJkMzc0ODsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjhweDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7DQogICAgICAgIH0NCg0KDQoNCiAgICAgICAgLmZpbHRlci1wYW5lbCB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgICAgICAgICBwYWRkaW5nOiAyMHB4Ow0KICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNXB4IDE1cHggcmdiYSgwLDAsMCwwLjEpOw0KICAgICAgICB9DQoNCiAgICAgICAgLmZpbHRlci1ncmlkIHsNCiAgICAgICAgICAgIGRpc3BsYXk6IGdyaWQ7DQogICAgICAgICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdChhdXRvLWZpdCwgbWlubWF4KDIwMHB4LCAxZnIpKTsNCiAgICAgICAgICAgIGdhcDogMTVweDsNCiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBlbmQ7DQogICAgICAgIH0NCg0KICAgICAgICAuZmlsdGVyLWdyb3VwIHsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgICAgICAgZ2FwOiA1cHg7DQogICAgICAgIH0NCg0KICAgICAgICAuZmlsdGVyLWxhYmVsIHsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgICAgICAgICBjb2xvcjogIzRhNTU2ODsNCiAgICAgICAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7DQogICAgICAgICAgICBsZXR0ZXItc3BhY2luZzogMC41cHg7DQogICAgICAgIH0NCg0KICAgICAgICAuZmlsdGVyLXNlbGVjdCwgLmZpbHRlci1pbnB1dCB7DQogICAgICAgICAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkICNlMmU4ZjA7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgICAgICAgICBmb250LXNpemU6IDE0cHg7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiBib3JkZXItY29sb3IgMC4zcyBlYXNlOw0KICAgICAgICB9DQoNCiAgICAgICAgLmZpbHRlci1zZWxlY3Q6Zm9jdXMsIC5maWx0ZXItaW5wdXQ6Zm9jdXMgew0KICAgICAgICAgICAgb3V0bGluZTogbm9uZTsNCiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzQyOTllMTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5xdWljay1hY3Rpb25zIHsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBnYXA6IDEwcHg7DQogICAgICAgICAgICBmbGV4LXdyYXA6IHdyYXA7DQogICAgICAgIH0NCg0KICAgICAgICAucXVpY2stYnRuIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICM0Mjk5ZTE7DQogICAgICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgICAgICBib3JkZXI6IG5vbmU7DQogICAgICAgICAgICBwYWRkaW5nOiA4cHggMTZweDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KICAgICAgICB9DQoNCiAgICAgICAgLnF1aWNrLWJ0bjpob3ZlciB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMzE4MmNlOw0KICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOw0KICAgICAgICB9DQoNCiAgICAgICAgLnF1aWNrLWJ0bi5kYW5nZXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2Y1NjU2NTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5xdWljay1idG4uZGFuZ2VyOmhvdmVyIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNlNTNlM2U7DQogICAgICAgIH0NCg0KICAgICAgICAucXVpY2stYnRuLnN1Y2Nlc3Mgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogIzQ4YmI3ODsNCiAgICAgICAgfQ0KDQogICAgICAgIC5xdWljay1idG4uc3VjY2Vzczpob3ZlciB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMzhhMTY5Ow0KICAgICAgICB9DQpg',
            'Cg=='
        ];
        document.addEventListener('DOMContentLoaded', () => {
            const iframe = document.getElementById('scheduleIframe');
            if (!iframe) return;
            const html = atob(window.scheduleHtmlB64Parts.join(''));
            iframe.srcdoc = html;
            iframe.addEventListener('load', async () => {
                try {
                    if (typeof window.getScheduleStaffList === 'function') {
                        const staffList = await window.getScheduleStaffList();
                        const cw = iframe.contentWindow;
                        if (cw && Array.isArray(staffList)) {
                            cw.staff = staffList.map((u, idx) => ({
                                id: u.id || (idx + 1),
                                name: u.name || '',
                                role: u.role || (u.position === '醫師' ? 'doctor' : (u.position === '護理師' ? 'nurse' : 'staff')),
                                department: u.department || '',
                                level: u.level || '',
                                phone: u.phone || '',
                                email: u.email || '',
                                maxHours: u.maxHours || 40,
                                position: u.position
                            }));
                            if (typeof cw.renderStaffPanel === 'function') {
                                cw.renderStaffPanel();
                            }
                            if (typeof cw.updateStaffSelects === 'function') {
                                cw.updateStaffSelects();
                            }
                        }
                    }
                } catch (e) {
                    console.error('載入排班人員資料錯誤', e);
                }
            });
        });
        </script>
        <script>
        // 將完整排班系統 HTML 資料覆蓋至 scheduleHtmlB64Parts 並重新載入 iframe
        (function() {
          const parts = [
            'PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJ6aC1UVyI+DQo8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+DQogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPg0KICAgIDx0aXRsZT7pgLLpmo7phqvnmYLmjpLnj63nrqHnkIbns7vntbE8L3RpdGxlPg0KICAgIDxzdHlsZT4NCiAgICAgICAgYm9keSB7DQogICAgICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdTZWdvZSBVSScsIFRhaG9tYSwgR2VuZXZhLCBWZXJkYW5hLCBzYW5zLXNlcmlmOw0KICAgICAgICAgICAgbWFyZ2luOiAwOw0KICAgICAgICAgICAgcGFkZGluZzogMDsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICM2NjdlZWEgMCUsICM3NjRiYTIgMTAwJSk7DQogICAgICAgICAgICBtaW4taGVpZ2h0OiAxMDB2aDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5jb250YWluZXIgew0KICAgICAgICAgICAgbWF4LXdpZHRoOiAxNDAwcHg7DQogICAgICAgICAgICBtYXJnaW46IDAgYXV0bzsNCiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHg7DQogICAgICAgIH0NCg0KICAgICAgICAuaGVhZGVyIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlOw0KICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTVweDsNCiAgICAgICAgICAgIHBhZGRpbmc6IDI1cHg7DQogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDMwcHggcmdiYSgwLDAsMCwwLjEpOw0KICAgICAgICB9DQoNCiAgICAgICAgLmhlYWRlciBoMSB7DQogICAgICAgICAgICBtYXJnaW46IDAgMCAyMHB4IDA7DQogICAgICAgICAgICBjb2xvcjogIzJkMzc0ODsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjhweDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7DQogICAgICAgIH0NCg0KDQoNCiAgICAgICAgLmZpbHRlci1wYW5lbCB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7DQogICAgICAgICAgICBwYWRkaW5nOiAyMHB4Ow0KICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNXB4IDE1cHggcmdiYSgwLDAsMCwwLjEpOw0KICAgICAgICB9DQoNCiAgICAgICAgLmZpbHRlci1ncmlkIHsNCiAgICAgICAgICAgIGRpc3BsYXk6IGdyaWQ7DQogICAgICAgICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdChhdXRvLWZpdCwgbWlubWF4KDIwMHB4LCAxZnIpKTsNCiAgICAgICAgICAgIGdhcDogMTVweDsNCiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBlbmQ7DQogICAgICAgIH0NCg0KICAgICAgICAuZmlsdGVyLWdyb3VwIHsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgICAgICAgZ2FwOiA1cHg7DQogICAgICAgIH0NCg0KICAgICAgICAuZmlsdGVyLWxhYmVsIHsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgICAgICAgICBjb2xvcjogIzRhNTU2ODsNCiAgICAgICAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7DQogICAgICAgICAgICBsZXR0ZXItc3BhY2luZzogMC41cHg7DQogICAgICAgIH0NCg0KICAgICAgICAuZmlsdGVyLXNlbGVjdCwgLmZpbHRlci1pbnB1dCB7DQogICAgICAgICAgICBwYWRkaW5nOiA4cHggMTJweDsNCiAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkICNlMmU4ZjA7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgICAgICAgICBmb250LXNpemU6IDE0cHg7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiBib3JkZXItY29sb3IgMC4zcyBlYXNlOw0KICAgICAgICB9DQoNCiAgICAgICAgLmZpbHRlci1zZWxlY3Q6Zm9jdXMsIC5maWx0ZXItaW5wdXQ6Zm9jdXMgew0KICAgICAgICAgICAgb3V0bGluZTogbm9uZTsNCiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogIzQyOTllMTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5xdWljay1hY3Rpb25zIHsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBnYXA6IDEwcHg7DQogICAgICAgICAgICBmbGV4LXdyYXA6IHdyYXA7DQogICAgICAgIH0NCg0KICAgICAgICAucXVpY2stYnRuIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICM0Mjk5ZTE7DQogICAgICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgICAgICBib3JkZXI6IG5vbmU7DQogICAgICAgICAgICBwYWRkaW5nOiA4cHggMTZweDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KICAgICAgICB9DQoNCiAgICAgICAgLnF1aWNrLWJ0bjpob3ZlciB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMzE4MmNlOw0KICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0xcHgpOw0KICAgICAgICB9DQoNCiAgICAgICAgLnF1aWNrLWJ0bi5kYW5nZXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2Y1NjU2NTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5xdWljay1idG4uZGFuZ2VyOmhvdmVyIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNlNTNlM2U7DQogICAgICAgIH0NCg0KICAgICAgICAucXVpY2stYnRuLnN1Y2Nlc3Mgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogIzQ4YmI3ODsNCiAgICAgICAgfQ0KDQogICAgICAgIC5xdWljay1idG4uc3VjY2Vzczpob3ZlciB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMzhhMTY5Ow0KICAgICAgICB9DQoNCiAgICAgICAgLmNvbnRyb2xzIHsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwOw0KICAgICAgICAgICAgZ2FwOiAxNXB4Ow0KICAgICAgICB9DQoNCiAgICAgICAgLm5hdi1jb250cm9scyB7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgICAgIGdhcDogMTVweDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5uYXYtYnRuIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICM0Mjk5ZTE7DQogICAgICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgICAgICBib3JkZXI6IG5vbmU7DQogICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDE1cHg7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgICAgICBmb250LXdlaWdodDogNjAwOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5uYXYtYnRuOmhvdmVyIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMzMTgyY2U7DQogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCk7DQogICAgICAgIH0NCg0KICAgICAgICAuY3VycmVudC1kYXRlIHsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjBweDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7DQogICAgICAgICAgICBjb2xvcjogIzJkMzc0ODsNCiAgICAgICAgICAgIG1hcmdpbjogMCAyMHB4Ow0KICAgICAgICB9DQoNCiAgICAgICAgLnZpZXctY29udHJvbHMgew0KICAgICAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgICAgIGdhcDogMTBweDsNCiAgICAgICAgfQ0KDQogICAgICAgIC52aWV3LWJ0biB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZTJlOGYwOw0KICAgICAgICAgICAgY29sb3I6ICM0YTU1Njg7DQogICAgICAgICAgICBib3JkZXI6IG5vbmU7DQogICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDIwcHg7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgICAgICBmb250LXdlaWdodDogNjAwOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC52aWV3LWJ0bi5hY3RpdmUgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogIzQ4YmI3ODsNCiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC52aWV3LWJ0bjpob3ZlciB7DQogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCk7DQogICAgICAgIH0NCg0KICAgICAgICAuc3luYy1jb250cm9scyB7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgZ2FwOiAxMHB4Ow0KICAgICAgICB9DQoNCiAgICAgICAgLnN5bmMtYnRuIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICM4MDVhZDU7DQogICAgICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgICAgICBib3JkZXI6IG5vbmU7DQogICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDE1cHg7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgICAgICBmb250LXdlaWdodDogNjAwOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAgICAgZ2FwOiA1cHg7DQogICAgICAgIH0NCg0KICAgICAgICAuc3luYy1idG46aG92ZXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogIzZiNDZjMTsNCiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMnB4KTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5jYWxlbmRhci1jb250YWluZXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxNXB4Ow0KICAgICAgICAgICAgcGFkZGluZzogMjVweDsNCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAzMHB4IHJnYmEoMCwwLDAsMC4xKTsNCiAgICAgICAgICAgIG1pbi1oZWlnaHQ6IDYwMHB4Ow0KICAgICAgICB9DQoNCiAgICAgICAgLmNhbGVuZGFyLWdyaWQgew0KICAgICAgICAgICAgZGlzcGxheTogZ3JpZDsNCiAgICAgICAgICAgIGdhcDogMXB4Ow0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2UyZThmMDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7DQogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgICAgICB9DQoNCiAgICAgICAgLm1vbnRoLXZpZXcgew0KICAgICAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoNywgMWZyKTsNCiAgICAgICAgICAgIGdyaWQtdGVtcGxhdGUtcm93czogYXV0byByZXBlYXQoNiwgMWZyKTsNCiAgICAgICAgfQ0KDQoNCg0KDQoNCiAgICAgICAgLmNhbGVuZGFyLWhlYWRlciB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjNGE1NTY4Ow0KICAgICAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICAgICAgcGFkZGluZzogMTVweDsNCiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA3MDA7DQogICAgICAgICAgICBmb250LXNpemU6IDE0cHg7DQogICAgICAgIH0NCg0KICAgICAgICAudGltZS1zbG90IHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmN2ZhZmM7DQogICAgICAgICAgICBwYWRkaW5nOiA4cHg7DQogICAgICAgICAgICBmb250LXNpemU6IDEycHg7DQogICAgICAgICAgICBjb2xvcjogIzcxODA5NjsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgICAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjZTJlOGYwOw0KICAgICAgICB9DQoNCiAgICAgICAgLmNhbGVuZGFyLWNlbGwgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7DQogICAgICAgICAgICBwYWRkaW5nOiA4cHg7DQogICAgICAgICAgICBtaW4taGVpZ2h0OiA4MHB4Ow0KICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTsNCiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgICAgIH0NCg0KICAgICAgICAuY2FsZW5kYXItY2VsbDpob3ZlciB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZjBmZmY0Ow0KICAgICAgICB9DQoNCiAgICAgICAgLmNhbGVuZGFyLWNlbGwub3RoZXItbW9udGggew0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2Y4ZjlmYTsNCiAgICAgICAgICAgIGNvbG9yOiAjYWRiNWJkOw0KICAgICAgICB9DQoNCiAgICAgICAgLmNhbGVuZGFyLWNlbGwudG9kYXkgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2U2ZmZmYTsNCiAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkICMzOGIyYWM7DQogICAgICAgIH0NCg0KICAgICAgICAuZGF5LW51bWJlciB7DQogICAgICAgICAgICBmb250LXdlaWdodDogNzAwOw0KICAgICAgICAgICAgY29sb3I6ICMyZDM3NDg7DQogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiA1cHg7DQogICAgICAgIH0NCg0KICAgICAgICAuc2hpZnQtaXRlbSB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNDI5OWUxLCAjMzE4MmNlKTsNCiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgICAgIHBhZGRpbmc6IDRweCA2cHg7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgICAgICAgICBmb250LXNpemU6IDEwcHg7DQogICAgICAgICAgICBtYXJnaW46IDFweCAwOw0KICAgICAgICAgICAgY3Vyc29yOiBtb3ZlOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgICAgICAgICBib3JkZXItbGVmdDogM3B4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4zKTsNCiAgICAgICAgICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCiAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjI7DQogICAgICAgIH0NCg0KICAgICAgICAuc2hpZnQtaXRlbTpob3ZlciB7DQogICAgICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMDUpOw0KICAgICAgICAgICAgYm94LXNoYWRvdzogMCA2cHggMjBweCByZ2JhKDAsMCwwLDAuMjUpOw0KICAgICAgICB9DQoNCiAgICAgICAgLnNoaWZ0LWl0ZW0uZG9jdG9yIHsNCiAgICAgICAgICAg',
            'IGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICM0OGJiNzgsICMzOGExNjkpOw0KICAgICAgICB9DQoNCiAgICAgICAgLnNoaWZ0LWl0ZW0ubnVyc2Ugew0KICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2VkODkzNiwgI2RkNmIyMCk7DQogICAgICAgIH0NCg0KICAgICAgICAuc2hpZnQtaXRlbS5lbWVyZ2VuY3kgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2Y1NjU2NSwgI2U1M2UzZSk7DQogICAgICAgICAgICBhbmltYXRpb246IHB1bHNlIDJzIGluZmluaXRlOw0KICAgICAgICB9DQoNCiAgICAgICAgLnNoaWZ0LWl0ZW0ub3ZlcnRpbWUgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzlmN2FlYSwgIzgwNWFkNSk7DQogICAgICAgICAgICBib3JkZXItbGVmdC1jb2xvcjogI2ZmZDcwMDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zaGlmdC1pdGVtLmRyYWdnaW5nIHsNCiAgICAgICAgICAgIG9wYWNpdHk6IDAuNzsNCiAgICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDVkZWcpIHNjYWxlKDEuMSk7DQogICAgICAgICAgICB6LWluZGV4OiAxMDAwOw0KICAgICAgICB9DQoNCiAgICAgICAgLnNoaWZ0LWl0ZW0gLnNoaWZ0LWhlYWRlciB7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDJweDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zaGlmdC1pdGVtIC5zaGlmdC1uYW1lIHsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgICAgICAgICBmb250LXNpemU6IDEwcHg7DQogICAgICAgIH0NCg0KICAgICAgICAuc2hpZnQtaXRlbSAuc2hpZnQtYWN0aW9ucyB7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgZ2FwOiAycHg7DQogICAgICAgICAgICBvcGFjaXR5OiAwOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzIGVhc2U7DQogICAgICAgIH0NCg0KICAgICAgICAuc2hpZnQtaXRlbTpob3ZlciAuc2hpZnQtYWN0aW9ucyB7DQogICAgICAgICAgICBvcGFjaXR5OiAxOw0KICAgICAgICB9DQoNCiAgICAgICAgLnNoaWZ0LWFjdGlvbi1idG4gew0KICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwwLjIpOw0KICAgICAgICAgICAgYm9yZGVyOiBub25lOw0KICAgICAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICAgICAgd2lkdGg6IDE2cHg7DQogICAgICAgICAgICBoZWlnaHQ6IDE2cHg7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAzcHg7DQogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgICAgICBmb250LXNpemU6IDEwcHg7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgICB9DQoNCiAgICAgICAgLnNoaWZ0LWFjdGlvbi1idG46aG92ZXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwwLjMpOw0KICAgICAgICB9DQoNCiAgICAgICAgLnNoaWZ0LWRldGFpbHMgew0KICAgICAgICAgICAgZm9udC1zaXplOiA4cHg7DQogICAgICAgICAgICBvcGFjaXR5OiAwLjk7DQogICAgICAgICAgICBsaW5lLWhlaWdodDogMS4xOw0KICAgICAgICB9DQoNCiAgICAgICAgQGtleWZyYW1lcyBwdWxzZSB7DQogICAgICAgICAgICAwJSwgMTAwJSB7IG9wYWNpdHk6IDE7IH0NCiAgICAgICAgICAgIDUwJSB7IG9wYWNpdHk6IDAuNzsgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLmRyb3Atem9uZSB7DQogICAgICAgICAgICBib3JkZXI6IDJweCBkYXNoZWQgIzQyOTllMTsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoNjYsIDE1MywgMjI1LCAwLjEpOw0KICAgICAgICB9DQoNCiAgICAgICAgLnN0YWZmLXBhbmVsIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlOw0KICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTVweDsNCiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHg7DQogICAgICAgICAgICBtYXJnaW4tdG9wOiAyMHB4Ow0KICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDMwcHggcmdiYSgwLDAsMCwwLjEpOw0KICAgICAgICAgICAgcG9zaXRpb246IHN0aWNreTsNCiAgICAgICAgICAgIHRvcDogMjBweDsNCiAgICAgICAgICAgIHotaW5kZXg6IDEwMDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zdGFmZi1wYW5lbCBoMyB7DQogICAgICAgICAgICBtYXJnaW46IDAgMCAxNXB4IDA7DQogICAgICAgICAgICBjb2xvcjogIzJkMzc0ODsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMThweDsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAgICAgZ2FwOiAxMHB4Ow0KICAgICAgICB9DQoNCiAgICAgICAgLnN0YWZmLWdyaWQgew0KICAgICAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgICAgIGZsZXgtd3JhcDogd3JhcDsNCiAgICAgICAgICAgIGdhcDogMTBweDsNCiAgICAgICAgICAgIG1hcmdpbi10b3A6IDE1cHg7DQogICAgICAgIH0NCg0KICAgICAgICAuc3RhZmYtY2FyZCB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZjdmYWZjLCAjZWRmMmY3KTsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICAgICAgICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgdHJhbnNwYXJlbnQ7DQogICAgICAgICAgICBjdXJzb3I6IGdyYWI7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KICAgICAgICAgICAgbWluLXdpZHRoOiA4MHB4Ow0KICAgICAgICAgICAgbWF4LXdpZHRoOiAxMjBweDsNCiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgICAgICAgICB1c2VyLXNlbGVjdDogbm9uZTsNCiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zdGFmZi1jYXJkOmhvdmVyIHsNCiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtM3B4KTsNCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgOHB4IDI1cHggcmdiYSgwLDAsMCwwLjE1KTsNCiAgICAgICAgICAgIGJvcmRlci1jb2xvcjogcmdiYSg2NiwgMTUzLCAyMjUsIDAuMyk7DQogICAgICAgIH0NCg0KICAgICAgICAuc3RhZmYtY2FyZDphY3RpdmUgew0KICAgICAgICAgICAgY3Vyc29yOiBncmFiYmluZzsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zdGFmZi1jYXJkLmRyYWdnaW5nIHsNCiAgICAgICAgICAgIG9wYWNpdHk6IDAuODsNCiAgICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDVkZWcpIHNjYWxlKDEuMDUpOw0KICAgICAgICAgICAgei1pbmRleDogMTAwMDsNCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMTVweCAzNXB4IHJnYmEoMCwwLDAsMC4zKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zdGFmZi1jYXJkLmRvY3RvciB7DQogICAgICAgICAgICBib3JkZXItbGVmdDogNHB4IHNvbGlkICM0OGJiNzg7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZjBmZmY0LCAjZTZmZmZhKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zdGFmZi1jYXJkLmRvY3Rvcjpob3ZlciB7DQogICAgICAgICAgICBib3JkZXItY29sb3I6ICM0OGJiNzg7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjZTZmZmZhLCAjYzZmNmQ1KTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zdGFmZi1jYXJkLm51cnNlIHsNCiAgICAgICAgICAgIGJvcmRlci1sZWZ0OiA0cHggc29saWQgI2VkODkzNjsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgxMzVkZWcsICNmZmZhZjAsICNmZWY1ZTcpOw0KICAgICAgICB9DQoNCiAgICAgICAgLnN0YWZmLWNhcmQubnVyc2U6aG92ZXIgew0KICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiAjZWQ4OTM2Ow0KICAgICAgICAgICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgI2ZlZjVlNywgI2ZlZDdhYSk7DQogICAgICAgIH0NCg0KDQoNCiAgICAgICAgLnN0YWZmLW5hbWUgew0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICAgICAgICAgIGNvbG9yOiAjMmQzNzQ4Ow0KICAgICAgICAgICAgZm9udC1zaXplOiAxM3B4Ow0KICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNHB4Ow0KICAgICAgICB9DQoNCiAgICAgICAgLnN0YWZmLXN0YXR1cyB7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAgICAgZ2FwOiAycHg7DQogICAgICAgICAgICBmb250LXNpemU6IDlweDsNCiAgICAgICAgICAgIGNvbG9yOiAjNjhkMzkxOw0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zdGFmZi1zdGF0dXMuYnVzeSB7DQogICAgICAgICAgICBjb2xvcjogI2Y1NjU2NTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zdGFmZi1zdGF0dXMucGFydGlhbCB7DQogICAgICAgICAgICBjb2xvcjogI2VkODkzNjsNCiAgICAgICAgfQ0KDQogICAgICAgIC5kcmFnLWhpbnQgew0KICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgICAgICAgICAgYm90dG9tOiAycHg7DQogICAgICAgICAgICByaWdodDogNHB4Ow0KICAgICAgICAgICAgZm9udC1zaXplOiAxMHB4Ow0KICAgICAgICAgICAgY29sb3I6ICNjYmQ1ZTA7DQogICAgICAgICAgICBvcGFjaXR5OiAwOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjNzIGVhc2U7DQogICAgICAgIH0NCg0KICAgICAgICAuc3RhZmYtY2FyZDpob3ZlciAuZHJhZy1oaW50IHsNCiAgICAgICAgICAgIG9wYWNpdHk6IDE7DQogICAgICAgIH0NCg0KDQoNCiAgICAgICAgLnN0YWZmLWZpbHRlciB7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgZ2FwOiA4cHg7DQogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwOw0KICAgICAgICB9DQoNCiAgICAgICAgLnN0YWZmLWZpbHRlci1idG4gew0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2UyZThmMDsNCiAgICAgICAgICAgIGJvcmRlcjogbm9uZTsNCiAgICAgICAgICAgIGNvbG9yOiAjNGE1NTY4Ow0KICAgICAgICAgICAgcGFkZGluZzogNnB4IDEycHg7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAyMHB4Ow0KICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICAgICAgZm9udC1zaXplOiAxMXB4Ow0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQogICAgICAgIH0NCg0KICAgICAgICAuc3RhZmYtZmlsdGVyLWJ0bi5hY3RpdmUgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogIzQyOTllMTsNCiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zdGFmZi1maWx0ZXItYnRuOmhvdmVyIHsNCiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMXB4KTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5kcm9wLXRhcmdldCB7DQogICAgICAgICAgICBib3JkZXI6IDJweCBkYXNoZWQgIzQyOTllMSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSg2NiwgMTUzLCAyMjUsIDAuMSkgIWltcG9ydGFudDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5kcm9wLXRhcmdldDo6YWZ0ZXIgew0KICAgICAgICAgICAgY29udGVudDogJ+aUvumWi+S7peaWsOWinuaOkuePrSc7DQogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICAgICAgICB0b3A6IDUwJTsNCiAgICAgICAgICAgIGxlZnQ6IDUwJTsNCiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpOw0KICAgICAgICAgICAgYmFja2dyb3VuZDogIzQyOTllMTsNCiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgICAgIHBhZGRpbmc6IDRweCA4cHg7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgICAgICAgICBmb250LXNpemU6IDEwcHg7DQogICAgICAgICAgICBmb250LXdlaWdodDogNjAwOw0KICAgICAgICAgICAgcG9pbnRlci1ldmVudHM6IG5vbmU7DQogICAgICAgICAgICB6LWluZGV4OiAxMDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5tb2RhbCB7DQogICAgICAgICAgICBkaXNwbGF5OiBub25lOw0KICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICAgICAgdG9wOiAwOw0KICAgICAgICAgICAgbGVmdDogMDsNCiAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwwLjUpOw0KICAgICAgICAgICAgei1pbmRleDogMTAwMDsNCiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgfQ0KDQogICAgICAgIC5tb2RhbC5zaG93IHsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgIH0NCg0KICAgICAgICAubW9kYWwtY29udGVudCB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7DQogICAgICAgICAgICBwYWRkaW5nOiAzMHB4Ow0KICAgICAgICAgICAgbWF4LXdpZHRoOiA1MDBweDsNCiAgICAgICAgICAgIHdpZHRoOiA5MCU7DQogICAgICAgICAgICBtYXgtaGVpZ2h0OiA4MHZoOw0KICAgICAgICAgICAgb3ZlcmZsb3cteTogYXV0bzsNCiAgICAgICAgfQ0KDQogICAgICAgIC5mb3JtLWdyb3VwIHsNCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7DQogICAgICAgIH0NCg0KICAgICAgICAuZm9ybS1sYWJlbCB7DQogICAgICAgICAgICBkaXNwbGF5OiBibG9jazsNCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDhweDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgICAgICAgICBjb2xvcjogIzJkMzc0ODsNCiAgICAgICAgfQ0KDQogICAgICAgIC5mb3JtLWlucHV0LCAuZm9ybS1zZWxlY3Qgew0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBwYWRkaW5nOiAxMnB4Ow0KICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgI2UyZThmMDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICAgICAgICAgIGZvbnQt',
            'c2l6ZTogMTRweDsNCiAgICAgICAgICAgIHRyYW5zaXRpb246IGJvcmRlci1jb2xvciAwLjNzIGVhc2U7DQogICAgICAgIH0NCg0KICAgICAgICAuZm9ybS1pbnB1dDpmb2N1cywgLmZvcm0tc2VsZWN0OmZvY3VzIHsNCiAgICAgICAgICAgIG91dGxpbmU6IG5vbmU7DQogICAgICAgICAgICBib3JkZXItY29sb3I6ICM0Mjk5ZTE7DQogICAgICAgIH0NCg0KICAgICAgICAuZm9ybS1idXR0b25zIHsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBnYXA6IDEwcHg7DQogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kOw0KICAgICAgICAgICAgbWFyZ2luLXRvcDogMjVweDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5idG4gew0KICAgICAgICAgICAgcGFkZGluZzogMTJweCAyNHB4Ow0KICAgICAgICAgICAgYm9yZGVyOiBub25lOw0KICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7DQogICAgICAgIH0NCg0KICAgICAgICAuYnRuLXByaW1hcnkgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogIzQyOTllMTsNCiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5idG4tcHJpbWFyeTpob3ZlciB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMzE4MmNlOw0KICAgICAgICB9DQoNCiAgICAgICAgLmJ0bi1zZWNvbmRhcnkgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2UyZThmMDsNCiAgICAgICAgICAgIGNvbG9yOiAjNGE1NTY4Ow0KICAgICAgICB9DQoNCiAgICAgICAgLmJ0bi1zZWNvbmRhcnk6aG92ZXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2NiZDVlMDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5ub3RpZmljYXRpb24gew0KICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICAgICAgdG9wOiAyMHB4Ow0KICAgICAgICAgICAgcmlnaHQ6IDIwcHg7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjNDhiYjc4Ow0KICAgICAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICAgICAgcGFkZGluZzogMTVweCAyMHB4Ow0KICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMTBweCAzMHB4IHJnYmEoMCwwLDAsMC4yKTsNCiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCg0MDBweCk7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4zcyBlYXNlOw0KICAgICAgICAgICAgei1pbmRleDogMTAwMTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5ub3RpZmljYXRpb24uc2hvdyB7DQogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoMCk7DQogICAgICAgIH0NCg0KDQoNCiAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7DQogICAgICAgICAgICAuY29udHJvbHMgew0KICAgICAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IHN0cmV0Y2g7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC5uYXYtY29udHJvbHMsIC52aWV3LWNvbnRyb2xzLCAuc3luYy1jb250cm9scyB7DQogICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC5jdXJyZW50LWRhdGUgew0KICAgICAgICAgICAgICAgIG1hcmdpbjogMTBweCAwOw0KICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLmNhbGVuZGFyLWdyaWQubW9udGgtdmlldyB7DQogICAgICAgICAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoNywgMWZyKTsNCiAgICAgICAgICAgICAgICBmb250LXNpemU6IDEycHg7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC5jYWxlbmRhci1jZWxsIHsNCiAgICAgICAgICAgICAgICBtaW4taGVpZ2h0OiA2MHB4Ow0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDRweDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLnNoaWZ0LWl0ZW0gew0KICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMTBweDsNCiAgICAgICAgICAgICAgICBwYWRkaW5nOiAycHggNHB4Ow0KICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgfQ0KICAgIDwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCiAgICA8ZGl2IGNsYXNzPSJjb250YWluZXIiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJoZWFkZXIiPg0KICAgICAgICAgICAgPGgxPvCfj6Ug6YCy6ZqO6Yar55mC5o6S54+t566h55CG57O757WxPC9oMT4NCg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0iY29udHJvbHMiPg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im5hdi1jb250cm9scyI+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9Im5hdi1idG4iIG9uY2xpY2s9Im5hdmlnYXRlQ2FsZW5kYXIoLTEpIj7il4Ag5LiK5LiA5YCLPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImN1cnJlbnQtZGF0ZSIgaWQ9ImN1cnJlbnREYXRlIj48L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ibmF2LWJ0biIgb25jbGljaz0ibmF2aWdhdGVDYWxlbmRhcigxKSI+5LiL5LiA5YCLIOKWtjwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJuYXYtYnRuIiBvbmNsaWNrPSJnb1RvVG9kYXkoKSI+8J+ThSDku4rlpKk8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ2aWV3LWNvbnRyb2xzIj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0idmlldy1idG4gYWN0aXZlIj7mnIjoppblnJY8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzeW5jLWNvbnRyb2xzIj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ic3luYy1idG4iIG9uY2xpY2s9InN5bmNUb0dvb2dsZSgpIj7wn5OFIOWQjOatpSBHb29nbGU8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ic3luYy1idG4iIG9uY2xpY2s9ImV4cG9ydFRvSUNhbCgpIj7wn5OLIOWMr+WHuiBpQ2FsPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InN5bmMtYnRuIiBvbmNsaWNrPSJwcmludFNjaGVkdWxlKCkiPvCflqjvuI8g5YiX5Y2wPC9idXR0b24+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPCEtLSDnr6npgbjpnaLmnb8gLS0+DQogICAgICAgIDxkaXYgY2xhc3M9ImZpbHRlci1wYW5lbCI+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJmaWx0ZXItZ3JpZCI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmlsdGVyLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJmaWx0ZXItbGFiZWwiPumDqOmWgOevqemBuDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9ImZpbHRlci1zZWxlY3QiIGlkPSJkZXBhcnRtZW50RmlsdGVyIiBvbmNoYW5nZT0iYXBwbHlGaWx0ZXJzKCkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj7miYDmnInpg6jploA8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IuWFp+enkSI+5YWn56eRPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSLlpJbnp5EiPuWkluenkTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0i5oCl6Ki656eRIj7mgKXoqLrnp5E8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IuWFkuenkSI+5YWS56eRPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSLlqabnlKLnp5EiPuWppueUouenkTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmaWx0ZXItZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImZpbHRlci1sYWJlbCI+6IG35L2N56+p6YG4PC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBjbGFzcz0iZmlsdGVyLXNlbGVjdCIgaWQ9InJvbGVGaWx0ZXIiIG9uY2hhbmdlPSJhcHBseUZpbHRlcnMoKSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPuaJgOacieiBt+S9jTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iZG9jdG9yIj7phqvluKs8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im51cnNlIj7orbfnkIbluKs8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmlsdGVyLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJmaWx0ZXItbGFiZWwiPuePreWIpeevqemBuDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9ImZpbHRlci1zZWxlY3QiIGlkPSJzaGlmdFR5cGVGaWx0ZXIiIG9uY2hhbmdlPSJhcHBseUZpbHRlcnMoKSI+DQogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPuaJgOacieePreWIpTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibW9ybmluZyI+5pep54+tPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJhZnRlcm5vb24iPuS4reePrTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibmlnaHQiPuWknOePrTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iZW1lcmdlbmN5Ij7mgKXoqLo8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmlsdGVyLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJmaWx0ZXItbGFiZWwiPuaQnOWwi+S6uuWToTwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZmlsdGVyLWlucHV0IiBpZD0ic3RhZmZTZWFyY2giIHBsYWNlaG9sZGVyPSLovLjlhaXlp5PlkI0uLi4iIG9uaW5wdXQ9ImFwcGx5RmlsdGVycygpIj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJxdWljay1hY3Rpb25zIj4NCiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0icXVpY2stYnRuIiBvbmNsaWNrPSJvcGVuRml4ZWRTY2hlZHVsZU1vZGFsKCkiPvCfk4Ug5Zu65a6a5LiK54+tPC9idXR0b24+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InF1aWNrLWJ0biIgb25jbGljaz0iY2hlY2tDb25mbGljdHMoKSI+4pqg77iPIOaqouafpeihneeqgTwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJxdWljay1idG4gZGFuZ2VyIiBvbmNsaWNrPSJjbGVhckFsbFNoaWZ0cygpIj7wn5eR77iPIOa4heepuuaOkuePrTwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgIDwvZGl2Pg0KDQoNCg0KICAgICAgICA8ZGl2IGNsYXNzPSJjYWxlbmRhci1jb250YWluZXIiPg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0iY2FsZW5kYXItZ3JpZCBtb250aC12aWV3IiBpZD0iY2FsZW5kYXJHcmlkIj48L2Rpdj4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPGRpdiBjbGFzcz0ic3RhZmYtcGFuZWwiPg0KICAgICAgICAgICAgPGgzPvCfkajigI3impXvuI/wn5Gp4oCN4pqV77iPIOmGq+itt+S6uuWToeeuoeeQhiA8c3BhbiBzdHlsZT0iZm9udC1zaXplOiAxMnB4OyBjb2xvcjogIzcxODA5NjsgZm9udC13ZWlnaHQ6IG5vcm1hbDsiPuaLluaLveS6uuWToeWIsOihjOS6i+abhuaWsOWinuaOkuePrTwvc3Bhbj48L2gzPg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhZmYtZmlsdGVyIj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJzdGFmZi1maWx0ZXItYnRuIGFjdGl2ZSIgb25jbGljaz0iZmlsdGVyU3RhZmYoJ2FsbCcpIj7lhajpg6g8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJzdGFmZi1maWx0ZXItYnRuIiBvbmNsaWNrPSJmaWx0ZXJTdGFmZignZG9jdG9yJykiPumGq+W4qzwvYnV0dG9uPg0KICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InN0YWZmLWZpbHRlci1idG4iIG9uY2xpY2s9ImZpbHRlclN0YWZmKCdudXJzZScpIj7orbfnkIbluKs8L2J1dHRvbj4NCg0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGFmZi1ncmlkIiBpZD0ic3RhZmZHcmlkIj48L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgPC9kaXY+DQoNCiAgICA8IS0tIOaWsOWinuaOkuePreaooeaFi+ahhiAtLT4NCiAgICA8ZGl2IGNsYXNzPSJtb2RhbCIgaWQ9InNoaWZ0TW9kYWwiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50Ij4NCiAgICAgICAgICAgIDxoMz7mlrDlop7mjpLnj608L2gzPg0KICAgICAgICAgICAgPGZvcm0gaWQ9InNoaWZ0Rm9ybSI+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0iZm9ybS1sYWJlbCI+5Lq65ZOhPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBjbGFzcz0iZm9ybS1zZWxlY3QiIGlkPSJzdGFmZlNlbGVjdCIgcmVxdWlyZWQ+PC9zZWxlY3Q+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0iZm9ybS1sYWJlbCI+5pel5pyfPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImRhdGUiIGNsYXNzPSJmb3JtLWlucHV0IiBpZD0ic2hpZnREYXRlIiByZXF1aXJlZD4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJmb3JtLWxhYmVsIj7plovlp4vmmYLplpM8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGltZSIgY2xhc3M9ImZvcm0taW5wdXQiIGlkPSJzdGFydFRpbWUiIHJl',
            'cXVpcmVkPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImZvcm0tbGFiZWwiPue1kOadn+aZgumWkzwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0aW1lIiBjbGFzcz0iZm9ybS1pbnB1dCIgaWQ9ImVuZFRpbWUiIHJlcXVpcmVkPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImZvcm0tbGFiZWwiPuePreWIpTwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9ImZvcm0tc2VsZWN0IiBpZD0ic2hpZnRUeXBlIiByZXF1aXJlZD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im1vcm5pbmciPuaXqeePrSAoMDg6MDAtMTY6MDApPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJhZnRlcm5vb24iPuS4reePrSAoMTY6MDAtMjQ6MDApPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJuaWdodCI+5aSc54+tICgwMDowMC0wODowMCk8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImVtZXJnZW5jeSI+5oCl6Ki654+tPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJjdXN0b20iPuiHquioguaZgumWkzwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJmb3JtLWxhYmVsIj7lgpnoqLs8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImZvcm0taW5wdXQiIGlkPSJzaGlmdE5vdGVzIiBwbGFjZWhvbGRlcj0i6Ly45YWl5YKZ6Ki76LOH6KiKLi4uIj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWJ1dHRvbnMiPg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tc2Vjb25kYXJ5IiBvbmNsaWNrPSJjbG9zZU1vZGFsKCkiPuWPlua2iDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9InN1Ym1pdCIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+5paw5aKe5o6S54+tPC9idXR0b24+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Zvcm0+DQogICAgICAgIDwvZGl2Pg0KICAgIDwvZGl2Pg0KDQogICAgPCEtLSDlm7rlrprkuIrnj63mqKHmhYvmoYYgLS0+DQogICAgPGRpdiBjbGFzcz0ibW9kYWwiIGlkPSJmaXhlZFNjaGVkdWxlTW9kYWwiPg0KICAgICAgICA8ZGl2IGNsYXNzPSJtb2RhbC1jb250ZW50Ij4NCiAgICAgICAgICAgIDxoMz7oqK3lrprlm7rlrprkuIrnj63mmYLplpM8L2gzPg0KICAgICAgICAgICAgPGZvcm0gaWQ9ImZpeGVkU2NoZWR1bGVGb3JtIj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJmb3JtLWxhYmVsIj7pgbjmk4fkurrlk6E8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGNsYXNzPSJmb3JtLXNlbGVjdCIgaWQ9ImZpeGVkU3RhZmZTZWxlY3QiIHJlcXVpcmVkPjwvc2VsZWN0Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImZvcm0tbGFiZWwiPuWbuuWumuePreWIpTwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgY2xhc3M9ImZvcm0tc2VsZWN0IiBpZD0iZml4ZWRTaGlmdFR5cGUiIHJlcXVpcmVkPg0KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibW9ybmluZyI+5pep54+tICgwODowMC0xNjowMCk8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImFmdGVybm9vbiI+5Lit54+tICgxNjowMC0yNDowMCk8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Im5pZ2h0Ij7lpJznj60gKDAwOjAwLTA4OjAwKTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iY3VzdG9tIj7oh6roqILmmYLplpM8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCIgaWQ9ImN1c3RvbVRpbWVHcm91cCIgc3R5bGU9ImRpc3BsYXk6IG5vbmU7Ij4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTogZ3JpZDsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgMWZyOyBnYXA6IDE1cHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJmb3JtLWxhYmVsIj7plovlp4vmmYLplpM8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0aW1lIiBjbGFzcz0iZm9ybS1pbnB1dCIgaWQ9ImZpeGVkU3RhcnRUaW1lIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImZvcm0tbGFiZWwiPue1kOadn+aZgumWkzwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRpbWUiIGNsYXNzPSJmb3JtLWlucHV0IiBpZD0iZml4ZWRFbmRUaW1lIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4NCiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJmb3JtLWxhYmVsIj7lt6XkvZzml6Xpgbjmk4c8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OiBncmlkOyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCg3LCAxZnIpOyBnYXA6IDEwcHg7IG1hcmdpbi10b3A6IDEwcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA1cHg7IGZvbnQtc2l6ZTogMTJweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJjaGVja2JveCIgaWQ9ImRheTAiIHZhbHVlPSIwIj4g5pelDQogICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDVweDsgZm9udC1zaXplOiAxMnB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBpZD0iZGF5MSIgdmFsdWU9IjEiIGNoZWNrZWQ+IOS4gA0KICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA1cHg7IGZvbnQtc2l6ZTogMTJweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJjaGVja2JveCIgaWQ9ImRheTIiIHZhbHVlPSIyIiBjaGVja2VkPiDkuowNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNXB4OyBmb250LXNpemU6IDEycHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSJkYXkzIiB2YWx1ZT0iMyIgY2hlY2tlZD4g5LiJDQogICAgICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDVweDsgZm9udC1zaXplOiAxMnB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImNoZWNrYm94IiBpZD0iZGF5NCIgdmFsdWU9IjQiIGNoZWNrZWQ+IOWbmw0KICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA1cHg7IGZvbnQtc2l6ZTogMTJweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJjaGVja2JveCIgaWQ9ImRheTUiIHZhbHVlPSI1IiBjaGVja2VkPiDkupQNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNXB4OyBmb250LXNpemU6IDEycHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIGlkPSJkYXk2IiB2YWx1ZT0iNiI+IOWFrQ0KICAgICAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0iZm9ybS1sYWJlbCI+5oeJ55So56+E5ZyNPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgPHNlbGVjdCBjbGFzcz0iZm9ybS1zZWxlY3QiIGlkPSJzY2hlZHVsZVJhbmdlIiByZXF1aXJlZD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImN1cnJlbnQtbW9udGgiPuacrOaciOS7vTwvb3B0aW9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibmV4dC1tb250aCI+5LiL5YCL5pyIPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJjdXJyZW50LWFuZC1uZXh0Ij7mnKzmnIjlj4rkuIvlgIvmnIg8L29wdGlvbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImN1c3RvbS1yYW5nZSI+6Ieq6KiC5pel5pyf56+E5ZyNPC9vcHRpb24+DQogICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiIGlkPSJjdXN0b21SYW5nZUdyb3VwIiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OiBncmlkOyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDFmciAxZnI7IGdhcDogMTVweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImZvcm0tbGFiZWwiPumWi+Wni+aXpeacnzwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9ImRhdGUiIGNsYXNzPSJmb3JtLWlucHV0IiBpZD0icmFuZ2VTdGFydERhdGUiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0iZm9ybS1sYWJlbCI+57WQ5p2f5pel5pyfPC9sYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0iZGF0ZSIgY2xhc3M9ImZvcm0taW5wdXQiIGlkPSJyYW5nZUVuZERhdGUiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPg0KICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImZvcm0tbGFiZWwiPuWCmeiouzwvbGFiZWw+DQogICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBjbGFzcz0iZm9ybS1pbnB1dCIgaWQ9ImZpeGVkU2NoZWR1bGVOb3RlcyIgcGxhY2Vob2xkZXI9IuWbuuWumuS4iuePreaOkueoiyIgdmFsdWU9IuWbuuWumuS4iuePreaOkueoiyI+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+DQogICAgICAgICAgICAgICAgICAgIDxsYWJlbCBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA4cHg7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM0YTU1Njg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJjaGVja2JveCIgaWQ9InJlcGxhY2VFeGlzdGluZyIgY2hlY2tlZD4NCiAgICAgICAgICAgICAgICAgICAgICAgIOimhuiTi+ePvuacieaOkuePre+8iOWmguaenOacieihneeqge+8iQ0KICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvcm0tYnV0dG9ucyI+DQogICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iYnRuIGJ0bi1zZWNvbmRhcnkiIG9uY2xpY2s9ImNsb3NlRml4ZWRTY2hlZHVsZU1vZGFsKCkiPuWPlua2iDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9InN1Ym1pdCIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+5bu656uL5Zu65a6a5o6S54+tPC9idXR0b24+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8L2Zvcm0+DQogICAgICAgIDwvZGl2Pg0KICAgIDwvZGl2Pg0KDQogICAgPCEtLSDpgJrnn6UgLS0+DQogICAgPGRpdiBjbGFzcz0ibm90aWZpY2F0aW9uIiBpZD0ibm90aWZpY2F0aW9uIj48L2Rpdj4NCg0KICAgIDxzY3JpcHQ+DQogICAgICAgIC8vIOWFqOWfn+iuiuaVuA0KICAgICAgICBsZXQgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOw0KICAgICAgICBsZXQgY3VycmVudFZpZXcgPSAnbW9udGgnOw0KICAgICAgICBsZXQgZHJhZ2dlZFNoaWZ0ID0gbnVsbDsNCiAgICAgICAgbGV0IGN1cnJlbnRTdGFmZkZpbHRlciA9ICdhbGwnOw0KICAgICAgICANCiAgICAgICAgLy8g6Yar6K235Lq65ZOh6LOH5paZDQogICAgICAgIGNvbnN0IHN0YWZmID0gWw0KICAgICAgICAgICAgeyBpZDogMSwgbmFtZTogJ+eOi+W/l+aYjicsIHJvbGU6ICdkb2N0',
            'b3InLCBkZXBhcnRtZW50OiAn5YWn56eRJywgbGV2ZWw6ICfkuLvmsrvphqvluKsnLCBwaG9uZTogJzA5MTItMzQ1LTY3OCcsIGVtYWlsOiAnd2FuZ0Bob3NwaXRhbC5jb20nLCBtYXhIb3VyczogNDAgfSwNCiAgICAgICAgICAgIHsgaWQ6IDIsIG5hbWU6ICfmnY7nvo7njrInLCByb2xlOiAnZG9jdG9yJywgZGVwYXJ0bWVudDogJ+WkluenkScsIGxldmVsOiAn5L2P6Zmi6Yar5birJywgcGhvbmU6ICcwOTIzLTQ1Ni03ODknLCBlbWFpbDogJ2xpQGhvc3BpdGFsLmNvbScsIG1heEhvdXJzOiAzNiB9LA0KICAgICAgICAgICAgeyBpZDogMywgbmFtZTogJ+W8teW7uuWciycsIHJvbGU6ICdkb2N0b3InLCBkZXBhcnRtZW50OiAn5oCl6Ki656eRJywgbGV2ZWw6ICfkuLvmsrvphqvluKsnLCBwaG9uZTogJzA5MzQtNTY3LTg5MCcsIGVtYWlsOiAnemhhbmdAaG9zcGl0YWwuY29tJywgbWF4SG91cnM6IDQyIH0sDQogICAgICAgICAgICB7IGlkOiA0LCBuYW1lOiAn6Zmz5reR6IqsJywgcm9sZTogJ251cnNlJywgZGVwYXJ0bWVudDogJ+WFp+enkScsIGxldmVsOiAn6K2355CG5birJywgcGhvbmU6ICcwOTQ1LTY3OC05MDEnLCBlbWFpbDogJ2NoZW5AaG9zcGl0YWwuY29tJywgbWF4SG91cnM6IDQwIH0sDQogICAgICAgICAgICB7IGlkOiA1LCBuYW1lOiAn5p6X6ZuF5am3Jywgcm9sZTogJ251cnNlJywgZGVwYXJ0bWVudDogJ+WkluenkScsIGxldmVsOiAn6LOH5rex6K2355CG5birJywgcGhvbmU6ICcwOTU2LTc4OS0wMTInLCBlbWFpbDogJ2xpbkBob3NwaXRhbC5jb20nLCBtYXhIb3VyczogMzggfSwNCiAgICAgICAgICAgIHsgaWQ6IDYsIG5hbWU6ICfpu4Plv5foj68nLCByb2xlOiAnbnVyc2UnLCBkZXBhcnRtZW50OiAn5oCl6Ki656eRJywgbGV2ZWw6ICforbfnkIbluKsnLCBwaG9uZTogJzA5NjctODkwLTEyMycsIGVtYWlsOiAnaHVhbmdAaG9zcGl0YWwuY29tJywgbWF4SG91cnM6IDQ0IH0sDQogICAgICAgICAgICB7IGlkOiA3LCBuYW1lOiAn5YqJ5L2z5oWnJywgcm9sZTogJ2RvY3RvcicsIGRlcGFydG1lbnQ6ICflhZLnp5EnLCBsZXZlbDogJ+S4u+ayu+mGq+W4qycsIHBob25lOiAnMDk3OC05MDEtMjM0JywgZW1haWw6ICdsaXVAaG9zcGl0YWwuY29tJywgbWF4SG91cnM6IDM2IH0sDQogICAgICAgICAgICB7IGlkOiA4LCBuYW1lOiAn5ZCz5piO54+gJywgcm9sZTogJ251cnNlJywgZGVwYXJ0bWVudDogJ+WFkuenkScsIGxldmVsOiAn6K2355CG5birJywgcGhvbmU6ICcwOTg5LTAxMi0zNDUnLCBlbWFpbDogJ3d1QGhvc3BpdGFsLmNvbScsIG1heEhvdXJzOiA0MCB9LA0KICAgICAgICAgICAgeyBpZDogOSwgbmFtZTogJ+iUoeaWh+mbhCcsIHJvbGU6ICdkb2N0b3InLCBkZXBhcnRtZW50OiAn5amm55Si56eRJywgbGV2ZWw6ICfkuLvmsrvphqvluKsnLCBwaG9uZTogJzA5OTAtMTIzLTQ1NicsIGVtYWlsOiAndHNhaUBob3NwaXRhbC5jb20nLCBtYXhIb3VyczogMzggfSwNCiAgICAgICAgICAgIHsgaWQ6IDEwLCBuYW1lOiAn6YSt6bqX6I+vJywgcm9sZTogJ251cnNlJywgZGVwYXJ0bWVudDogJ+WppueUouenkScsIGxldmVsOiAn6LOH5rex6K2355CG5birJywgcGhvbmU6ICcwOTAxLTIzNC01NjcnLCBlbWFpbDogJ3poZW5nQGhvc3BpdGFsLmNvbScsIG1heEhvdXJzOiAzNiB9DQogICAgICAgIF07DQoNCiAgICAgICAgLy8g5o6S54+t6LOH5paZIC0g5L2/55So55W25YmN5pyI5Lu955qE5pel5pyfDQogICAgICAgIGxldCBzaGlmdHMgPSBbXTsNCiAgICAgICAgDQogICAgICAgIC8vIOWIneWni+WMluS4gOS6m+ekuuevhOaOkuePreizh+aWmQ0KICAgICAgICBmdW5jdGlvbiBpbml0aWFsaXplU2FtcGxlU2hpZnRzKCkgew0KICAgICAgICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpOw0KICAgICAgICAgICAgY29uc3QgY3VycmVudE1vbnRoID0gdG9kYXkuZ2V0TW9udGgoKTsNCiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRZZWFyID0gdG9kYXkuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8g56K65L+d5L2/55So5LiA6Ie055qE5pel5pyf77yM6YG/5YWN6KaW5ZyW6ZaT5LiN5ZCM5q2lDQogICAgICAgICAgICBjb25zdCBiYXNlRGF0ZSA9IDI2OyAvLyDntbHkuIDkvb/nlKgyNuiZn+S9nOeCuuekuuevhOaXpeacnw0KICAgICAgICAgICAgDQogICAgICAgICAgICBzaGlmdHMgPSBbDQogICAgICAgICAgICAgICAgeyBpZDogMSwgc3RhZmZJZDogMSwgZGF0ZTogYCR7Y3VycmVudFllYXJ9LSR7KGN1cnJlbnRNb250aCArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0tJHtiYXNlRGF0ZS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YCwgc3RhcnRUaW1lOiAnMDg6MDAnLCBlbmRUaW1lOiAnMTY6MDAnLCB0eXBlOiAnbW9ybmluZycsIHN0YXR1czogJ2NvbmZpcm1lZCcsIG5vdGVzOiAn6ZaA6Ki6JyB9LA0KICAgICAgICAgICAgICAgIHsgaWQ6IDIsIHN0YWZmSWQ6IDQsIGRhdGU6IGAke2N1cnJlbnRZZWFyfS0keyhjdXJyZW50TW9udGggKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9LSR7YmFzZURhdGUudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWAsIHN0YXJ0VGltZTogJzA4OjAwJywgZW5kVGltZTogJzE2OjAwJywgdHlwZTogJ21vcm5pbmcnLCBzdGF0dXM6ICdjb25maXJtZWQnLCBub3RlczogJ+eXheaIvycgfSwNCiAgICAgICAgICAgICAgICB7IGlkOiAzLCBzdGFmZklkOiAyLCBkYXRlOiBgJHtjdXJyZW50WWVhcn0tJHsoY3VycmVudE1vbnRoICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfS0keyhiYXNlRGF0ZSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gLCBzdGFydFRpbWU6ICcxNjowMCcsIGVuZFRpbWU6ICcyNDowMCcsIHR5cGU6ICdhZnRlcm5vb24nLCBzdGF0dXM6ICdwZW5kaW5nJywgbm90ZXM6ICfmiYvooZPmiL8nIH0sDQogICAgICAgICAgICAgICAgeyBpZDogNCwgc3RhZmZJZDogNSwgZGF0ZTogYCR7Y3VycmVudFllYXJ9LSR7KGN1cnJlbnRNb250aCArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0tJHsoYmFzZURhdGUgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YCwgc3RhcnRUaW1lOiAnMTY6MDAnLCBlbmRUaW1lOiAnMjQ6MDAnLCB0eXBlOiAnYWZ0ZXJub29uJywgc3RhdHVzOiAnY29uZmlybWVkJywgbm90ZXM6ICfnl4XmiL8nIH0sDQogICAgICAgICAgICAgICAgeyBpZDogNSwgc3RhZmZJZDogMywgZGF0ZTogYCR7Y3VycmVudFllYXJ9LSR7KGN1cnJlbnRNb250aCArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0tJHsoYmFzZURhdGUgKyAyKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YCwgc3RhcnRUaW1lOiAnMDA6MDAnLCBlbmRUaW1lOiAnMDg6MDAnLCB0eXBlOiAnbmlnaHQnLCBzdGF0dXM6ICdjb25maXJtZWQnLCBub3RlczogJ+aApeiouicgfSwNCiAgICAgICAgICAgICAgICB7IGlkOiA2LCBzdGFmZklkOiA2LCBkYXRlOiBgJHtjdXJyZW50WWVhcn0tJHsoY3VycmVudE1vbnRoICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfS0keyhiYXNlRGF0ZSArIDIpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gLCBzdGFydFRpbWU6ICcwMDowMCcsIGVuZFRpbWU6ICcwODowMCcsIHR5cGU6ICduaWdodCcsIHN0YXR1czogJ2NvbmZpcm1lZCcsIG5vdGVzOiAn5oCl6Ki6JyB9LA0KICAgICAgICAgICAgICAgIHsgaWQ6IDcsIHN0YWZmSWQ6IDcsIGRhdGU6IGAke2N1cnJlbnRZZWFyfS0keyhjdXJyZW50TW9udGggKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9LSR7KGJhc2VEYXRlIC0gMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWAsIHN0YXJ0VGltZTogJzA5OjAwJywgZW5kVGltZTogJzE3OjAwJywgdHlwZTogJ21vcm5pbmcnLCBzdGF0dXM6ICdjb25maXJtZWQnLCBub3RlczogJ+WFkuenkemWgOiouicgfSwNCiAgICAgICAgICAgICAgICB7IGlkOiA4LCBzdGFmZklkOiA4LCBkYXRlOiBgJHtjdXJyZW50WWVhcn0tJHsoY3VycmVudE1vbnRoICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfS0keyhiYXNlRGF0ZSAtIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gLCBzdGFydFRpbWU6ICcwOTowMCcsIGVuZFRpbWU6ICcxNzowMCcsIHR5cGU6ICdtb3JuaW5nJywgc3RhdHVzOiAnY29uZmlybWVkJywgbm90ZXM6ICflhZLnp5Hnl4XmiL8nIH0NCiAgICAgICAgICAgIF07DQogICAgICAgIH0NCg0KICAgICAgICAvLyDnr6npgbjni4DmhYsNCiAgICAgICAgbGV0IGN1cnJlbnRGaWx0ZXJzID0gew0KICAgICAgICAgICAgZGVwYXJ0bWVudDogJycsDQogICAgICAgICAgICByb2xlOiAnJywNCiAgICAgICAgICAgIHNoaWZ0VHlwZTogJycsDQogICAgICAgICAgICBzdGFmZlNlYXJjaDogJycNCiAgICAgICAgfTsNCg0KICAgICAgICAvLyDliJ3lp4vljJYNCiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaW5pdGlhbGl6ZVNhbXBsZVNoaWZ0cygpOyAvLyDovInlhaXnpLrnr4TmjpLnj63os4fmlpkNCiAgICAgICAgICAgIHVwZGF0ZUN1cnJlbnREYXRlKCk7DQogICAgICAgICAgICByZW5kZXJDYWxlbmRhcigpOw0KICAgICAgICAgICAgcmVuZGVyU3RhZmZQYW5lbCgpOw0KICAgICAgICAgICAgc2V0dXBFdmVudExpc3RlbmVycygpOw0KICAgICAgICAgICAgdXBkYXRlU3RhdHMoKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy8g6Kit5a6a5LqL5Lu255uj6IG95ZmoDQogICAgICAgIGZ1bmN0aW9uIHNldHVwRXZlbnRMaXN0ZW5lcnMoKSB7DQogICAgICAgICAgICAvLyDnj63liKXpgbjmk4forormm7QNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaGlmdFR5cGUnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gdGhpcy52YWx1ZTsNCiAgICAgICAgICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnRUaW1lJyk7DQogICAgICAgICAgICAgICAgY29uc3QgZW5kVGltZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlbmRUaW1lJyk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgc3dpdGNoKHR5cGUpIHsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW9ybmluZyc6DQogICAgICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWUudmFsdWUgPSAnMDg6MDAnOw0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kVGltZS52YWx1ZSA9ICcxNjowMCc7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWZ0ZXJub29uJzoNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0VGltZS52YWx1ZSA9ICcxNjowMCc7DQogICAgICAgICAgICAgICAgICAgICAgICBlbmRUaW1lLnZhbHVlID0gJzI0OjAwJzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlICduaWdodCc6DQogICAgICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWUudmFsdWUgPSAnMDA6MDAnOw0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kVGltZS52YWx1ZSA9ICcwODowMCc7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgLy8g5Zu65a6a5o6S54+t54+t5Yil6YG45pOH6K6K5pu0DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZml4ZWRTaGlmdFR5cGUnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gdGhpcy52YWx1ZTsNCiAgICAgICAgICAgICAgICBjb25zdCBjdXN0b21UaW1lR3JvdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VzdG9tVGltZUdyb3VwJyk7DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpeGVkU3RhcnRUaW1lJyk7DQogICAgICAgICAgICAgICAgY29uc3QgZW5kVGltZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaXhlZEVuZFRpbWUnKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2N1c3RvbScpIHsNCiAgICAgICAgICAgICAgICAgICAgY3VzdG9tVGltZUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGN1c3RvbVRpbWVHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgICAgICBzd2l0Y2godHlwZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW9ybmluZyc6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lLnZhbHVlID0gJzA4OjAwJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRUaW1lLnZhbHVlID0gJzE2OjAwJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FmdGVybm9vbic6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lLnZhbHVlID0gJzE2OjAwJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRUaW1lLnZhbHVlID0gJzI0OjAwJzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ25pZ2h0JzoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWUudmFsdWUgPSAnMDA6MDAnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZFRpbWUudmFsdWUgPSAnMDg6MDAnOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIC8vIOaOkueoi+evhOWcjemBuOaTh+iuiuabtA0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjaGVkdWxlUmFuZ2UnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBjdXN0b21SYW5nZUdyb3VwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1c3RvbVJhbmdlR3JvdXAnKTsNCiAgICAgICAgICAgICAgICBpZiAodGhpcy52YWx1ZSA9PT0gJ2N1c3RvbS1yYW5nZScpIHsNCiAgICAgICAgICAgICAgICAgICAgY3VzdG9tUmFuZ2VHcm91cC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjdXN0b21SYW5nZUdyb3VwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIC8vIOih',
            'qOWWruaPkOS6pA0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaWZ0Rm9ybScpLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgYWRkU2hpZnQoKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAvLyDlm7rlrprmjpLnj63ooajllq7mj5DkuqQNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaXhlZFNjaGVkdWxlRm9ybScpLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgY3JlYXRlRml4ZWRTY2hlZHVsZSgpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDmm7TmlrDnlbbliY3ml6XmnJ/poa/npLoNCiAgICAgICAgZnVuY3Rpb24gdXBkYXRlQ3VycmVudERhdGUoKSB7DQogICAgICAgICAgICBjb25zdCBvcHRpb25zID0geyB5ZWFyOiAnbnVtZXJpYycsIG1vbnRoOiAnbG9uZycgfTsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXJyZW50RGF0ZScpLnRleHRDb250ZW50ID0gY3VycmVudERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCd6aC1UVycsIG9wdGlvbnMpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8g5bCO6Iiq6KGM5LqL5puGDQogICAgICAgIGZ1bmN0aW9uIG5hdmlnYXRlQ2FsZW5kYXIoZGlyZWN0aW9uKSB7DQogICAgICAgICAgICBjdXJyZW50RGF0ZS5zZXRNb250aChjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgZGlyZWN0aW9uKTsNCiAgICAgICAgICAgIHVwZGF0ZUN1cnJlbnREYXRlKCk7DQogICAgICAgICAgICByZW5kZXJDYWxlbmRhcigpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8g5YiH5o+b6KaW5ZyW77yI5YOF5L+d55WZ5pyI6KaW5ZyW77yJDQogICAgICAgIGZ1bmN0aW9uIGNoYW5nZVZpZXcodmlldykgew0KICAgICAgICAgICAgLy8g5YOF5pSv5o+05pyI6KaW5ZyWDQogICAgICAgICAgICBjdXJyZW50VmlldyA9ICdtb250aCc7DQogICAgICAgICAgICB1cGRhdGVDdXJyZW50RGF0ZSgpOw0KICAgICAgICAgICAgcmVuZGVyQ2FsZW5kYXIoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOa4suafk+ihjOS6i+abhg0KICAgICAgICBmdW5jdGlvbiByZW5kZXJDYWxlbmRhcigpIHsNCiAgICAgICAgICAgIGNvbnN0IGdyaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FsZW5kYXJHcmlkJyk7DQogICAgICAgICAgICBncmlkLmlubmVySFRNTCA9ICcnOw0KICAgICAgICAgICAgZ3JpZC5jbGFzc05hbWUgPSAnY2FsZW5kYXItZ3JpZCBtb250aC12aWV3JzsNCiAgICAgICAgICAgIHJlbmRlck1vbnRoVmlldyhncmlkKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOa4suafk+aciOimluWclg0KICAgICAgICBmdW5jdGlvbiByZW5kZXJNb250aFZpZXcoZ3JpZCkgew0KICAgICAgICAgICAgLy8g5re75Yqg5pif5pyf5qiZ6aGMDQogICAgICAgICAgICBjb25zdCB3ZWVrZGF5cyA9IFsn5pelJywgJ+S4gCcsICfkuownLCAn5LiJJywgJ+WbmycsICfkupQnLCAn5YWtJ107DQogICAgICAgICAgICB3ZWVrZGF5cy5mb3JFYWNoKGRheSA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgICAgICAgICAgICAgaGVhZGVyLmNsYXNzTmFtZSA9ICdjYWxlbmRhci1oZWFkZXInOw0KICAgICAgICAgICAgICAgIGhlYWRlci50ZXh0Q29udGVudCA9IGRheTsNCiAgICAgICAgICAgICAgICBncmlkLmFwcGVuZENoaWxkKGhlYWRlcik7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgLy8g542y5Y+W5pyI5Lu955qE56ys5LiA5aSp5ZKM5pyA5b6M5LiA5aSpDQogICAgICAgICAgICBjb25zdCBmaXJzdERheSA9IG5ldyBEYXRlKGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCksIGN1cnJlbnREYXRlLmdldE1vbnRoKCksIDEpOw0KICAgICAgICAgICAgY29uc3QgbGFzdERheSA9IG5ldyBEYXRlKGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCksIGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxLCAwKTsNCiAgICAgICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKGZpcnN0RGF5KTsNCiAgICAgICAgICAgIHN0YXJ0RGF0ZS5zZXREYXRlKHN0YXJ0RGF0ZS5nZXREYXRlKCkgLSBmaXJzdERheS5nZXREYXkoKSk7DQoNCiAgICAgICAgICAgIC8vIOa4suafkzQy5YCL5qC85a2Q77yINumAse+8iQ0KICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA0MjsgaSsrKSB7DQogICAgICAgICAgICAgICAgY29uc3QgY2VsbERhdGUgPSBuZXcgRGF0ZShzdGFydERhdGUpOw0KICAgICAgICAgICAgICAgIGNlbGxEYXRlLnNldERhdGUoc3RhcnREYXRlLmdldERhdGUoKSArIGkpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTmFtZSA9ICdjYWxlbmRhci1jZWxsJzsNCiAgICAgICAgICAgICAgICBjZWxsLmRhdGFzZXQuZGF0ZSA9IGNlbGxEYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAoY2VsbERhdGUuZ2V0TW9udGgoKSAhPT0gY3VycmVudERhdGUuZ2V0TW9udGgoKSkgew0KICAgICAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ290aGVyLW1vbnRoJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIChpc1RvZGF5KGNlbGxEYXRlKSkgew0KICAgICAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ3RvZGF5Jyk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgY29uc3QgZGF5TnVtYmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgICAgICAgICAgICAgZGF5TnVtYmVyLmNsYXNzTmFtZSA9ICdkYXktbnVtYmVyJzsNCiAgICAgICAgICAgICAgICBkYXlOdW1iZXIudGV4dENvbnRlbnQgPSBjZWxsRGF0ZS5nZXREYXRlKCk7DQogICAgICAgICAgICAgICAgY2VsbC5hcHBlbmRDaGlsZChkYXlOdW1iZXIpOw0KDQogICAgICAgICAgICAgICAgLy8g5re75Yqg5o6S54+tDQogICAgICAgICAgICAgICAgY29uc3QgZGF5U2hpZnRzID0gZ2V0U2hpZnRzRm9yRGF0ZShjZWxsRGF0ZSkuZmlsdGVyKHBhc3Nlc0ZpbHRlcik7DQogICAgICAgICAgICAgICAgZGF5U2hpZnRzLmZvckVhY2goc2hpZnQgPT4gew0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzaGlmdEVsZW1lbnQgPSBjcmVhdGVTaGlmdEVsZW1lbnQoc2hpZnQpOw0KICAgICAgICAgICAgICAgICAgICBjZWxsLmFwcGVuZENoaWxkKHNoaWZ0RWxlbWVudCk7DQogICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAvLyDmt7vliqDmi5bmlL7lip/og70NCiAgICAgICAgICAgICAgICBzZXR1cENlbGxEcm9wWm9uZShjZWxsKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBncmlkLmFwcGVuZENoaWxkKGNlbGwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCg0KDQogICAgICAgIC8vIOWJteW7uuaOkuePreWFg+e0oA0KICAgICAgICBmdW5jdGlvbiBjcmVhdGVTaGlmdEVsZW1lbnQoc2hpZnQpIHsNCiAgICAgICAgICAgIGNvbnN0IHN0YWZmTWVtYmVyID0gc3RhZmYuZmluZChzID0+IHMuaWQgPT09IHNoaWZ0LnN0YWZmSWQpOw0KICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBsZXQgc2hpZnRDbGFzc2VzID0gYHNoaWZ0LWl0ZW0gJHtzdGFmZk1lbWJlci5yb2xlfWA7DQogICAgICAgICAgICBpZiAoc2hpZnQudHlwZSA9PT0gJ2VtZXJnZW5jeScpIHNoaWZ0Q2xhc3NlcyArPSAnIGVtZXJnZW5jeSc7DQogICAgICAgICAgICBpZiAoc2hpZnQuc3RhdHVzID09PSAnb3ZlcnRpbWUnKSBzaGlmdENsYXNzZXMgKz0gJyBvdmVydGltZSc7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gc2hpZnRDbGFzc2VzOw0KICAgICAgICAgICAgZWxlbWVudC5kcmFnZ2FibGUgPSB0cnVlOw0KICAgICAgICAgICAgZWxlbWVudC5kYXRhc2V0LnNoaWZ0SWQgPSBzaGlmdC5pZDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBjYWxjdWxhdGVTaGlmdER1cmF0aW9uKHNoaWZ0LnN0YXJ0VGltZSwgc2hpZnQuZW5kVGltZSk7DQogICAgICAgICAgICBjb25zdCBzdGF0dXNJY29uID0gc2hpZnQuc3RhdHVzID09PSAnY29uZmlybWVkJyA/ICfinJMnIDogc2hpZnQuc3RhdHVzID09PSAncGVuZGluZycgPyAn4o+zJyA6ICfinYwnOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzaGlmdC1oZWFkZXIiPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzaGlmdC1uYW1lIj4ke3N0YWZmTWVtYmVyLm5hbWV9PC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InNoaWZ0LWFjdGlvbnMiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ic2hpZnQtYWN0aW9uLWJ0biIgb25jbGljaz0iZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7IGVkaXRTaGlmdCgke3NoaWZ0LmlkfSkiIHRpdGxlPSLnt6jovK8iPuKcj++4jzwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0ic2hpZnQtYWN0aW9uLWJ0biIgb25jbGljaz0iZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7IGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IGRlbGV0ZVNoaWZ0KCR7c2hpZnQuaWR9KSIgdGl0bGU9IuWIqumZpCI+8J+Xke+4jzwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzaGlmdC1kZXRhaWxzIj4NCiAgICAgICAgICAgICAgICAgICAgJHtzaGlmdC5zdGFydFRpbWV9LSR7c2hpZnQuZW5kVGltZX0gKCR7ZHVyYXRpb259aCk8YnI+DQogICAgICAgICAgICAgICAgICAgICR7c3RhdHVzSWNvbn0gJHtzaGlmdC5ub3RlcyB8fCAn5LiA6Iis5o6S54+tJ308YnI+DQogICAgICAgICAgICAgICAgICAgIDxzbWFsbD4ke3N0YWZmTWVtYmVyLmRlcGFydG1lbnR9IC0gJHtzdGFmZk1lbWJlci5sZXZlbH08L3NtYWxsPg0KICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgYDsNCg0KICAgICAgICAgICAgLy8g5ouW5ou95LqL5Lu2DQogICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICBkcmFnZ2VkU2hpZnQgPSBzaGlmdDsNCiAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5hZGQoJ2RyYWdnaW5nJyk7DQogICAgICAgICAgICAgICAgZS5kYXRhVHJhbnNmZXIuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJzsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5yZW1vdmUoJ2RyYWdnaW5nJyk7DQogICAgICAgICAgICAgICAgZHJhZ2dlZFNoaWZ0ID0gbnVsbDsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAvLyDpu57mk4rkuovku7bvvIjpmLLmraLmi5bmi73mmYLop7jnmbzvvIkNCiAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgaWYgKCFlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3NoaWZ0LWFjdGlvbi1idG4nKSkgew0KICAgICAgICAgICAgICAgICAgICBzaG93U2hpZnREZXRhaWxzKHNoaWZ0KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDoqIjnrpfmjpLnj63mmYLmlbgNCiAgICAgICAgZnVuY3Rpb24gY2FsY3VsYXRlU2hpZnREdXJhdGlvbihzdGFydFRpbWUsIGVuZFRpbWUpIHsNCiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoYDIwMDAtMDEtMDFUJHtzdGFydFRpbWV9OjAwYCk7DQogICAgICAgICAgICBsZXQgZW5kID0gbmV3IERhdGUoYDIwMDAtMDEtMDFUJHtlbmRUaW1lfTowMGApOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyDomZXnkIbot6jml6Xmg4Xms4ENCiAgICAgICAgICAgIGlmIChlbmQgPCBzdGFydCkgew0KICAgICAgICAgICAgICAgIGVuZC5zZXREYXRlKGVuZC5nZXREYXRlKCkgKyAxKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoKGVuZCAtIHN0YXJ0KSAvICgxMDAwICogNjAgKiA2MCkgKiAxMCkgLyAxMDsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOioreWumuagvOWtkOaLluaUvuWNgOWfnw0KICAgICAgICBmdW5jdGlvbiBzZXR1cENlbGxEcm9wWm9uZShjZWxsKSB7DQogICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAvLyDmqqLmn6XmmK/lkKbmmK/kurrlk6Hmi5bmi73miJbmjpLnj63mi5bmi70NCiAgICAgICAgICAgICAgICBjb25zdCBzdGFmZklkID0gZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgndGV4dC9wbGFpbicpOw0KICAgICAgICAgICAgICAgIGlmIChzdGFmZklkKSB7DQogICAgICAgICAgICAgICAgICAgIGUuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSAnY29weSc7DQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkcmFnZ2VkU2hpZnQpIHsNCiAgICAgICAgICAgICAgICAgICAgZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdtb3ZlJzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdkcm9wLXpvbmUnKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdsZWF2ZScsIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAvLyDlj6rmnInnlbbmu5HpvKDnnJ/mraPpm6LplovmoLzlrZDmmYLmiY3np7vpmaTmqKPlvI8NCiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY29udGFpbnMoZS5yZWxhdGVkVGFyZ2V0KSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3Atem9uZScpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAg',
            'IH0pOw0KDQogICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LnJlbW92ZSgnZHJvcC16b25lJyk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgY29uc3Qgc3RhZmZJZCA9IGUuZGF0YVRyYW5zZmVyLmdldERhdGEoJ3RleHQvcGxhaW4nKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAoc3RhZmZJZCkgew0KICAgICAgICAgICAgICAgICAgICAvLyDkurrlk6Hmi5bmi70gLSDlv6vpgJ/mlrDlop7mjpLnj60NCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhZmZNZW1iZXIgPSBzdGFmZi5maW5kKHMgPT4gcy5pZCA9PSBzdGFmZklkKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YWZmTWVtYmVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBxdWlja0FkZFNoaWZ0RnJvbURyYWcoc3RhZmZNZW1iZXIsIHRoaXMuZGF0YXNldC5kYXRlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZHJhZ2dlZFNoaWZ0KSB7DQogICAgICAgICAgICAgICAgICAgIC8vIOaOkuePreaLluaLvSAtIOenu+WLleaOkuePrQ0KICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdEYXRlID0gdGhpcy5kYXRhc2V0LmRhdGU7DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAvLyDmm7TmlrDmjpLnj63ml6XmnJ8NCiAgICAgICAgICAgICAgICAgICAgZHJhZ2dlZFNoaWZ0LmRhdGUgPSBuZXdEYXRlOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyQ2FsZW5kYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbign5o6S54+t5bey5oiQ5Yqf56e75YuV77yBJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIC8vIOm7nuaTiua3u+WKoOaOkuePrQ0KICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAvLyDpgb/lhY3lnKjmi5bmi73mk43kvZzmmYLop7jnmbzpu57mk4oNCiAgICAgICAgICAgICAgICBpZiAoIWUudGFyZ2V0LmNsb3Nlc3QoJy5zaGlmdC1pdGVtJykpIHsNCiAgICAgICAgICAgICAgICAgICAgb3BlblNoaWZ0TW9kYWwodGhpcy5kYXRhc2V0LmRhdGUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8g5b+r6YCf5paw5aKe5o6S54+t77yI5b6e5ouW5ou977yJDQogICAgICAgIGZ1bmN0aW9uIHF1aWNrQWRkU2hpZnRGcm9tRHJhZyhzdGFmZk1lbWJlciwgZGF0ZSwgaG91cikgew0KICAgICAgICAgICAgLy8g5pyI6KaW5ZyWIC0g6aCQ6Kit5pep54+tDQogICAgICAgICAgICBjb25zdCBzdGFydFRpbWUgPSAnMDg6MDAnOw0KICAgICAgICAgICAgY29uc3QgZW5kVGltZSA9ICcxNjowMCc7DQogICAgICAgICAgICBjb25zdCBzaGlmdFR5cGUgPSAnbW9ybmluZyc7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIOaqouafpeaYr+WQpuW3suacieaOkuePreihneeqgQ0KICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdTaGlmdCA9IHNoaWZ0cy5maW5kKHMgPT4gDQogICAgICAgICAgICAgICAgcy5zdGFmZklkID09PSBzdGFmZk1lbWJlci5pZCAmJiANCiAgICAgICAgICAgICAgICBzLmRhdGUgPT09IGRhdGUgJiYgDQogICAgICAgICAgICAgICAgcy5zdGFydFRpbWUgPT09IHN0YXJ0VGltZQ0KICAgICAgICAgICAgKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGV4aXN0aW5nU2hpZnQpIHsNCiAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKGAke3N0YWZmTWVtYmVyLm5hbWV9IOWcqOipsuaZguauteW3suacieaOkuePre+8gWApOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8g5paw5aKe5o6S54+tDQogICAgICAgICAgICBjb25zdCBuZXdTaGlmdCA9IHsNCiAgICAgICAgICAgICAgICBpZDogRGF0ZS5ub3coKSwNCiAgICAgICAgICAgICAgICBzdGFmZklkOiBzdGFmZk1lbWJlci5pZCwNCiAgICAgICAgICAgICAgICBkYXRlOiBkYXRlLA0KICAgICAgICAgICAgICAgIHN0YXJ0VGltZTogc3RhcnRUaW1lLA0KICAgICAgICAgICAgICAgIGVuZFRpbWU6IGVuZFRpbWUsDQogICAgICAgICAgICAgICAgdHlwZTogc2hpZnRUeXBlLA0KICAgICAgICAgICAgICAgIHN0YXR1czogJ2NvbmZpcm1lZCcsDQogICAgICAgICAgICAgICAgbm90ZXM6ICfmi5bmi73lv6vpgJ/mlrDlop4nDQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBzaGlmdHMucHVzaChuZXdTaGlmdCk7DQogICAgICAgICAgICByZW5kZXJDYWxlbmRhcigpOw0KICAgICAgICAgICAgcmVuZGVyU3RhZmZQYW5lbCgpOyAvLyDmm7TmlrDkurrlk6Hni4DmhYsNCiAgICAgICAgICAgIHVwZGF0ZVN0YXRzKCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHNoaWZ0VHlwZU5hbWUgPSBnZXRTaGlmdFR5cGVOYW1lKHNoaWZ0VHlwZSk7DQogICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKGDlt7LngrogJHtzdGFmZk1lbWJlci5uYW1lfSDmlrDlop4gJHtzaGlmdFR5cGVOYW1lfSAoJHtzdGFydFRpbWV9LSR7ZW5kVGltZX0p77yBYCk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDovJTliqnlh73mlbgNCiAgICAgICAgZnVuY3Rpb24gaXNUb2RheShkYXRlKSB7DQogICAgICAgICAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7DQogICAgICAgICAgICByZXR1cm4gZGF0ZS50b0RhdGVTdHJpbmcoKSA9PT0gdG9kYXkudG9EYXRlU3RyaW5nKCk7DQogICAgICAgIH0NCg0KICAgICAgICBmdW5jdGlvbiBnZXRTaGlmdHNGb3JEYXRlKGRhdGUpIHsNCiAgICAgICAgICAgIGNvbnN0IGRhdGVTdHIgPSBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTsNCiAgICAgICAgICAgIHJldHVybiBzaGlmdHMuZmlsdGVyKHNoaWZ0ID0+IHNoaWZ0LmRhdGUgPT09IGRhdGVTdHIpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8g5riy5p+T5Lq65ZOh6Z2i5p2/DQogICAgICAgIGZ1bmN0aW9uIHJlbmRlclN0YWZmUGFuZWwoKSB7DQogICAgICAgICAgICBjb25zdCBncmlkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YWZmR3JpZCcpOw0KICAgICAgICAgICAgZ3JpZC5pbm5lckhUTUwgPSAnJzsNCg0KICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRTdGFmZiA9IGdldEZpbHRlcmVkU3RhZmYoKTsNCg0KICAgICAgICAgICAgZmlsdGVyZWRTdGFmZi5mb3JFYWNoKG1lbWJlciA9PiB7DQogICAgICAgICAgICAgICAgY29uc3QgY2FyZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICAgICAgICAgIGNhcmQuY2xhc3NOYW1lID0gYHN0YWZmLWNhcmQgJHttZW1iZXIucm9sZX1gOw0KICAgICAgICAgICAgICAgIGNhcmQuZHJhZ2dhYmxlID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBjYXJkLmRhdGFzZXQuc3RhZmZJZCA9IG1lbWJlci5pZDsNCiAgICAgICAgICAgICAgICANCg0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNhcmQuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGFmZi1uYW1lIj4ke21lbWJlci5uYW1lfTwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJkcmFnLWhpbnQiPvCflrHvuI88L2Rpdj4NCiAgICAgICAgICAgICAgICBgOw0KDQogICAgICAgICAgICAgICAgLy8g6Kit5a6a5ouW5ou95LqL5Lu2DQogICAgICAgICAgICAgICAgc2V0dXBTdGFmZkRyYWdFdmVudHMoY2FyZCwgbWVtYmVyKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBncmlkLmFwcGVuZENoaWxkKGNhcmQpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIC8vIOabtOaWsOS6uuWToemBuOaTh+S4i+aLiemBuOWWrg0KICAgICAgICAgICAgdXBkYXRlU3RhZmZTZWxlY3RzKCk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDoqK3lrprkurrlk6Hmi5bmi73kuovku7YNCiAgICAgICAgZnVuY3Rpb24gc2V0dXBTdGFmZkRyYWdFdmVudHMoY2FyZCwgbWVtYmVyKSB7DQogICAgICAgICAgICBsZXQgZHJhZ2dlZFN0YWZmTWVtYmVyID0gbnVsbDsNCg0KICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICAgICAgZHJhZ2dlZFN0YWZmTWVtYmVyID0gbWVtYmVyOw0KICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LmFkZCgnZHJhZ2dpbmcnKTsNCiAgICAgICAgICAgICAgICBlLmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkID0gJ2NvcHknOw0KICAgICAgICAgICAgICAgIGUuZGF0YVRyYW5zZmVyLnNldERhdGEoJ3RleHQvcGxhaW4nLCBtZW1iZXIuaWQpOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIOmrmOS6ruWPr+aUvue9rueahOWNgOWfnw0KICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYWxlbmRhci1jZWxsJykuZm9yRWFjaChjZWxsID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdkcm9wLXRhcmdldCcpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ2dpbmcnKTsNCiAgICAgICAgICAgICAgICBkcmFnZ2VkU3RhZmZNZW1iZXIgPSBudWxsOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIC8vIOenu+mZpOmrmOS6rg0KICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYWxlbmRhci1jZWxsJykuZm9yRWFjaChjZWxsID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wLXRhcmdldCcpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIC8vIOWEsuWtmOWIsOWFqOWfn+iuiuaVuOS+m+WFtuS7luWHveaVuOS9v+eUqA0KICAgICAgICAgICAgY2FyZC5kcmFnZ2VkU3RhZmZNZW1iZXIgPSBtZW1iZXI7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDnjbLlj5bnr6npgbjlvoznmoTkurrlk6ENCiAgICAgICAgZnVuY3Rpb24gZ2V0RmlsdGVyZWRTdGFmZigpIHsNCiAgICAgICAgICAgIGNvbnN0IGZpbHRlciA9IGN1cnJlbnRTdGFmZkZpbHRlciB8fCAnYWxsJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgc3dpdGNoIChmaWx0ZXIpIHsNCiAgICAgICAgICAgICAgICBjYXNlICdkb2N0b3InOg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhZmYuZmlsdGVyKHMgPT4gcy5yb2xlID09PSAnZG9jdG9yJyk7DQogICAgICAgICAgICAgICAgY2FzZSAnbnVyc2UnOg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhZmYuZmlsdGVyKHMgPT4gcy5yb2xlID09PSAnbnVyc2UnKTsNCiAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RhZmY7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyDnjbLlj5bku4rml6Xkurrlk6HmjpLnj60NCiAgICAgICAgZnVuY3Rpb24gZ2V0VG9kYXlTaGlmdHNGb3JTdGFmZihzdGFmZklkKSB7DQogICAgICAgICAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdOw0KICAgICAgICAgICAgcmV0dXJuIHNoaWZ0cy5maWx0ZXIoc2hpZnQgPT4gc2hpZnQuc3RhZmZJZCA9PT0gc3RhZmZJZCAmJiBzaGlmdC5kYXRlID09PSB0b2RheSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDnjbLlj5bkurrlk6Hni4DmhYsNCiAgICAgICAgZnVuY3Rpb24gZ2V0U3RhZmZTdGF0dXMoc3RhZmZJZCwgdG9kYXlTaGlmdHMpIHsNCiAgICAgICAgICAgIGlmICh0b2RheVNoaWZ0cy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICByZXR1cm4geyBjbGFzczogJycsIGljb246ICfinIUnLCB0ZXh0OiAn5Y+v5o6S54+tJyB9Ow0KICAgICAgICAgICAgfSBlbHNlIGlmICh0b2RheVNoaWZ0cy5sZW5ndGggPT09IDEpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4geyBjbGFzczogJ3BhcnRpYWwnLCBpY29uOiAn4o+wJywgdGV4dDogJ+W3suaOkuePrScgfTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHsgY2xhc3M6ICdidXN5JywgaWNvbjogJ/CflLQnLCB0ZXh0OiAn5ru/54+tJyB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8g5pu05paw5Lq65ZOh6YG45pOH5LiL5ouJ6YG45ZauDQogICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVN0YWZmU2VsZWN0cygpIHsNCiAgICAgICAgICAgIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFmZlNlbGVjdCcpOw0KICAgICAgICAgICAgc2VsZWN0LmlubmVySFRNTCA9ICcnOw0KICAgICAgICAgICAgc3RhZmYuZm9yRWFjaChtZW1iZXIgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOw0KICAgICAgICAgICAgICAgIG9wdGlvbi52YWx1ZSA9IG1lbWJlci5pZDsNCiAgICAgICAgICAgICAgICBvcHRpb24udGV4dENvbnRlbnQgPSBgJHttZW1iZXIubmFtZX0gKCR7bWVtYmVyLnJvbGUgPT09ICdkb2N0b3InID8gJ+mGq+W4qycgOiAn6K2355CG5birJ30pYDsNCiAgICAgICAgICAgICAgICBzZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAvLyDmm7TmlrDlm7rlrprmjpLnj63kurrlk6Hpgbjmk4fkuIvmi4npgbjllq4NCiAgICAgICAgICAgIGNvbnN0IGZpeGVkU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpeGVkU3RhZmZTZWxlY3QnKTsNCiAgICAgICAgICAgIGlmIChmaXhlZFNlbGVjdCkgew0KICAgICAgICAgICAgICAgIGZpeGVkU2VsZWN0LmlubmVySFRNTCA9ICcnOw0KICAgICAgICAgICAgICAgIHN0YWZmLmZvckVhY2gobWVtYmVyID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7DQogICAgICAgICAgICAgICAgICAgIG9wdGlvbi52YWx1ZSA9IG1lbWJlci5pZDsNCiAgICAgICAgICAgICAgICAgICAgb3B0aW9uLnRleHRDb250ZW50ID0gYCR7bWVtYmVyLm5hbWV9ICgke21lbWJlci5yb2xlID09PSAnZG9jdG9yJyA/ICfphqvluKsnIDogJ+itt+eQhuW4qyd9KSAtICR7bWVtYmVyLmRlcGFydG1lbnR9YDsNCiAgICAgICAgICAgICAgICAg',
            'ICAgZml4ZWRTZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOaooeaFi+ahhuaTjeS9nA0KICAgICAgICBmdW5jdGlvbiBvcGVuU2hpZnRNb2RhbChkYXRlID0gbnVsbCwgc3RhZmZJZCA9IG51bGwpIHsNCiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaWZ0TW9kYWwnKTsNCiAgICAgICAgICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpZnRGb3JtJyk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIOmHjee9ruihqOWWrg0KICAgICAgICAgICAgZm9ybS5yZXNldCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyDoqK3lrprpoJDoqK3lgLwNCiAgICAgICAgICAgIGlmIChkYXRlKSB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaWZ0RGF0ZScpLnZhbHVlID0gZGF0ZTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaWZ0RGF0ZScpLnZhbHVlID0gY3VycmVudERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoc3RhZmZJZCkgew0KICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFmZlNlbGVjdCcpLnZhbHVlID0gc3RhZmZJZDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8g6Kit5a6a6aCQ6Kit5pmC6ZaTDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhcnRUaW1lJykudmFsdWUgPSAnMDg6MDAnOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VuZFRpbWUnKS52YWx1ZSA9ICcxNjowMCc7DQogICAgICAgICAgICANCiAgICAgICAgICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZ1bmN0aW9uIGNsb3NlTW9kYWwoKSB7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpZnRNb2RhbCcpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOaWsOWinuaOkuePrQ0KICAgICAgICBmdW5jdGlvbiBhZGRTaGlmdCgpIHsNCiAgICAgICAgICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpZnRGb3JtJyk7DQogICAgICAgICAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaGlmdE1vZGFsJyk7DQogICAgICAgICAgICBjb25zdCBlZGl0SWQgPSBtb2RhbC5kYXRhc2V0LmVkaXRJZDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8g6amX6K2J5b+F5aGr5qyE5L2NDQogICAgICAgICAgICBjb25zdCBzdGFmZklkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YWZmU2VsZWN0JykudmFsdWU7DQogICAgICAgICAgICBjb25zdCBkYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaWZ0RGF0ZScpLnZhbHVlOw0KICAgICAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0VGltZScpLnZhbHVlOw0KICAgICAgICAgICAgY29uc3QgZW5kVGltZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlbmRUaW1lJykudmFsdWU7DQogICAgICAgICAgICBjb25zdCB0eXBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaWZ0VHlwZScpLnZhbHVlOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoIXN0YWZmSWQgfHwgIWRhdGUgfHwgIXN0YXJ0VGltZSB8fCAhZW5kVGltZSB8fCAhdHlwZSkgew0KICAgICAgICAgICAgICAgIGFsZXJ0KCfoq4vloavlr6vmiYDmnInlv4XloavmrITkvY3vvIEnKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHNoaWZ0RGF0YSA9IHsNCiAgICAgICAgICAgICAgICBzdGFmZklkOiBwYXJzZUludChzdGFmZklkKSwNCiAgICAgICAgICAgICAgICBkYXRlOiBkYXRlLA0KICAgICAgICAgICAgICAgIHN0YXJ0VGltZTogc3RhcnRUaW1lLA0KICAgICAgICAgICAgICAgIGVuZFRpbWU6IGVuZFRpbWUsDQogICAgICAgICAgICAgICAgdHlwZTogdHlwZSwNCiAgICAgICAgICAgICAgICBzdGF0dXM6ICdjb25maXJtZWQnLA0KICAgICAgICAgICAgICAgIG5vdGVzOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpZnROb3RlcycpID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaWZ0Tm90ZXMnKS52YWx1ZSA6ICcnDQogICAgICAgICAgICB9Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoZWRpdElkKSB7DQogICAgICAgICAgICAgICAgLy8g57eo6Lyv5qih5byPDQogICAgICAgICAgICAgICAgY29uc3Qgc2hpZnRJbmRleCA9IHNoaWZ0cy5maW5kSW5kZXgocyA9PiBzLmlkID09IGVkaXRJZCk7DQogICAgICAgICAgICAgICAgaWYgKHNoaWZ0SW5kZXggIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgIHNoaWZ0c1tzaGlmdEluZGV4XSA9IHsgLi4uc2hpZnRzW3NoaWZ0SW5kZXhdLCAuLi5zaGlmdERhdGEgfTsNCiAgICAgICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbign5o6S54+t5pu05paw5oiQ5Yqf77yBJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGRlbGV0ZSBtb2RhbC5kYXRhc2V0LmVkaXRJZDsNCiAgICAgICAgICAgICAgICBtb2RhbC5xdWVyeVNlbGVjdG9yKCdoMycpLnRleHRDb250ZW50ID0gJ+aWsOWinuaOkuePrSc7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIC8vIOaWsOWinuaooeW8jw0KICAgICAgICAgICAgICAgIGNvbnN0IG5ld1NoaWZ0ID0gew0KICAgICAgICAgICAgICAgICAgICBpZDogRGF0ZS5ub3coKSwNCiAgICAgICAgICAgICAgICAgICAgLi4uc2hpZnREYXRhDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBzaGlmdHMucHVzaChuZXdTaGlmdCk7DQogICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbign5o6S54+t5paw5aKe5oiQ5Yqf77yBJyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIOmHjee9ruihqOWWruS4pumXnOmWieimlueqlw0KICAgICAgICAgICAgZm9ybS5yZXNldCgpOw0KICAgICAgICAgICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyDmm7TmlrDpoa/npLoNCiAgICAgICAgICAgIHJlbmRlckNhbGVuZGFyKCk7DQogICAgICAgICAgICB1cGRhdGVTdGF0cygpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8g5ZCM5q2l5YiwIEdvb2dsZSBDYWxlbmRhcg0KICAgICAgICBmdW5jdGlvbiBzeW5jVG9Hb29nbGUoKSB7DQogICAgICAgICAgICAvLyDlibXlu7ogR29vZ2xlIENhbGVuZGFyIOS6i+S7tuagvOW8jw0KICAgICAgICAgICAgY29uc3QgZXZlbnRzID0gc2hpZnRzLm1hcChzaGlmdCA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhZmYgPSBzdGFmZi5maW5kKHMgPT4gcy5pZCA9PT0gc2hpZnQuc3RhZmZJZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhcnREYXRlVGltZSA9IGAke3NoaWZ0LmRhdGV9VCR7c2hpZnQuc3RhcnRUaW1lfTowMGA7DQogICAgICAgICAgICAgICAgY29uc3QgZW5kRGF0ZVRpbWUgPSBgJHtzaGlmdC5kYXRlfVQke3NoaWZ0LmVuZFRpbWV9OjAwYDsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICB0aXRsZTogYCR7c3RhZmYubmFtZX0gLSAke3N0YWZmLnJvbGUgPT09ICdkb2N0b3InID8gJ+mGq+W4qycgOiAn6K2355CG5birJ33mjpLnj61gLA0KICAgICAgICAgICAgICAgICAgICBzdGFydDogc3RhcnREYXRlVGltZSwNCiAgICAgICAgICAgICAgICAgICAgZW5kOiBlbmREYXRlVGltZSwNCiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGDpg6jploA6ICR7c3RhZmYuZGVwYXJ0bWVudH1cbuePreWIpTogJHtzaGlmdC50eXBlfWANCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIC8vIOeUn+aIkCBHb29nbGUgQ2FsZW5kYXIgVVJMDQogICAgICAgICAgICBjb25zdCBiYXNlVXJsID0gJ2h0dHBzOi8vY2FsZW5kYXIuZ29vZ2xlLmNvbS9jYWxlbmRhci9yZW5kZXI/YWN0aW9uPVRFTVBMQVRFJzsNCiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gZXZlbnRzWzBdOyAvLyDnpLrnr4TnlKjnrKzkuIDlgIvkuovku7YNCiAgICAgICAgICAgIGlmIChldmVudCkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoew0KICAgICAgICAgICAgICAgICAgICB0ZXh0OiBldmVudC50aXRsZSwNCiAgICAgICAgICAgICAgICAgICAgZGF0ZXM6IGAke2V2ZW50LnN0YXJ0LnJlcGxhY2UoL1stOl0vZywgJycpfS8ke2V2ZW50LmVuZC5yZXBsYWNlKC9bLTpdL2csICcnKX1gLA0KICAgICAgICAgICAgICAgICAgICBkZXRhaWxzOiBldmVudC5kZXNjcmlwdGlvbg0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKGAke2Jhc2VVcmx9JiR7cGFyYW1zLnRvU3RyaW5nKCl9YCwgJ19ibGFuaycsICdub29wZW5lcixub3JlZmVycmVyJyk7DQogICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbign5q2j5Zyo6ZaL5ZWfIEdvb2dsZSBDYWxlbmRhci4uLicpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCfmspLmnInmjpLnj63os4fmlpnlj6/lkIzmraUnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOWMr+WHuiBpQ2FsDQogICAgICAgIGZ1bmN0aW9uIGV4cG9ydFRvSUNhbCgpIHsNCiAgICAgICAgICAgIGxldCBpY2FsQ29udGVudCA9IFsNCiAgICAgICAgICAgICAgICAnQkVHSU46VkNBTEVOREFSJywNCiAgICAgICAgICAgICAgICAnVkVSU0lPTjoyLjAnLA0KICAgICAgICAgICAgICAgICdQUk9ESUQ6LS8v6Yar55mC5o6S54+t57O757WxLy/mjpLnj63ooYzkuovmm4YvL1pIJywNCiAgICAgICAgICAgICAgICAnQ0FMU0NBTEU6R1JFR09SSUFOJw0KICAgICAgICAgICAgXTsNCg0KICAgICAgICAgICAgc2hpZnRzLmZvckVhY2goc2hpZnQgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IHN0YWZmTWVtYmVyID0gc3RhZmYuZmluZChzID0+IHMuaWQgPT09IHNoaWZ0LnN0YWZmSWQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0RGF0ZVRpbWUgPSBgJHtzaGlmdC5kYXRlLnJlcGxhY2UoLy0vZywgJycpfVQke3NoaWZ0LnN0YXJ0VGltZS5yZXBsYWNlKCc6JywgJycpfTAwYDsNCiAgICAgICAgICAgICAgICBjb25zdCBlbmREYXRlVGltZSA9IGAke3NoaWZ0LmRhdGUucmVwbGFjZSgvLS9nLCAnJyl9VCR7c2hpZnQuZW5kVGltZS5yZXBsYWNlKCc6JywgJycpfTAwYDsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpY2FsQ29udGVudC5wdXNoKA0KICAgICAgICAgICAgICAgICAgICAnQkVHSU46VkVWRU5UJywNCiAgICAgICAgICAgICAgICAgICAgYFVJRDoke3NoaWZ0LmlkfUBtZWRpY2FsLXNjaGVkdWxlLmNvbWAsDQogICAgICAgICAgICAgICAgICAgIGBEVFNUQVJUOiR7c3RhcnREYXRlVGltZX1gLA0KICAgICAgICAgICAgICAgICAgICBgRFRFTkQ6JHtlbmREYXRlVGltZX1gLA0KICAgICAgICAgICAgICAgICAgICBgU1VNTUFSWToke3N0YWZmTWVtYmVyLm5hbWV9IC0gJHtzdGFmZk1lbWJlci5yb2xlID09PSAnZG9jdG9yJyA/ICfphqvluKsnIDogJ+itt+eQhuW4qyd95o6S54+tYCwNCiAgICAgICAgICAgICAgICAgICAgYERFU0NSSVBUSU9OOumDqOmWgDogJHtzdGFmZk1lbWJlci5kZXBhcnRtZW50fVxcbuePreWIpTogJHtzaGlmdC50eXBlfWAsDQogICAgICAgICAgICAgICAgICAgIGBMT0NBVElPTjrphqvpmaJgLA0KICAgICAgICAgICAgICAgICAgICAnRU5EOlZFVkVOVCcNCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIGljYWxDb250ZW50LnB1c2goJ0VORDpWQ0FMRU5EQVInKTsNCg0KICAgICAgICAgICAgLy8g5Ym15bu65LiL6LyJ6YCj57WQDQogICAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2ljYWxDb250ZW50LmpvaW4oJ1xyXG4nKV0sIHsgdHlwZTogJ3RleHQvY2FsZW5kYXI7Y2hhcnNldD11dGYtOCcgfSk7DQogICAgICAgICAgICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOw0KICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsNCiAgICAgICAgICAgIGxpbmsuaHJlZiA9IHVybDsNCiAgICAgICAgICAgIGxpbmsuZG93bmxvYWQgPSAn6Yar55mC5o6S54+t6KGM5LqL5puGLmljcyc7DQogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOw0KICAgICAgICAgICAgbGluay5jbGljaygpOw0KICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTsNCiAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsNCg0KICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbignaUNhbCDmqpTmoYjlt7LkuIvovInvvIEnKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOaWsOWinuWKn+iDveWHveaVuA0KICAgICAgICANCiAgICAgICAgLy8g5Zue5Yiw5LuK5aSpDQogICAgICAgIGZ1bmN0aW9uIGdvVG9Ub2RheSgpIHsNCiAgICAgICAgICAgIGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTsNCiAgICAgICAgICAgIHVwZGF0ZUN1cnJlbnREYXRlKCk7DQogICAgICAgICAgICByZW5kZXJDYWxlbmRhcigpOw0KICAgICAgICAgICAgdXBkYXRlU3RhdHMoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOaHieeUqOevqemBuA0KICAgICAgICBmdW5jdGlvbiBhcHBseUZpbHRlcnMoKSB7DQogICAgICAgICAgICBjdXJyZW50RmlsdGVycy5kZXBhcnRtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlcGFydG1lbnRGaWx0ZXInKS52YWx1ZTsNCiAgICAgICAgICAgIGN1cnJlbnRGaWx0ZXJzLnJvbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncm9sZUZpbHRlcicpLnZhbHVlOw0KICAgICAgICAgICAgY3VycmVudEZpbHRlcnMuc2hpZnRUeXBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaWZ0VHlwZUZpbHRlcicpLnZhbHVlOw0KICAgICAgICAgICAgY3VycmVudEZpbHRlcnMuc3RhZmZTZWFyY2ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhZmZTZWFyY2gnKS52YWx1ZS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICByZW5kZXJDYWxlbmRhcigpOw0KICAgICAgICAgICAgdXBkYXRlU3RhdHMoKTsNCiAg',
            'ICAgICAgfQ0KDQogICAgICAgIC8vIOaqouafpeaOkuePreaYr+WQpuespuWQiOevqemBuOaineS7tg0KICAgICAgICBmdW5jdGlvbiBwYXNzZXNGaWx0ZXIoc2hpZnQpIHsNCiAgICAgICAgICAgIGNvbnN0IHN0YWZmTWVtYmVyID0gc3RhZmYuZmluZChzID0+IHMuaWQgPT09IHNoaWZ0LnN0YWZmSWQpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoY3VycmVudEZpbHRlcnMuZGVwYXJ0bWVudCAmJiBzdGFmZk1lbWJlci5kZXBhcnRtZW50ICE9PSBjdXJyZW50RmlsdGVycy5kZXBhcnRtZW50KSByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICBpZiAoY3VycmVudEZpbHRlcnMucm9sZSAmJiBzdGFmZk1lbWJlci5yb2xlICE9PSBjdXJyZW50RmlsdGVycy5yb2xlKSByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICBpZiAoY3VycmVudEZpbHRlcnMuc2hpZnRUeXBlICYmIHNoaWZ0LnR5cGUgIT09IGN1cnJlbnRGaWx0ZXJzLnNoaWZ0VHlwZSkgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgaWYgKGN1cnJlbnRGaWx0ZXJzLnN0YWZmU2VhcmNoICYmICFzdGFmZk1lbWJlci5uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoY3VycmVudEZpbHRlcnMuc3RhZmZTZWFyY2gpKSByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8g5pu05paw57Wx6KiI6LOH6KiKDQogICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVN0YXRzKCkgew0KICAgICAgICAgICAgLy8g57Wx6KiI5Yqf6IO95bey56e76Zmk77yM5L+d55WZ5Ye95pW45Lul6YG/5YWN6Yyv6KqkDQogICAgICAgIH0NCg0KDQoNCiAgICAgICAgLy8g5qqi5p+l6KGd56qBDQogICAgICAgIGZ1bmN0aW9uIGNoZWNrQ29uZmxpY3RzKCkgew0KICAgICAgICAgICAgY29uc3QgY29uZmxpY3RzID0gY2hlY2tBbGxDb25mbGljdHMoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGNvbmZsaWN0cy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCfmspLmnInnmbznj77mjpLnj63ooZ3nqoHvvIEnKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGxldCBtZXNzYWdlID0gYOeZvOePviAke2NvbmZsaWN0cy5sZW5ndGh9IOWAi+aOkuePreihneeqge+8mlxuXG5gOw0KICAgICAgICAgICAgY29uZmxpY3RzLmZvckVhY2goKGNvbmZsaWN0LCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IHN0YWZmMSA9IHN0YWZmLmZpbmQocyA9PiBzLmlkID09PSBjb25mbGljdC5zaGlmdDEuc3RhZmZJZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhZmYyID0gc3RhZmYuZmluZChzID0+IHMuaWQgPT09IGNvbmZsaWN0LnNoaWZ0Mi5zdGFmZklkKTsNCiAgICAgICAgICAgICAgICBtZXNzYWdlICs9IGAke2luZGV4ICsgMX0uICR7c3RhZmYxLm5hbWV9IOWcqCAke2NvbmZsaWN0LnNoaWZ0MS5kYXRlfSDmnInph43nlormjpLnj61cbmA7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgYWxlcnQobWVzc2FnZSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDmqqLmn6XmiYDmnInooZ3nqoENCiAgICAgICAgZnVuY3Rpb24gY2hlY2tBbGxDb25mbGljdHMoKSB7DQogICAgICAgICAgICBjb25zdCBjb25mbGljdHMgPSBbXTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlmdHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gaSArIDE7IGogPCBzaGlmdHMubGVuZ3RoOyBqKyspIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2hpZnQxID0gc2hpZnRzW2ldOw0KICAgICAgICAgICAgICAgICAgICBjb25zdCBzaGlmdDIgPSBzaGlmdHNbal07DQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBpZiAoc2hpZnQxLnN0YWZmSWQgPT09IHNoaWZ0Mi5zdGFmZklkICYmIHNoaWZ0MS5kYXRlID09PSBzaGlmdDIuZGF0ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnQxID0gbmV3IERhdGUoYDIwMDAtMDEtMDFUJHtzaGlmdDEuc3RhcnRUaW1lfTowMGApOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kMSA9IG5ldyBEYXRlKGAyMDAwLTAxLTAxVCR7c2hpZnQxLmVuZFRpbWV9OjAwYCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydDIgPSBuZXcgRGF0ZShgMjAwMC0wMS0wMVQke3NoaWZ0Mi5zdGFydFRpbWV9OjAwYCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmQyID0gbmV3IERhdGUoYDIwMDAtMDEtMDFUJHtzaGlmdDIuZW5kVGltZX06MDBgKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0MSA8IGVuZDIgJiYgc3RhcnQyIDwgZW5kMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZsaWN0cy5wdXNoKHsgc2hpZnQxLCBzaGlmdDIgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIHJldHVybiBjb25mbGljdHM7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDmuIXnqbrmiYDmnInmjpLnj60NCiAgICAgICAgZnVuY3Rpb24gY2xlYXJBbGxTaGlmdHMoKSB7DQogICAgICAgICAgICBpZiAoY29uZmlybSgn56K65a6a6KaB5riF56m65omA5pyJ5o6S54+t5ZeO77yf5q2k5pON5L2c54Sh5rOV5b6p5Y6f44CCJykpIHsNCiAgICAgICAgICAgICAgICBzaGlmdHMgPSBbXTsNCiAgICAgICAgICAgICAgICByZW5kZXJDYWxlbmRhcigpOw0KICAgICAgICAgICAgICAgIHVwZGF0ZVN0YXRzKCk7DQogICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbign5omA5pyJ5o6S54+t5bey5riF56m677yBJyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyDnt6jovK/mjpLnj60NCiAgICAgICAgZnVuY3Rpb24gZWRpdFNoaWZ0KHNoaWZ0SWQpIHsNCiAgICAgICAgICAgIGNvbnN0IHNoaWZ0ID0gc2hpZnRzLmZpbmQocyA9PiBzLmlkID09PSBzaGlmdElkKTsNCiAgICAgICAgICAgIGlmICghc2hpZnQpIHJldHVybjsNCg0KICAgICAgICAgICAgLy8g5aGr5YWl54++5pyJ6LOH5paZ5Yiw6KGo5ZauDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RhZmZTZWxlY3QnKS52YWx1ZSA9IHNoaWZ0LnN0YWZmSWQ7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpZnREYXRlJykudmFsdWUgPSBzaGlmdC5kYXRlOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0YXJ0VGltZScpLnZhbHVlID0gc2hpZnQuc3RhcnRUaW1lOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VuZFRpbWUnKS52YWx1ZSA9IHNoaWZ0LmVuZFRpbWU7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpZnRUeXBlJykudmFsdWUgPSBzaGlmdC50eXBlOw0KDQogICAgICAgICAgICAvLyDmqJnoqJjngrrnt6jovK/mqKHlvI8NCiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoaWZ0TW9kYWwnKTsNCiAgICAgICAgICAgIG1vZGFsLmRhdGFzZXQuZWRpdElkID0gc2hpZnRJZDsNCiAgICAgICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJ2gzJykudGV4dENvbnRlbnQgPSAn57eo6Lyv5o6S54+tJzsNCiAgICAgICAgICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOWIqumZpOaOkuePrQ0KICAgICAgICBmdW5jdGlvbiBkZWxldGVTaGlmdChzaGlmdElkKSB7DQogICAgICAgICAgICAvLyDlvLfliLblgZzmraLkuovku7blgrPmkq0NCiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8g542y5Y+W5o6S54+t6LOH6KiK55So5pa856K66KqN5bCN6Kmx5qGGDQogICAgICAgICAgICBjb25zdCBzaGlmdCA9IHNoaWZ0cy5maW5kKHMgPT4gcy5pZCA9PSBzaGlmdElkKTsNCiAgICAgICAgICAgIGlmICghc2hpZnQpIHsNCiAgICAgICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKCfmib7kuI3liLDopoHliKrpmaTnmoTmjpLnj63vvIEnKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvbnN0IHN0YWZmTWVtYmVyID0gc3RhZmYuZmluZChzID0+IHMuaWQgPT09IHNoaWZ0LnN0YWZmSWQpOw0KICAgICAgICAgICAgY29uc3QgY29uZmlybU1lc3NhZ2UgPSBg56K65a6a6KaB5Yiq6Zmk5Lul5LiL5o6S54+t5ZeO77yfXG5cbmAgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYOS6uuWToe+8miR7c3RhZmZNZW1iZXIubmFtZX1cbmAgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYOaXpeacn++8miR7c2hpZnQuZGF0ZX1cbmAgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYOaZgumWk++8miR7c2hpZnQuc3RhcnRUaW1lfSAtICR7c2hpZnQuZW5kVGltZX1cbmAgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYOWCmeiou++8miR7c2hpZnQubm90ZXMgfHwgJ+eEoSd9XG5cbmAgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYOatpOaTjeS9nOeEoeazleW+qeWOn++8gWA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIChjb25maXJtKGNvbmZpcm1NZXNzYWdlKSkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHNoaWZ0SW5kZXggPSBzaGlmdHMuZmluZEluZGV4KHMgPT4gcy5pZCA9PSBzaGlmdElkKTsNCiAgICAgICAgICAgICAgICBpZiAoc2hpZnRJbmRleCAhPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgc2hpZnRzLnNwbGljZShzaGlmdEluZGV4LCAxKTsNCiAgICAgICAgICAgICAgICAgICAgcmVuZGVyQ2FsZW5kYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgdXBkYXRlU3RhdHMoKTsNCiAgICAgICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbign5o6S54+t5bey5Yiq6Zmk77yBJyk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbign5Yiq6Zmk5aSx5pWX77ya5om+5LiN5Yiw5o6S54+t6LOH5paZ77yBJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8g6aGv56S65o6S54+t6Kmz5oOFDQogICAgICAgIGZ1bmN0aW9uIHNob3dTaGlmdERldGFpbHMoc2hpZnQpIHsNCiAgICAgICAgICAgIGNvbnN0IHN0YWZmTWVtYmVyID0gc3RhZmYuZmluZChzID0+IHMuaWQgPT09IHNoaWZ0LnN0YWZmSWQpOw0KICAgICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBjYWxjdWxhdGVTaGlmdER1cmF0aW9uKHNoaWZ0LnN0YXJ0VGltZSwgc2hpZnQuZW5kVGltZSk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGFsZXJ0KGDmjpLnj63oqbPmg4XvvJoNCuWnk+WQje+8miR7c3RhZmZNZW1iZXIubmFtZX0NCuiBt+S9je+8miR7c3RhZmZNZW1iZXIubGV2ZWx9DQrpg6jploDvvJoke3N0YWZmTWVtYmVyLmRlcGFydG1lbnR9DQrml6XmnJ/vvJoke3NoaWZ0LmRhdGV9DQrmmYLplpPvvJoke3NoaWZ0LnN0YXJ0VGltZX0gLSAke3NoaWZ0LmVuZFRpbWV9ICgke2R1cmF0aW9ufSDlsI/mmYIpDQrni4DmhYvvvJoke3NoaWZ0LnN0YXR1cyA9PT0gJ2NvbmZpcm1lZCcgPyAn5bey56K66KqNJyA6IHNoaWZ0LnN0YXR1cyA9PT0gJ3BlbmRpbmcnID8gJ+W+heeiuuiqjScgOiAn5bey5Y+W5raIJ30NCuWCmeiou++8miR7c2hpZnQubm90ZXMgfHwgJ+eEoSd9DQroga/ntaHpm7voqbHvvJoke3N0YWZmTWVtYmVyLnBob25lfQ0K6Zu75a2Q6YO15Lu277yaJHtzdGFmZk1lbWJlci5lbWFpbH1gKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOagueaTmklE6aGv56S65o6S54+t6Kmz5oOFDQogICAgICAgIGZ1bmN0aW9uIHNob3dTaGlmdERldGFpbHNCeUlkKHNoaWZ0SWQpIHsNCiAgICAgICAgICAgIGNvbnN0IHNoaWZ0ID0gc2hpZnRzLmZpbmQocyA9PiBzLmlkID09PSBzaGlmdElkKTsNCiAgICAgICAgICAgIGlmIChzaGlmdCkgew0KICAgICAgICAgICAgICAgIHNob3dTaGlmdERldGFpbHMoc2hpZnQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8g5YiX5Y2w5o6S54+t6KGoDQogICAgICAgIGZ1bmN0aW9uIHByaW50U2NoZWR1bGUoKSB7DQogICAgICAgICAgICBjb25zdCBwcmludFdpbmRvdyA9IHdpbmRvdy5vcGVuKCcnLCAnX2JsYW5rJywgJ25vb3BlbmVyLG5vcmVmZXJyZXInKTsNCiAgICAgICAgICAgIGNvbnN0IHByaW50Q29udGVudCA9IGdlbmVyYXRlUHJpbnRDb250ZW50KCk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHByaW50V2luZG93LmRvY3VtZW50LndyaXRlKGANCiAgICAgICAgICAgICAgICA8aHRtbD4NCiAgICAgICAgICAgICAgICA8aGVhZD4NCiAgICAgICAgICAgICAgICAgICAgPHRpdGxlPumGq+eZguaOkuePreihqDwvdGl0bGU+DQogICAgICAgICAgICAgICAgICAgIDxzdHlsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHkgeyBmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IG1hcmdpbjogMjBweDsgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUgeyB3aWR0aDogMTAwJTsgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsgbWFyZ2luLXRvcDogMjBweDsgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgdGgsIHRkIHsgYm9yZGVyOiAxcHggc29saWQgI2RkZDsgcGFkZGluZzogOHB4OyB0ZXh0LWFsaWduOiBsZWZ0OyB9DQogICAgICAgICAgICAgICAgICAgICAgICB0aCB7IGJhY2tncm91bmQtY29sb3I6ICNmMmYyZjI7IH0NCiAgICAgICAgICAgICAgICAgICAgICAgIC5oZWFkZXIgeyB0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi1ib3R0b206IDIwcHg7IH0NCiAgICAgICAgICAgICAgICAgICAgICAgIC5zaGlmdC1kb2N0b3IgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjZThmNWU4OyB9DQogICAgICAgICAgICAgICAgICAgICAgICAuc2hpZnQtbnVyc2UgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmM2UwOyB9DQogICAgICAgICAgICAgICAgICAgICAgICBAbWVkaWEgcHJpbnQgeyBib2R5IHsgbWFyZ2luOiAwOyB9IH0NCiAgICAgICAgICAgICAgICAgICAgPC9zdHlsZT4NCiAgICAgICAgICAgICAgICA8L2hlYWQ+DQogICAgICAgICAgICAgICAgPGJvZHk+DQogICAgICAgICAgICAgICAgICAgICR7cHJpbnRDb250ZW50fQ0KICAgICAgICAgICAgICAgIDwvYm9keT4NCiAgICAgICAgICAgICAgICA8L2h0bWw+DQogICAgICAgICAgICBgKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAg',
            'cHJpbnRXaW5kb3cuZG9jdW1lbnQuY2xvc2UoKTsNCiAgICAgICAgICAgIHByaW50V2luZG93LnByaW50KCk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDnlJ/miJDliJfljbDlhaflrrkNCiAgICAgICAgZnVuY3Rpb24gZ2VuZXJhdGVQcmludENvbnRlbnQoKSB7DQogICAgICAgICAgICBjb25zdCBjdXJyZW50TW9udGggPSBjdXJyZW50RGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ3poLVRXJywgeyB5ZWFyOiAnbnVtZXJpYycsIG1vbnRoOiAnbG9uZycgfSk7DQogICAgICAgICAgICBsZXQgY29udGVudCA9IGANCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJoZWFkZXIiPg0KICAgICAgICAgICAgICAgICAgICA8aDE+6Yar55mC5o6S54+t6KGoPC9oMT4NCiAgICAgICAgICAgICAgICAgICAgPGgyPiR7Y3VycmVudE1vbnRofTwvaDI+DQogICAgICAgICAgICAgICAgICAgIDxwPuWIl+WNsOaZgumWk++8miR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygnemgtVFcnKX08L3A+DQogICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgPHRhYmxlPg0KICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICAgICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPuaXpeacnzwvdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPuWnk+WQjTwvdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPuiBt+S9jTwvdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPumDqOmWgDwvdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPuePreWIpTwvdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPuaZgumWkzwvdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPueLgOaFizwvdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoPuWCmeiouzwvdGg+DQogICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICA8L3RoZWFkPg0KICAgICAgICAgICAgICAgICAgICA8dGJvZHk+DQogICAgICAgICAgICBgOw0KDQogICAgICAgICAgICBjb25zdCBzb3J0ZWRTaGlmdHMgPSBzaGlmdHMNCiAgICAgICAgICAgICAgICAuZmlsdGVyKHBhc3Nlc0ZpbHRlcikNCiAgICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYS5kYXRlKSAtIG5ldyBEYXRlKGIuZGF0ZSkpOw0KDQogICAgICAgICAgICBzb3J0ZWRTaGlmdHMuZm9yRWFjaChzaGlmdCA9PiB7DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhZmZNZW1iZXIgPSBzdGFmZi5maW5kKHMgPT4gcy5pZCA9PT0gc2hpZnQuc3RhZmZJZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhdHVzVGV4dCA9IHNoaWZ0LnN0YXR1cyA9PT0gJ2NvbmZpcm1lZCcgPyAn5bey56K66KqNJyA6IHNoaWZ0LnN0YXR1cyA9PT0gJ3BlbmRpbmcnID8gJ+W+heeiuuiqjScgOiAn5bey5Y+W5raIJzsNCiAgICAgICAgICAgICAgICBjb25zdCByb3dDbGFzcyA9IHN0YWZmTWVtYmVyLnJvbGUgPT09ICdkb2N0b3InID8gJ3NoaWZ0LWRvY3RvcicgOiAnc2hpZnQtbnVyc2UnOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYA0KICAgICAgICAgICAgICAgICAgICA8dHIgY2xhc3M9IiR7cm93Q2xhc3N9Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD4ke3NoaWZ0LmRhdGV9PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD4ke3N0YWZmTWVtYmVyLm5hbWV9PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD4ke3N0YWZmTWVtYmVyLmxldmVsfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICA8dGQ+JHtzdGFmZk1lbWJlci5kZXBhcnRtZW50fTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICA8dGQ+JHtnZXRTaGlmdFR5cGVOYW1lKHNoaWZ0LnR5cGUpfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICA8dGQ+JHtzaGlmdC5zdGFydFRpbWV9IC0gJHtzaGlmdC5lbmRUaW1lfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICA8dGQ+JHtzdGF0dXNUZXh0fTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICA8dGQ+JHtzaGlmdC5ub3RlcyB8fCAnJ308L3RkPg0KICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgIGA7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgY29udGVudCArPSBgDQogICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgIGA7DQoNCiAgICAgICAgICAgIHJldHVybiBjb250ZW50Ow0KICAgICAgICB9DQoNCiAgICAgICAgLy8g542y5Y+W54+t5Yil5ZCN56ixDQogICAgICAgIGZ1bmN0aW9uIGdldFNoaWZ0VHlwZU5hbWUodHlwZSkgew0KICAgICAgICAgICAgY29uc3QgdHlwZXMgPSB7DQogICAgICAgICAgICAgICAgJ21vcm5pbmcnOiAn5pep54+tJywNCiAgICAgICAgICAgICAgICAnYWZ0ZXJub29uJzogJ+S4reePrScsDQogICAgICAgICAgICAgICAgJ25pZ2h0JzogJ+WknOePrScsDQogICAgICAgICAgICAgICAgJ2VtZXJnZW5jeSc6ICfmgKXoqLonLA0KICAgICAgICAgICAgICAgICdjdXN0b20nOiAn6Ieq6KiCJw0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHJldHVybiB0eXBlc1t0eXBlXSB8fCB0eXBlOw0KICAgICAgICB9DQoNCg0KDQogICAgICAgIC8vIOmhr+ekuumAmuefpQ0KICAgICAgICBmdW5jdGlvbiBzaG93Tm90aWZpY2F0aW9uKG1lc3NhZ2UpIHsNCiAgICAgICAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub3RpZmljYXRpb24nKTsNCiAgICAgICAgICAgIG5vdGlmaWNhdGlvbi50ZXh0Q29udGVudCA9IG1lc3NhZ2U7DQogICAgICAgICAgICBub3RpZmljYXRpb24uY2xhc3NMaXN0LmFkZCgnc2hvdycpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOw0KICAgICAgICAgICAgfSwgMzAwMCk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyDlm7rlrprmjpLnj63lip/og70NCiAgICAgICAgDQogICAgICAgIC8vIOmWi+WVn+WbuuWumuaOkuePreaooeaFi+ahhg0KICAgICAgICBmdW5jdGlvbiBvcGVuRml4ZWRTY2hlZHVsZU1vZGFsKCkgew0KICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZml4ZWRTY2hlZHVsZU1vZGFsJyk7DQogICAgICAgICAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpeGVkU2NoZWR1bGVGb3JtJyk7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIOmHjee9ruihqOWWrg0KICAgICAgICAgICAgZm9ybS5yZXNldCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyDoqK3lrprpoJDoqK3lgLwNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaXhlZFNoaWZ0VHlwZScpLnZhbHVlID0gJ21vcm5pbmcnOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpeGVkU3RhcnRUaW1lJykudmFsdWUgPSAnMDg6MDAnOw0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpeGVkRW5kVGltZScpLnZhbHVlID0gJzE2OjAwJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2hlZHVsZVJhbmdlJykudmFsdWUgPSAnY3VycmVudC1tb250aCc7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZml4ZWRTY2hlZHVsZU5vdGVzJykudmFsdWUgPSAn5Zu65a6a5LiK54+t5o6S56iLJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8g6aCQ6Kit6YG45pOH6YCx5LiA5Yiw6YCx5LqUDQogICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSA1OyBpKyspIHsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgZGF5JHtpfWApLmNoZWNrZWQgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RheTAnKS5jaGVja2VkID0gZmFsc2U7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF5NicpLmNoZWNrZWQgPSBmYWxzZTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8g6Zqx6JeP6Ieq6KiC5pmC6ZaT5ZKM5pel5pyf56+E5ZyNDQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VzdG9tVGltZUdyb3VwJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21SYW5nZUdyb3VwJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgbW9kYWwuY2xhc3NMaXN0LmFkZCgnc2hvdycpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8g6Zec6ZaJ5Zu65a6a5o6S54+t5qih5oWL5qGGDQogICAgICAgIGZ1bmN0aW9uIGNsb3NlRml4ZWRTY2hlZHVsZU1vZGFsKCkgew0KICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpeGVkU2NoZWR1bGVNb2RhbCcpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOW7uueri+WbuuWumuaOkuePrQ0KICAgICAgICBmdW5jdGlvbiBjcmVhdGVGaXhlZFNjaGVkdWxlKCkgew0KICAgICAgICAgICAgY29uc3Qgc3RhZmZJZCA9IHBhcnNlSW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaXhlZFN0YWZmU2VsZWN0JykudmFsdWUpOw0KICAgICAgICAgICAgY29uc3Qgc2hpZnRUeXBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpeGVkU2hpZnRUeXBlJykudmFsdWU7DQogICAgICAgICAgICBjb25zdCBzY2hlZHVsZVJhbmdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjaGVkdWxlUmFuZ2UnKS52YWx1ZTsNCiAgICAgICAgICAgIGNvbnN0IG5vdGVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpeGVkU2NoZWR1bGVOb3RlcycpLnZhbHVlOw0KICAgICAgICAgICAgY29uc3QgcmVwbGFjZUV4aXN0aW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlcGxhY2VFeGlzdGluZycpLmNoZWNrZWQ7DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIOeNsuWPlumBuOaTh+eahOW3peS9nOaXpQ0KICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWREYXlzID0gW107DQogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDc7IGkrKykgew0KICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgZGF5JHtpfWApLmNoZWNrZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWREYXlzLnB1c2goaSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoc2VsZWN0ZWREYXlzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgIGFsZXJ0KCfoq4voh7PlsJHpgbjmk4fkuIDlgIvlt6XkvZzml6XvvIEnKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIOeNsuWPluaZgumWkw0KICAgICAgICAgICAgbGV0IHN0YXJ0VGltZSwgZW5kVGltZTsNCiAgICAgICAgICAgIGlmIChzaGlmdFR5cGUgPT09ICdjdXN0b20nKSB7DQogICAgICAgICAgICAgICAgc3RhcnRUaW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpeGVkU3RhcnRUaW1lJykudmFsdWU7DQogICAgICAgICAgICAgICAgZW5kVGltZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaXhlZEVuZFRpbWUnKS52YWx1ZTsNCiAgICAgICAgICAgICAgICBpZiAoIXN0YXJ0VGltZSB8fCAhZW5kVGltZSkgew0KICAgICAgICAgICAgICAgICAgICBhbGVydCgn6KuL6Kit5a6a6Ieq6KiC5pmC6ZaT77yBJyk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVNYXAgPSB7DQogICAgICAgICAgICAgICAgICAgICdtb3JuaW5nJzogeyBzdGFydDogJzA4OjAwJywgZW5kOiAnMTY6MDAnIH0sDQogICAgICAgICAgICAgICAgICAgICdhZnRlcm5vb24nOiB7IHN0YXJ0OiAnMTY6MDAnLCBlbmQ6ICcyNDowMCcgfSwNCiAgICAgICAgICAgICAgICAgICAgJ25pZ2h0JzogeyBzdGFydDogJzAwOjAwJywgZW5kOiAnMDg6MDAnIH0NCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIHN0YXJ0VGltZSA9IHRpbWVNYXBbc2hpZnRUeXBlXS5zdGFydDsNCiAgICAgICAgICAgICAgICBlbmRUaW1lID0gdGltZU1hcFtzaGlmdFR5cGVdLmVuZDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8g542y5Y+W5pel5pyf56+E5ZyNDQogICAgICAgICAgICBsZXQgc3RhcnREYXRlLCBlbmREYXRlOw0KICAgICAgICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBzd2l0Y2ggKHNjaGVkdWxlUmFuZ2UpIHsNCiAgICAgICAgICAgICAgICBjYXNlICdjdXJyZW50LW1vbnRoJzoNCiAgICAgICAgICAgICAgICAgICAgc3RhcnREYXRlID0gbmV3IERhdGUoY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSwgY3VycmVudERhdGUuZ2V0TW9udGgoKSwgMSk7DQogICAgICAgICAgICAgICAgICAgIGVuZERhdGUgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLCBjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMSwgMCk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJ25leHQtbW9udGgnOg0KICAgICAgICAgICAgICAgICAgICBzdGFydERhdGUgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLCBjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMSwgMSk7DQogICAgICAgICAgICAgICAgICAgIGVuZERhdGUgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLCBjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMiwgMCk7DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIGNhc2UgJ2N1cnJlbnQtYW5kLW5leHQnOg0KICAgICAgICAgICAgICAgICAgICBzdGFydERhdGUgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLCBjdXJyZW50RGF0ZS5nZXRNb250aCgpLCAxKTsNCiAgICAgICAgICAgICAgICAgICAgZW5kRGF0ZSA9IG5ldyBEYXRlKGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCksIGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAyLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAnY3VzdG9tLXJhbmdlJzoNCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnREYXRlU3RyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JhbmdlU3RhcnRE',
            'YXRlJykudmFsdWU7DQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGVuZERhdGVTdHIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmFuZ2VFbmREYXRlJykudmFsdWU7DQogICAgICAgICAgICAgICAgICAgIGlmICghc3RhcnREYXRlU3RyIHx8ICFlbmREYXRlU3RyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgn6KuL6Kit5a6a6Ieq6KiC5pel5pyf56+E5ZyN77yBJyk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgc3RhcnREYXRlID0gbmV3IERhdGUoc3RhcnREYXRlU3RyKTsNCiAgICAgICAgICAgICAgICAgICAgZW5kRGF0ZSA9IG5ldyBEYXRlKGVuZERhdGVTdHIpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgLy8g55Sf5oiQ5o6S54+tDQogICAgICAgICAgICBjb25zdCBuZXdTaGlmdHMgPSBbXTsNCiAgICAgICAgICAgIGxldCBzaGlmdElkQ291bnRlciA9IERhdGUubm93KCk7DQogICAgICAgICAgICBsZXQgYWRkZWRDb3VudCA9IDA7DQogICAgICAgICAgICBsZXQgcmVwbGFjZWRDb3VudCA9IDA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGZvciAobGV0IGRhdGUgPSBuZXcgRGF0ZShzdGFydERhdGUpOyBkYXRlIDw9IGVuZERhdGU7IGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSArIDEpKSB7DQogICAgICAgICAgICAgICAgY29uc3QgZGF5T2ZXZWVrID0gZGF0ZS5nZXREYXkoKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWREYXlzLmluY2x1ZGVzKGRheU9mV2VlaykpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IGRhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdOw0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgLy8g5qqi5p+l5piv5ZCm5bey5pyJ5o6S54+tDQogICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nU2hpZnRJbmRleCA9IHNoaWZ0cy5maW5kSW5kZXgocyA9PiANCiAgICAgICAgICAgICAgICAgICAgICAgIHMuc3RhZmZJZCA9PT0gc3RhZmZJZCAmJiBzLmRhdGUgPT09IGRhdGVTdHINCiAgICAgICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ1NoaWZ0SW5kZXggIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVwbGFjZUV4aXN0aW5nKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5pu/5o+b54++5pyJ5o6S54+tDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hpZnRzW2V4aXN0aW5nU2hpZnRJbmRleF0gPSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnNoaWZ0c1tleGlzdGluZ1NoaWZ0SW5kZXhdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWU6IHN0YXJ0VGltZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kVGltZTogZW5kVGltZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogc2hpZnRUeXBlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3Rlczogbm90ZXMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VkQ291bnQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOS4jeabv+aPm++8jOi3s+mBjumAmeS4gOWkqQ0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8g5paw5aKe5o6S54+tDQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdTaGlmdCA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogc2hpZnRJZENvdW50ZXIrKywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFmZklkOiBzdGFmZklkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGU6IGRhdGVTdHIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBzdGFydFRpbWUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kVGltZTogZW5kVGltZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBzaGlmdFR5cGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAnY29uZmlybWVkJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3Rlczogbm90ZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgICAgICBzaGlmdHMucHVzaChuZXdTaGlmdCk7DQogICAgICAgICAgICAgICAgICAgICAgICBhZGRlZENvdW50Kys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICAgIC8vIOabtOaWsOmhr+ekug0KICAgICAgICAgICAgcmVuZGVyQ2FsZW5kYXIoKTsNCiAgICAgICAgICAgIHVwZGF0ZVN0YXRzKCk7DQogICAgICAgICAgICBjbG9zZUZpeGVkU2NoZWR1bGVNb2RhbCgpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyDpoa/npLrntZDmnpwNCiAgICAgICAgICAgIGNvbnN0IHN0YWZmTWVtYmVyID0gc3RhZmYuZmluZChzID0+IHMuaWQgPT09IHN0YWZmSWQpOw0KICAgICAgICAgICAgbGV0IG1lc3NhZ2UgPSBg5Zu65a6a5o6S54+t5bu656uL5a6M5oiQ77yBXG5cbmA7DQogICAgICAgICAgICBtZXNzYWdlICs9IGDkurrlk6HvvJoke3N0YWZmTWVtYmVyLm5hbWV9XG5gOw0KICAgICAgICAgICAgbWVzc2FnZSArPSBg5paw5aKe5o6S54+t77yaJHthZGRlZENvdW50fSDlpKlcbmA7DQogICAgICAgICAgICBpZiAocmVwbGFjZWRDb3VudCA+IDApIHsNCiAgICAgICAgICAgICAgICBtZXNzYWdlICs9IGDmm7/mj5vmjpLnj63vvJoke3JlcGxhY2VkQ291bnR9IOWkqVxuYDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG1lc3NhZ2UgKz0gYOaZgumWk++8miR7c3RhcnRUaW1lfSAtICR7ZW5kVGltZX1cbmA7DQogICAgICAgICAgICBtZXNzYWdlICs9IGDlt6XkvZzml6XvvJoke3NlbGVjdGVkRGF5cy5tYXAoZCA9PiBbJ+aXpScsJ+S4gCcsJ+S6jCcsJ+S4iScsJ+WbmycsJ+S6lCcsJ+WFrSddW2RdKS5qb2luKCfjgIEnKX1gOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBzaG93Tm90aWZpY2F0aW9uKGDlt7LngrogJHtzdGFmZk1lbWJlci5uYW1lfSDlu7rnq4vlm7rlrprmjpLnj63vvIHmlrDlop4gJHthZGRlZENvdW50fSDlpKkke3JlcGxhY2VkQ291bnQgPiAwID8gYO+8jOabv+aPmyAke3JlcGxhY2VkQ291bnR9IOWkqWAgOiAnJ33jgIJgKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOm7nuaTiuaooeaFi+ahhuWklumDqOmXnOmWiQ0KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hpZnRNb2RhbCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgaWYgKGUudGFyZ2V0ID09PSB0aGlzKSB7DQogICAgICAgICAgICAgICAgY2xvc2VNb2RhbCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCg0KICAgICAgICAvLyDpu57mk4rlm7rlrprmjpLnj63mqKHmhYvmoYblpJbpg6jpl5zplokNCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpeGVkU2NoZWR1bGVNb2RhbCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgaWYgKGUudGFyZ2V0ID09PSB0aGlzKSB7DQogICAgICAgICAgICAgICAgY2xvc2VGaXhlZFNjaGVkdWxlTW9kYWwoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy8g5Lq65ZOh56+p6YG45Yqf6IO9DQogICAgICAgIGZ1bmN0aW9uIGZpbHRlclN0YWZmKGZpbHRlcikgew0KICAgICAgICAgICAgY3VycmVudFN0YWZmRmlsdGVyID0gZmlsdGVyOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyDmm7TmlrDmjInpiJXni4DmhYsNCiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zdGFmZi1maWx0ZXItYnRuJykuZm9yRWFjaChidG4gPT4gew0KICAgICAgICAgICAgICAgIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICAvLyDph43mlrDmuLLmn5Pkurrlk6HpnaLmnb8NCiAgICAgICAgICAgIHJlbmRlclN0YWZmUGFuZWwoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIOafpeeci+S6uuWToeaOkuePrQ0KICAgICAgICBmdW5jdGlvbiB2aWV3U3RhZmZTY2hlZHVsZShzdGFmZklkKSB7DQogICAgICAgICAgICBjb25zdCBzdGFmZk1lbWJlciA9IHN0YWZmLmZpbmQocyA9PiBzLmlkID09PSBzdGFmZklkKTsNCiAgICAgICAgICAgIGNvbnN0IHN0YWZmU2hpZnRzID0gc2hpZnRzLmZpbHRlcihzID0+IHMuc3RhZmZJZCA9PT0gc3RhZmZJZCkNCiAgICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYS5kYXRlKSAtIG5ldyBEYXRlKGIuZGF0ZSkpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoc3RhZmZTaGlmdHMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgYWxlcnQoYCR7c3RhZmZNZW1iZXIubmFtZX0g55uu5YmN5rKS5pyJ5o6S54+t6KiY6YyE44CCYCk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBsZXQgc2NoZWR1bGVUZXh0ID0gYCR7c3RhZmZNZW1iZXIubmFtZX0g55qE5o6S54+t6KiY6YyE77yaXG5cbmA7DQogICAgICAgICAgICBzdGFmZlNoaWZ0cy5mb3JFYWNoKHNoaWZ0ID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoc2hpZnQuZGF0ZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCd6aC1UVycpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGR1cmF0aW9uID0gY2FsY3VsYXRlU2hpZnREdXJhdGlvbihzaGlmdC5zdGFydFRpbWUsIHNoaWZ0LmVuZFRpbWUpOw0KICAgICAgICAgICAgICAgIHNjaGVkdWxlVGV4dCArPSBg8J+ThSAke2RhdGV9ICR7c2hpZnQuc3RhcnRUaW1lfS0ke3NoaWZ0LmVuZFRpbWV9ICgke2R1cmF0aW9ufWgpIC0gJHtnZXRTaGlmdFR5cGVOYW1lKHNoaWZ0LnR5cGUpfVxuYDsNCiAgICAgICAgICAgICAgICBpZiAoc2hpZnQubm90ZXMpIHNjaGVkdWxlVGV4dCArPSBgICAg5YKZ6Ki7OiAke3NoaWZ0Lm5vdGVzfVxuYDsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBhbGVydChzY2hlZHVsZVRleHQpOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8g6IGv57Wh5Lq65ZOhDQogICAgICAgIGZ1bmN0aW9uIGNvbnRhY3RTdGFmZihzdGFmZklkKSB7DQogICAgICAgICAgICBjb25zdCBzdGFmZk1lbWJlciA9IHN0YWZmLmZpbmQocyA9PiBzLmlkID09PSBzdGFmZklkKTsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRhY3RJbmZvID0gYOiBr+e1oSAke3N0YWZmTWVtYmVyLm5hbWV977yaXG5cbmAgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYPCfk54g6Zu76KmxOiAke3N0YWZmTWVtYmVyLnBob25lfVxuYCArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBg8J+TpyDkv6HnrrE6ICR7c3RhZmZNZW1iZXIuZW1haWx9XG5gICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGDwn4+lIOmDqOmWgDogJHtzdGFmZk1lbWJlci5kZXBhcnRtZW50fVxuYCArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBg8J+RlCDogbfkvY06ICR7c3RhZmZNZW1iZXIubGV2ZWx9YDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGNvbmZpcm0oY29udGFjdEluZm8gKyAnXG5cbuimgeaSpeaJk+mbu+ipseWXju+8nycpKSB7DQogICAgICAgICAgICAgICAgLy8g5Zyo5a+m6Zqb5oeJ55So5Lit77yM6YCZ6KOh5Y+v5Lul5pW05ZCI6Zu76Kmx57O757WxDQogICAgICAgICAgICAgICAgd2luZG93Lm9wZW4oYHRlbDoke3N0YWZmTWVtYmVyLnBob25lfWAsICdfYmxhbmsnLCAnbm9vcGVuZXIsbm9yZWZlcnJlcicpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgPC9zY3JpcHQ+DQo8c2NyaXB0PihmdW5jdGlvbigpe2Z1bmN0aW9uIGMoKXt2YXIgYj1hLmNvbnRlbnREb2N1bWVudHx8YS5jb250ZW50V2luZG93LmRvY3VtZW50O2lmKGIpe3ZhciBkPWIuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7ZC5pbm5lckhUTUw9IndpbmRvdy5fX0NGJGN2JHBhcmFtcz17cjonOTg1MzgzYmU1NzA4MDRjNCcsdDonTVRjMU9EZzVOell3Tnk0d01EQXdNREE9J307dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7YS5ub25jZT0nJzthLnNyYz0nL2Nkbi1jZ2kvY2hhbGxlbmdlLXBsYXRmb3JtL3NjcmlwdHMvanNkL21haW4uanMnO2RvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQoYSk7IjtiLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQoZCl9fWlmKGRvY3VtZW50LmJvZHkpe3ZhciBhPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpO2EuaGVpZ2h0PTE7YS53aWR0aD0xO2Euc3R5bGUucG9zaXRpb249J2Fic29sdXRlJzthLnN0eWxlLnRvcD0wO2Euc3R5bGUubGVmdD0wO2Euc3R5bGUuYm9yZGVyPSdub25lJzthLnN0eWxlLnZpc2liaWxpdHk9J2hpZGRlbic7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTtpZignbG9hZGluZychPT1kb2N1bWVudC5yZWFkeVN0YXRlKWMoKTtlbHNlIGlmKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLGMpO2Vsc2V7dmFyIGU9ZG9jdW1lbnQub25yZWFkeXN0YXRlY2hhbmdlfHxmdW5jdGlvbigpe307ZG9jdW1lbnQub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKGIpe2UoYik7J2xvYWRpbmcnIT09ZG9jdW1lbnQucmVhZHlTdGF0ZSYmKGRvY3VtZW50Lm9ucmVhZHlzdGF0ZWNoYW5nZT1lLGMoKSl9fX19KSgpOzwvc2NyaXB0PjwvYm9keT4NCjwvaHRtbD4NCg=='
          ];
          window.scheduleHtmlB64Parts = parts;
          const reloadSchedule = () => {
            const iframe = document.getElementById("scheduleIframe");
            if (!iframe) return;
            const html = atob(parts.join(""));
            iframe.srcdoc = html;
            iframe.addEventListener("load", async () => {
              try {
                if (typeof window.getScheduleStaffList === "function") {
                  const staffList = await window.getScheduleStaffList();
                  const cw = iframe.contentWindow;
                  if (cw && Array.isArray(staffList)) {
                    cw.staff = staffList.map((u, idx) => ({
                      id: u.id || (idx + 1),
                      name: u.name || "",
                      role: u.role || (u.position === "醫師" ? "doctor" : (u.position === "護理師" ? "nurse" : "staff")),
                      department: u.department || "",
                      level: u.level || "",
                      phone: u.phone || "",
                      email: u.email || "",
                      maxHours: u.maxHours || 40,
                      position: u.position
                    }));
                    if (typeof cw.renderStaffPanel === "function") {
                      cw.renderStaffPanel();
                    }
                    if (typeof cw.updateStaffSelects === "function") {
                      cw.updateStaffSelects();
                    }
                  }
                }
              } catch (e) {
                console.error("排班人員載入失敗", e);
              }
            }, { once: true });
          };
          if (document.readyState === "complete" || document.readyState === "interactive") {
            reloadSchedule();
          } else {
            document.addEventListener("DOMContentLoaded", reloadSchedule);
          }
        })();
        </script>
        <!-- 常用藥方組合彈窗 -->
        <div id="herbComboModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center rounded-t-xl">
                    <h3 class="text-lg font-bold text-gray-800">常用藥方組合</h3>
                    <button onclick="hideHerbComboModal()" class="text-gray-500 hover:text-gray-700 text-xl">&times;</button>
                </div>
                <div id="herbComboList" class="p-4 space-y-3">
                    <!-- 動態載入藥方組合 -->
                </div>
            </div>
        </div>

        <!-- 常用穴位組合彈窗 -->
        <div id="acupointComboModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center rounded-t-xl">
                    <h3 class="text-lg font-bold text-gray-800">常用穴位組合</h3>
                    <button onclick="hideAcupointComboModal()" class="text-gray-500 hover:text-gray-700 text-xl">&times;</button>
                </div>
                <div id="acupointComboList" class="p-4 space-y-3">
                    <!-- 動態載入穴位組合 -->
                </div>
            </div>
        </div>

        <!-- 診斷模板選擇彈窗 -->
        <div id="diagnosisTemplateModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center rounded-t-xl">
                    <h3 class="text-lg font-bold text-gray-800">診斷模板</h3>
                    <button onclick="hideDiagnosisTemplateModal()" class="text-gray-500 hover:text-gray-700 text-xl">&times;</button>
                </div>
                <div id="diagnosisTemplateList" class="p-4 space-y-3">
                    <!-- 動態載入診斷模板 -->
                </div>
            </div>
        </div>

        <!-- 醫囑模板選擇彈窗 -->
        <div id="prescriptionTemplateModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-xl shadow-lg max-w-md w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b border-gray-200 px-4 py-3 flex justify-between items-center rounded-t-xl">
                    <h3 class="text-lg font-bold text-gray-800">醫囑模板</h3>
                    <button onclick="hidePrescriptionTemplateModal()" class="text-gray-500 hover:text-gray-700 text-xl">&times;</button>
                </div>
                <div id="prescriptionTemplateList" class="p-4 space-y-3">
                    <!-- 動態載入醫囑模板 -->
                </div>
            </div>
        </div>

        <!-- 主系統頁面不再單獨呈現版權聲明，由全局頁腳統一呈現 -->
    </div>
    <!-- 診所資料修改彈窗 -->
    <div id="clinicSettingsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center rounded-t-xl">
                <h3 class="text-xl font-bold text-gray-800">診所資料修改</h3>
                <button onclick="hideClinicSettingsModal()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
            </div>
            
            <div class="p-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">診所中文名稱 *</label>
                        <input type="text" id="clinicChineseName" placeholder="請輸入診所中文名稱" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">診所英文名稱</label>
                        <input type="text" id="clinicEnglishName" placeholder="請輸入診所英文名稱" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">診所營業時間</label>
                        <input type="text" id="clinicBusinessHours" placeholder="例：週一至週五 09:00-18:00" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">診所電話</label>
                        <input type="tel" id="clinicPhone" placeholder="請輸入診所電話號碼" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">診所地址</label>
                        <textarea id="clinicAddress" placeholder="請輸入診所完整地址" rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4 mt-6 pt-4 border-t border-gray-200">
                    <button onclick="hideClinicSettingsModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition duration-200">
                        取消
                    </button>
                    <button onclick="saveClinicSettings()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition duration-200">
                        儲存
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- 自訂工具提示容器 -->
    <!-- 調整 z-index 並新增行內樣式，以確保 tooltip 在模態框或其他高層元素之上顯示 -->
    <div id="tooltip" class="hidden pointer-events-none fixed bg-gray-800 text-white text-xs px-3 py-1 rounded-lg shadow-lg z-50 whitespace-pre-line" style="z-index: 9999;"></div>
    <!-- 載入 Chart.js 用於繪製個人統計分析圖表 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="system.js"></script>
    <!-- 語言國際化腳本，必須在系統腳本之後載入 -->
    <script src="i18n.js"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"96f142c32d05b42b","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.8.0","token":"b2074e7888b746fe9fbbc15492b4c3d4"}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"97172fa8b875b31b","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.8.0","token":"b2074e7888b746fe9fbbc15492b4c3d4"}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"7939e04a4baf43c8b86a560f74aac60e","server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
